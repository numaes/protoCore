<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="docutils_2writers_2odf__odt_2____init_____8py" kind="file" language="Python">
    <compoundname>__init__.py</compoundname>
    <innerclass refid="classdocutils_1_1writers_1_1odf__odt_1_1__ElementInterfaceWrapper" prot="protected">docutils::writers::odf_odt::_ElementInterfaceWrapper</innerclass>
    <innerclass refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle" prot="public">docutils::writers::odf_odt::TableStyle</innerclass>
    <innerclass refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel" prot="public">docutils::writers::odf_odt::ListLevel</innerclass>
    <innerclass refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer" prot="public">docutils::writers::odf_odt::Writer</innerclass>
    <innerclass refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator" prot="public">docutils::writers::odf_odt::ODFTranslator</innerclass>
    <innerclass refid="classdocutils_1_1writers_1_1odf__odt_1_1Reader" prot="public">docutils::writers::odf_odt::Reader</innerclass>
    <innernamespace refid="namespacedocutils">docutils</innernamespace>
    <innernamespace refid="namespacedocutils_1_1writers">docutils::writers</innernamespace>
    <innernamespace refid="namespacedocutils_1_1writers_1_1odf__odt">docutils::writers::odf_odt</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacedocutils_1_1writers_1_1odf__odt" refkind="compound"><highlight class="comment">#<sp/>$Id:<sp/>__init__.py<sp/>9541<sp/>2024-02-17<sp/>10:37:13Z<sp/>milde<sp/>$</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Author:<sp/>Dave<sp/>Kuhlman<sp/>&lt;dkuhlman@davekuhlman.org&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Copyright:<sp/>This<sp/>module<sp/>has<sp/>been<sp/>placed<sp/>in<sp/>the<sp/>public<sp/>domain.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="6"><highlight class="stringliteral">Open<sp/>Document<sp/>Format<sp/>(ODF)<sp/>Writer.</highlight></codeline>
<codeline lineno="7"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="8"><highlight class="stringliteral">This<sp/>module<sp/>is<sp/>provisional:</highlight></codeline>
<codeline lineno="9"><highlight class="stringliteral">the<sp/>API<sp/>is<sp/>not<sp/>settled<sp/>and<sp/>may<sp/>change<sp/>with<sp/>any<sp/>minor<sp/>Docutils<sp/>version.</highlight></codeline>
<codeline lineno="10"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal">__docformat__<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;reStructuredText&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>configparser<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>ConfigParser</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>copy</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>io<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>StringIO</highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>itertools</highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>locale</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>os</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>os.path</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>pathlib<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Path</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>re</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>subprocess</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>tempfile</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>time</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>urllib</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>weakref</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>xml.etree<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>ElementTree<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>etree</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>xml.dom<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>minidom</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>zipfile</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>docutils</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>docutils<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>frontend,<sp/>nodes,<sp/>utils,<sp/>writers,<sp/>languages</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacedocutils_1_1parsers_1_1rst_1_1directives_1_1images" kindref="compound">docutils.parsers.rst.directives.images</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>PIL<sp/><sp/></highlight><highlight class="comment">#<sp/>optional</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacedocutils_1_1readers" kindref="compound">docutils.readers</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>standalone</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacedocutils_1_1transforms" kindref="compound">docutils.transforms</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>references</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Import<sp/>pygments<sp/>and<sp/>odtwriter<sp/>pygments<sp/>formatters<sp/>if<sp/>possible.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>pygments</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/><ref refid="namespacepygments_1_1lexers" kindref="compound">pygments.lexers</ref></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>.pygmentsformatter<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>(OdtPygmentsProgFormatter,</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OdtPygmentsLaTeXFormatter)</highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>(ImportError,<sp/>SyntaxError):</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/>pygments<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"></highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="comment">#<sp/>import<sp/>warnings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight><highlight class="comment">#<sp/>warnings.warn(&apos;importing<sp/>IPShellEmbed&apos;,<sp/>UserWarning)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="comment">#<sp/>from<sp/>IPython.Shell<sp/>import<sp/>IPShellEmbed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight><highlight class="comment">#<sp/>args<sp/>=<sp/>[&apos;-pdb&apos;,<sp/>&apos;-pi1&apos;,<sp/>&apos;In<sp/>&lt;\\#&gt;:<sp/>&apos;,<sp/>&apos;-pi2&apos;,<sp/>&apos;<sp/><sp/><sp/>.\\D.:<sp/>&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;-po&apos;,<sp/>&apos;Out&lt;\\#&gt;:<sp/>&apos;,<sp/>&apos;-nosep&apos;]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight><highlight class="comment">#<sp/>ipshell<sp/>=<sp/>IPShellEmbed(args,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>banner<sp/>=<sp/>&apos;Entering<sp/>IPython.<sp/><sp/>Press<sp/>Ctrl-D<sp/>to<sp/>exit.&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exit_msg<sp/>=<sp/>&apos;Leaving<sp/>Interpreter,<sp/>back<sp/>to<sp/>program.&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal">VERSION<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;1.0a&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal">IMAGE_NAME_COUNTER<sp/>=<sp/>itertools.count()</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="comment">#<sp/>ElementTree<sp/>does<sp/>not<sp/>support<sp/>getparent<sp/>method<sp/>(lxml<sp/>does).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="comment">#<sp/>This<sp/>wrapper<sp/>class<sp/>and<sp/>the<sp/>following<sp/>support<sp/>functions<sp/>provide</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>that<sp/>support<sp/>for<sp/>the<sp/>ability<sp/>to<sp/>get<sp/>the<sp/>parent<sp/>of<sp/>an<sp/>element.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal">_parents<sp/>=<sp/>weakref.WeakKeyDictionary()</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(etree.Element,<sp/>type):</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>_ElementInterface<sp/>=<sp/>etree.Element</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>_ElementInterface<sp/>=<sp/>etree._ElementInterface</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74" refid="classdocutils_1_1writers_1_1odf__odt_1_1__ElementInterfaceWrapper" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1__ElementInterfaceWrapper" kindref="compound">_ElementInterfaceWrapper</ref>(<ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a0dca29f42d604f93b577e6eb121c6a90" kindref="member">_ElementInterface</ref>):</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1__ElementInterfaceWrapper_1a8604dabb66d19ea58a1377a7e36e67bb" kindref="member">__init__</ref>(self,<sp/>tag,<sp/>attrib=None):</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_ElementInterface.__init__(self,<sp/>tag,<sp/>attrib)</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_parents[self]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1__ElementInterfaceWrapper_1a8ab1d7fefade083ed4c83f6c5f1f5d89" kindref="member">setparent</ref>(self,<sp/>parent):</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>_parents[self]<sp/>=<sp/>parent</highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1__ElementInterfaceWrapper_1ab042de7f998940d8366904a4cec14dde" kindref="member">getparent</ref>(self):</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>_parents[self]</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Constants<sp/>and<sp/>globals</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal">SPACES_PATTERN<sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">r&apos;(<sp/>+)&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="90"><highlight class="normal">TABS_PATTERN<sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">r&apos;(\t+)&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="91"><highlight class="normal">FILL_PAT1<sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">r&apos;^<sp/>+&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="92"><highlight class="normal">FILL_PAT2<sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">r&apos;<sp/>{2,}&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal">TABLESTYLEPREFIX<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;rststyle-table-&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal">TABLENAMEDEFAULT<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%s0&apos;</highlight><highlight class="normal"><sp/>%<sp/>TABLESTYLEPREFIX</highlight></codeline>
<codeline lineno="96"><highlight class="normal">TABLEPROPERTYNAMES<sp/>=<sp/>(</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;border&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;border-top&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;border-left&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;border-right&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;border-bottom&apos;</highlight><highlight class="normal">,<sp/>)</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal">GENERATOR_DESC<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Docutils.org/odf_odt&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal">NAME_SPACE_1<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:office:1.0&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal">CONTENT_NAMESPACE_DICT<sp/>=<sp/>CNSD<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;office:version&apos;:<sp/>&apos;1.0&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;chart&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:chart:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://purl.org/dc/elements/1.1/&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2001/xml-events&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dr3d&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:drawing:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;form&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:form:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;math&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1998/Math/MathML&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;meta&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office&apos;</highlight><highlight class="normal">:<sp/>NAME_SPACE_1,</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ooo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/office&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;oooc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/calc&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ooow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/writer&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;presentation&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:presentation:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="121"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;script&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:script:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:style:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;svg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:table:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:text:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xforms&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2002/xforms&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xlink&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1999/xlink&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xsd&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2001/XMLSchema&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xsi&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2001/XMLSchema-instance&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="131"><highlight class="normal">}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal">STYLES_NAMESPACE_DICT<sp/>=<sp/>SNSD<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;office:version&apos;:<sp/>&apos;1.0&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;chart&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:chart:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://purl.org/dc/elements/1.1/&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2001/xml-events&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dr3d&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:drawing:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;form&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:form:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;math&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1998/Math/MathML&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;meta&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office&apos;</highlight><highlight class="normal">:<sp/>NAME_SPACE_1,</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;presentation&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:presentation:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ooo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/office&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;oooc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/calc&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ooow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/writer&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;script&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:script:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:style:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;svg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:table:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:text:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xlink&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1999/xlink&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="156"><highlight class="normal">}</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal">MANIFEST_NAMESPACE_DICT<sp/>=<sp/>MANNSD<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:manifest:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="160"><highlight class="normal">}</highlight></codeline>
<codeline lineno="161"><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal">META_NAMESPACE_DICT<sp/>=<sp/>METNSD<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;office:version&apos;:<sp/>&apos;1.0&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://purl.org/dc/elements/1.1/&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;meta&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office&apos;</highlight><highlight class="normal">:<sp/>NAME_SPACE_1,</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ooo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/office&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xlink&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1999/xlink&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="169"><highlight class="normal">}</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Attribute<sp/>dictionaries<sp/>for<sp/>use<sp/>with<sp/>ElementTree,<sp/>which</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight><highlight class="comment">#<sp/>does<sp/>not<sp/>support<sp/>use<sp/>of<sp/>nsmap<sp/>parameter<sp/>on<sp/>Element()<sp/>and<sp/>SubElement().</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal">CONTENT_NAMESPACE_ATTRIB<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;office:version&apos;:<sp/>&apos;1.0&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:chart&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:chart:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:dc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://purl.org/dc/elements/1.1/&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:dom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2001/xml-events&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:dr3d&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:draw&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:drawing:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:fo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:form&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:form:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:math&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1998/Math/MathML&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:meta&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:office&apos;</highlight><highlight class="normal">:<sp/>NAME_SPACE_1,</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:presentation&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:presentation:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:ooo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/office&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:oooc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/calc&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:ooow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/writer&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:script&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:script:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:style:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:svg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:table&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:table:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:text&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:text:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:xforms&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2002/xforms&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:xlink&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1999/xlink&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:xsd&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2001/XMLSchema&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:xsi&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2001/XMLSchema-instance&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="201"><highlight class="normal">}</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal">STYLES_NAMESPACE_ATTRIB<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;office:version&apos;:<sp/>&apos;1.0&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:chart&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:chart:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:dc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://purl.org/dc/elements/1.1/&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:dom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/2001/xml-events&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:dr3d&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:draw&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:drawing:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:fo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:form&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:form:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:math&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1998/Math/MathML&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:meta&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:office&apos;</highlight><highlight class="normal">:<sp/>NAME_SPACE_1,</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:presentation&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:presentation:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:ooo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/office&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:oooc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/calc&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:ooow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/writer&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:script&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:script:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:style:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:svg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:table&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:table:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:text&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:text:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:xlink&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1999/xlink&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="227"><highlight class="normal">}</highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal">MANIFEST_NAMESPACE_ATTRIB<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:manifest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:manifest:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="231"><highlight class="normal">}</highlight></codeline>
<codeline lineno="232"><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal">META_NAMESPACE_ATTRIB<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;office:version&apos;:<sp/>&apos;1.0&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:dc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://purl.org/dc/elements/1.1/&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:meta&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:office&apos;</highlight><highlight class="normal">:<sp/>NAME_SPACE_1,</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:ooo&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://openoffice.org/2004/office&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:xlink&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;http://www.w3.org/1999/xlink&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="240"><highlight class="normal">}</highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Functions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight><highlight class="comment">#<sp/>ElementTree<sp/>support<sp/>functions.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight><highlight class="comment">#<sp/>In<sp/>order<sp/>to<sp/>be<sp/>able<sp/>to<sp/>get<sp/>the<sp/>parent<sp/>of<sp/>elements,<sp/>must<sp/>use<sp/>these</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>instead<sp/>of<sp/>the<sp/>functions<sp/>with<sp/>same<sp/>name<sp/>provided<sp/>by<sp/>ElementTree.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab43d5ae252940def01c6110427986c1a" kindref="member">Element</ref>(tag,<sp/>attrib=None,<sp/>nsmap=None,<sp/>nsdict=CNSD):</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>attrib<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/>tag,<sp/>attrib<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a2db312305988f5a5a3f1d29f0142a2e4" kindref="member">fix_ns</ref>(tag,<sp/>attrib,<sp/>nsdict)</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1__ElementInterfaceWrapper" kindref="compound">_ElementInterfaceWrapper</ref>(tag,<sp/>attrib)</highlight></codeline>
<codeline lineno="257"><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/>tag,<sp/>attrib=None,<sp/>nsmap=None,<sp/>nsdict=CNSD):</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>attrib<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/>tag,<sp/>attrib<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a2db312305988f5a5a3f1d29f0142a2e4" kindref="member">fix_ns</ref>(tag,<sp/>attrib,<sp/>nsdict)</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1__ElementInterfaceWrapper" kindref="compound">_ElementInterfaceWrapper</ref>(tag,<sp/>attrib)</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>parent.append(el)</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>el.setparent(parent)</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>el</highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a2db312305988f5a5a3f1d29f0142a2e4" kindref="member">fix_ns</ref>(tag,<sp/>attrib,<sp/>nsdict):</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/>nstag<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(tag,<sp/>nsdict)</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/>nsattrib<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>key,<sp/>val<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(attrib.items()):</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nskey<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(key,<sp/>nsdict)</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsattrib[nskey]<sp/>=<sp/>val</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nstag,<sp/>nsattrib</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"></highlight></codeline>
<codeline lineno="278"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(tag,<sp/>nsdict=CNSD):</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tag</highlight></codeline>
<codeline lineno="280"><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1abe3cf9a90138de24eeb3df33a5d102be" kindref="member">ToString</ref>(et):</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>outstream<sp/>=<sp/>StringIO()</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/>et.write(outstream,<sp/>encoding=</highlight><highlight class="stringliteral">&quot;unicode&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>outstream.getvalue()</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/>outstream.close()</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s1</highlight></codeline>
<codeline lineno="288"><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a78a238cb5555dc38b7751b781f2ddde5" kindref="member">escape_cdata</ref>(text):</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/>text<sp/>=<sp/>text.replace(</highlight><highlight class="stringliteral">&quot;&amp;&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;&amp;amp;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>text<sp/>=<sp/>text.replace(</highlight><highlight class="stringliteral">&quot;&lt;&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;&amp;lt;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/>text<sp/>=<sp/>text.replace(</highlight><highlight class="stringliteral">&quot;&gt;&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;&amp;gt;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/>ascii<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>char<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>text:</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ord(char)<sp/>&gt;=<sp/>ord(</highlight><highlight class="stringliteral">&quot;\x7f&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ascii<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;&amp;#x%X;&quot;</highlight><highlight class="normal"><sp/>%<sp/>(ord(char),<sp/>)</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ascii<sp/>+=<sp/>char</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ascii</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Classes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308" refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle" kindref="compound">TableStyle</ref>:</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1a302d5bee4d8f87a4a10e6f53ec9614f4" kindref="member">__init__</ref>(self,<sp/>border=None,<sp/>backgroundcolor=None):</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1afb899d2b58ba1fcb0ca843bb580150d6" kindref="member">border</ref><sp/>=<sp/>border</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1ae11bf440cff4d3692deef759ae2361a2" kindref="member">backgroundcolor</ref><sp/>=<sp/>backgroundcolor</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1ad215a17776df96e39be4d3da3e01d236" kindref="member">get_border_</ref>(self):</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1a2c2008f8a2d69a6e751f2ca4dc18cd6c" kindref="member">border_</ref></highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1af2079d12258d623ece5b29b7def9d813" kindref="member">set_border_</ref>(self,<sp/>border):</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1a2c2008f8a2d69a6e751f2ca4dc18cd6c" kindref="member">border_</ref><sp/>=<sp/>border</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>border<sp/>=<sp/>property(get_border_,<sp/>set_border_)</highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1a33760aba846bcbdcf7aa3477f2b65946" kindref="member">get_backgroundcolor_</ref>(self):</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1aaf4940809b024a7695af416fa5e8b9b3" kindref="member">backgroundcolor_</ref></highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1ade655a94c35a814d04f263237758b4e9" kindref="member">set_backgroundcolor_</ref>(self,<sp/>backgroundcolor):</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle_1aaf4940809b024a7695af416fa5e8b9b3" kindref="member">backgroundcolor_</ref><sp/>=<sp/>backgroundcolor</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>backgroundcolor<sp/>=<sp/>property(get_backgroundcolor_,<sp/>set_backgroundcolor_)</highlight></codeline>
<codeline lineno="327"><highlight class="normal"></highlight></codeline>
<codeline lineno="328"><highlight class="normal"></highlight></codeline>
<codeline lineno="329"><highlight class="normal">BUILTIN_DEFAULT_TABLE_STYLE<sp/>=<sp/><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle" kindref="compound">TableStyle</ref>(</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>border=</highlight><highlight class="stringliteral">&apos;0.0007in<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="331"><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Information<sp/>about<sp/>the<sp/>indentation<sp/>level<sp/>for<sp/>lists<sp/>nested<sp/>inside</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>other<sp/>contexts,<sp/>e.g.<sp/>dictionary<sp/>lists.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336" refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel" kindref="compound">ListLevel</ref>:</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1ac2b3ebedebe5e5a4d0d0904e16c9e7ed" kindref="member">__init__</ref>(self,<sp/>level,<sp/>sibling_level=True,<sp/>nested_level=True):</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1abfe90781ff44a51b01c255363d0eac6c" kindref="member">level</ref><sp/>=<sp/>level</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a8a0177707810ae986c5a53350fcb92dd" kindref="member">sibling_level</ref><sp/>=<sp/>sibling_level</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a0823db670a68430c1d62e735b7fb2933" kindref="member">nested_level</ref><sp/>=<sp/>nested_level</highlight></codeline>
<codeline lineno="341"><highlight class="normal"></highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1ade64aa220c7321a86a7b4aa78b42e6e1" kindref="member">set_sibling</ref>(self,<sp/>sibling_level):</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a8a0177707810ae986c5a53350fcb92dd" kindref="member">sibling_level</ref><sp/>=<sp/>sibling_level</highlight></codeline>
<codeline lineno="344"><highlight class="normal"></highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a0e9671b9bb93681a130fe6207eda9b3b" kindref="member">get_sibling</ref>(self):</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a8a0177707810ae986c5a53350fcb92dd" kindref="member">sibling_level</ref></highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a4dddb5710d2fc455be5b6e1fd725d17b" kindref="member">set_nested</ref>(self,<sp/>nested_level):</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a0823db670a68430c1d62e735b7fb2933" kindref="member">nested_level</ref><sp/>=<sp/>nested_level</highlight></codeline>
<codeline lineno="350"><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a8ce800da8308207d51f4ef125b0d6b31" kindref="member">get_nested</ref>(self):</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a0823db670a68430c1d62e735b7fb2933" kindref="member">nested_level</ref></highlight></codeline>
<codeline lineno="353"><highlight class="normal"></highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1a32103e04ee63ff4cb099d1cebdc1aeab" kindref="member">set_level</ref>(self,<sp/>level):</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1abfe90781ff44a51b01c255363d0eac6c" kindref="member">level</ref><sp/>=<sp/>level</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1af34aa48f9d4adef845fd0489f4873160" kindref="member">get_level</ref>(self):</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ListLevel_1abfe90781ff44a51b01c255363d0eac6c" kindref="member">level</ref></highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"></highlight></codeline>
<codeline lineno="361" refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer" kindref="compound">Writer</ref>(<ref refid="classdocutils_1_1writers_1_1Writer" kindref="compound">writers.Writer</ref>):</highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/>MIME_TYPE<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;application/vnd.oasis.opendocument.text&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/>EXTENSION<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;.odt&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>supported<sp/>=<sp/>(</highlight><highlight class="stringliteral">&apos;odt&apos;</highlight><highlight class="normal">,<sp/>)</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Formats<sp/>this<sp/>writer<sp/>supports.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/>default_stylesheet<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;styles&apos;</highlight><highlight class="normal"><sp/>+<sp/>EXTENSION</highlight></codeline>
<codeline lineno="370"><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/>default_stylesheet_path<sp/>=<sp/>utils.relative_path(</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>os.path.join(os.getcwd(),<sp/></highlight><highlight class="stringliteral">&apos;dummy&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>os.path.join(os.path.dirname(__file__),<sp/>default_stylesheet))</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/>default_template<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;template.txt&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/>default_template_path<sp/>=<sp/>utils.relative_path(</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>os.path.join(os.getcwd(),<sp/></highlight><highlight class="stringliteral">&apos;dummy&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>os.path.join(os.path.dirname(__file__),<sp/>default_template))</highlight></codeline>
<codeline lineno="380"><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/>settings_spec<sp/>=<sp/>(</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ODF-Specific<sp/>Options.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Specify<sp/>a<sp/>stylesheet.<sp/><sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Default:<sp/>&quot;%s&quot;&apos;</highlight><highlight class="normal"><sp/>%<sp/>default_stylesheet_path,</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--stylesheet&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/>default_stylesheet_path,</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;stylesheet&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}),</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Specify<sp/>an<sp/>ODF-specific<sp/>configuration/mapping<sp/>file<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;relative<sp/>to<sp/>the<sp/>current<sp/>working<sp/>directory.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--odf-config-file&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;metavar&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;file&gt;&apos;</highlight><highlight class="normal">}),</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Obfuscate<sp/>email<sp/>addresses<sp/>to<sp/>confuse<sp/>harvesters.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--cloak-email-addresses&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;cloak_email_addresses&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Do<sp/>not<sp/>obfuscate<sp/>email<sp/>addresses.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--no-cloak-email-addresses&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_false&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;cloak_email_addresses&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Specify<sp/>the<sp/>thickness<sp/>of<sp/>table<sp/>borders<sp/>in<sp/>thousands<sp/>of<sp/>a<sp/>cm.<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Default<sp/>is<sp/>35.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--table-border-thickness&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;metavar&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;int&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_nonnegative_int}),</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Add<sp/>syntax<sp/>highlighting<sp/>in<sp/>literal<sp/>code<sp/>blocks.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--add-syntax-highlighting&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;add_syntax_highlighting&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Do<sp/>not<sp/>add<sp/>syntax<sp/>highlighting<sp/>in<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;literal<sp/>code<sp/>blocks.<sp/>(default)&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--no-syntax-highlighting&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_false&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;add_syntax_highlighting&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Create<sp/>sections<sp/>for<sp/>headers.<sp/><sp/>(default)&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--create-sections&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;create_sections&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Do<sp/>not<sp/>create<sp/>sections<sp/>for<sp/>headers.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--no-sections&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_false&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;create_sections&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Create<sp/>links.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--create-links&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;create_links&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Do<sp/>not<sp/>create<sp/>links.<sp/><sp/>(default)&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--no-links&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_false&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;create_links&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Generate<sp/>endnotes<sp/>at<sp/>end<sp/>of<sp/>document,<sp/>not<sp/>footnotes<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;at<sp/>bottom<sp/>of<sp/>page.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--endnotes-end-doc&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;endnotes_end_doc&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Generate<sp/>footnotes<sp/>at<sp/>bottom<sp/>of<sp/>page,<sp/>not<sp/>endnotes<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;at<sp/>end<sp/>of<sp/>document.<sp/>(default)&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--no-endnotes-end-doc&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_false&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;endnotes_end_doc&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Generate<sp/>a<sp/>bullet<sp/>list<sp/>table<sp/>of<sp/>contents,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;not<sp/>a<sp/>native<sp/>ODF<sp/>table<sp/>of<sp/>contents.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--generate-list-toc&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_false&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;generate_oowriter_toc&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Generate<sp/>a<sp/>native<sp/>ODF<sp/>table<sp/>of<sp/>contents,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;not<sp/>a<sp/>bullet<sp/>list.<sp/>(default)&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--generate-oowriter-toc&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;action&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;store_true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;generate_oowriter_toc&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;validator&apos;</highlight><highlight class="normal">:<sp/>frontend.validate_boolean}),</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Specify<sp/>the<sp/>contents<sp/>of<sp/>an<sp/>custom<sp/>header<sp/>line.<sp/><sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;See<sp/>ODF/ODT<sp/>writer<sp/>documentation<sp/>for<sp/>details<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;about<sp/>special<sp/>field<sp/>character<sp/>sequences.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--custom-odt-header&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;custom_header&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;metavar&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;custom<sp/>header&gt;&apos;</highlight><highlight class="normal">}),</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&apos;Specify<sp/>the<sp/>contents<sp/>of<sp/>an<sp/>custom<sp/>footer<sp/>line.<sp/><sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;See<sp/>ODF/ODT<sp/>writer<sp/>documentation<sp/>for<sp/>details.&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[</highlight><highlight class="stringliteral">&apos;--custom-odt-footer&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight><highlight class="stringliteral">&apos;default&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dest&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;custom_footer&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;metavar&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;custom<sp/>footer&gt;&apos;</highlight><highlight class="normal">}),</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/>settings_defaults<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;output_encoding_error_handler&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;xmlcharrefreplace&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="497"><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/>relative_path_settings<sp/>=<sp/>(</highlight><highlight class="stringliteral">&apos;odf_config_file&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;stylesheet&apos;</highlight><highlight class="normal">,)</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/>config_section<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;odf_odt<sp/>writer&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/>config_section_dependencies<sp/>=<sp/>(</highlight><highlight class="stringliteral">&apos;writers&apos;</highlight><highlight class="normal">,)</highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a6b8c9759ccff9f19af626f6da5842dbc" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writers.Writer.__init__(self)</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a7748c940ed385062ecfd81ac5711cf24" kindref="member">translator_class</ref><sp/>=<sp/>ODFTranslator</highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a57ace01bf948a1bbaf5b211a21dc0c21" kindref="member">translate</ref>(self):</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a0766fae0442a80f8316bfbbef0a23634" kindref="member">settings</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a6defb13b9010911696f7800122277f23" kindref="member">document</ref>.settings</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a7748c940ed385062ecfd81ac5711cf24" kindref="member">translator_class</ref>(self.<ref refid="classdocutils_1_1writers_1_1Writer_1a6defb13b9010911696f7800122277f23" kindref="member">document</ref>)</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref>.retrieve_styles(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a3e16254514cf8a0aadc6bf3cc0afc722" kindref="member">EXTENSION</ref><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1aab4c3d78f722e2db254a4169cd7ae9b3" kindref="member">EXTENSION</ref>)</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a6defb13b9010911696f7800122277f23" kindref="member">document</ref>.walkabout(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref>)</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref>.add_doc_title()</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a4fe633b1f18c39859184fe01c517b68c" kindref="member">assemble_my_parts</ref>()</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a32b6cf60d1b5d54799c9edb0dac9808a" kindref="member">output</ref><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a7bb30a4b3c4d2c4f25882fceb00249a6" kindref="member">output</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a10ebbef3d2ca0913e4c1a40ea9567f86" kindref="member">parts</ref>[</highlight><highlight class="stringliteral">&apos;whole&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="515"><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a4fe633b1f18c39859184fe01c517b68c" kindref="member">assemble_my_parts</ref>(self):</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Assemble<sp/>the<sp/>`self.parts`<sp/>dictionary.<sp/><sp/>Extend<sp/>in<sp/>subclasses.</highlight></codeline>
<codeline lineno="518"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writers.Writer.assemble_parts(self)</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>tempfile.NamedTemporaryFile()</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zfile<sp/>=<sp/>zipfile.ZipFile(f,<sp/></highlight><highlight class="stringliteral">&apos;w&apos;</highlight><highlight class="normal">,<sp/>zipfile.ZIP_DEFLATED)</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a8208498fa847036ec30c7cb7a0383a81" kindref="member">write_zip_str</ref>(</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zfile,<sp/></highlight><highlight class="stringliteral">&apos;mimetype&apos;</highlight><highlight class="normal">,<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a6fa102cae756d89a96ed59d377f85e53" kindref="member">MIME_TYPE</ref><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1ab2521cbd248c70c76bb017579ef0f17a" kindref="member">MIME_TYPE</ref>,</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compress_type=zipfile.ZIP_STORED)</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>content<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref>.content_astext()</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a8208498fa847036ec30c7cb7a0383a81" kindref="member">write_zip_str</ref>(zfile,<sp/></highlight><highlight class="stringliteral">&apos;content.xml&apos;</highlight><highlight class="normal">,<sp/>content)</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a6ede706a058d9d060f6772d9e8b42d0e" kindref="member">create_manifest</ref>()</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a8208498fa847036ec30c7cb7a0383a81" kindref="member">write_zip_str</ref>(zfile,<sp/></highlight><highlight class="stringliteral">&apos;META-INF/manifest.xml&apos;</highlight><highlight class="normal">,<sp/>s1)</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1ab69e1200b9749ad0b5126d114f931edc" kindref="member">create_meta</ref>()</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a8208498fa847036ec30c7cb7a0383a81" kindref="member">write_zip_str</ref>(zfile,<sp/></highlight><highlight class="stringliteral">&apos;meta.xml&apos;</highlight><highlight class="normal">,<sp/>s1)</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a823f42f088743b6ef8bd41495054f727" kindref="member">get_stylesheet</ref>()</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Set<sp/>default<sp/>language<sp/>in<sp/>document<sp/>to<sp/>be<sp/>generated.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Language<sp/>is<sp/>specified<sp/>by<sp/>the<sp/>-l/--language<sp/>command<sp/>line<sp/>option.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>format<sp/>is<sp/>described<sp/>in<sp/>BCP<sp/>47.<sp/><sp/>If<sp/>region<sp/>is<sp/>omitted,<sp/>we<sp/>use</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>local.normalize(ll)<sp/>to<sp/>obtain<sp/>a<sp/>region.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>language_code<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>region_code<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref>.language_code:</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>language_ids<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref>.language_code.replace(</highlight><highlight class="stringliteral">&apos;_&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>language_ids<sp/>=<sp/>language_ids.split(</highlight><highlight class="stringliteral">&apos;-&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>first<sp/>tag<sp/>is<sp/>primary<sp/>language<sp/>tag</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>language_code<sp/>=<sp/>language_ids[0].lower()</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>2-letter<sp/>region<sp/>subtag<sp/>may<sp/>follow<sp/>in<sp/>2nd<sp/>or<sp/>3rd<sp/>position</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>subtag<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>language_ids[1:]:</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(subtag)<sp/>==<sp/>2<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>subtag.isalpha():</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>region_code<sp/>=<sp/>subtag.upper()</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>len(subtag)<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>1-letter<sp/>tag<sp/>is<sp/>never<sp/>before<sp/>valid<sp/>region<sp/>tag</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>region_code<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rcode<sp/>=<sp/>locale.normalize(language_code)</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>NameError:</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rcode<sp/>=<sp/>language_code</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rcode<sp/>=<sp/>rcode.split(</highlight><highlight class="stringliteral">&apos;_&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(rcode)<sp/>&gt;<sp/>1:</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rcode<sp/>=<sp/>rcode[1].split(</highlight><highlight class="stringliteral">&apos;.&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>region_code<sp/>=<sp/>rcode[0]</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>region_code<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a6defb13b9010911696f7800122277f23" kindref="member">document</ref>.reporter.warning(</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;invalid<sp/>language-region.\n&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;<sp/><sp/>Could<sp/>not<sp/>find<sp/>region<sp/>with<sp/>locale.normalize().\n&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;<sp/><sp/>Please<sp/>specify<sp/>both<sp/>language<sp/>and<sp/>region<sp/>(ll-RR).\n&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;<sp/><sp/>Examples:<sp/>es-MX<sp/>(Spanish,<sp/>Mexico),\n&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;<sp/><sp/>en-AU<sp/>(English,<sp/>Australia).&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Update<sp/>the<sp/>style<sp/>ElementTree<sp/>with<sp/>the<sp/>language<sp/>and<sp/>region.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Note<sp/>that<sp/>we<sp/>keep<sp/>a<sp/>reference<sp/>to<sp/>the<sp/>modified<sp/>node<sp/>because</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>it<sp/>is<sp/>possible<sp/>that<sp/>ElementTree<sp/>will<sp/>throw<sp/>away<sp/>the<sp/>Python</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>representation<sp/>of<sp/>the<sp/>updated<sp/>node<sp/>if<sp/>we<sp/>do<sp/>not.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>updated,<sp/>new_dom_styles,<sp/>updated_node<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a44b88b2d86503af18a60ac324122d3db" kindref="member">update_stylesheet</ref>(</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref>.get_dom_stylesheet(),<sp/>language_code,<sp/>region_code)</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>updated:</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>etree.tostring(new_dom_styles)</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a8208498fa847036ec30c7cb7a0383a81" kindref="member">write_zip_str</ref>(zfile,<sp/></highlight><highlight class="stringliteral">&apos;styles.xml&apos;</highlight><highlight class="normal">,<sp/>s1)</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a043ff6d70ff6fb31195fb662de54fc64" kindref="member">store_embedded_files</ref>(zfile)</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a58833099f40cc31fec3e5ca6579ff48f" kindref="member">copy_from_stylesheet</ref>(zfile)</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zfile.close()</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.seek(0)</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>whole<sp/>=<sp/>f.read()</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f.close()</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a10ebbef3d2ca0913e4c1a40ea9567f86" kindref="member">parts</ref>[</highlight><highlight class="stringliteral">&apos;whole&apos;</highlight><highlight class="normal">]<sp/>=<sp/>whole</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a10ebbef3d2ca0913e4c1a40ea9567f86" kindref="member">parts</ref>[</highlight><highlight class="stringliteral">&apos;encoding&apos;</highlight><highlight class="normal">]<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a6defb13b9010911696f7800122277f23" kindref="member">document</ref>.settings.output_encoding</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a10ebbef3d2ca0913e4c1a40ea9567f86" kindref="member">parts</ref>[</highlight><highlight class="stringliteral">&apos;version&apos;</highlight><highlight class="normal">]<sp/>=<sp/>docutils.__version__</highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a44b88b2d86503af18a60ac324122d3db" kindref="member">update_stylesheet</ref>(self,<sp/>stylesheet_root,<sp/>language_code,<sp/>region_code):</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Update<sp/>xml<sp/>style<sp/>sheet<sp/>element<sp/>with<sp/>language<sp/>and<sp/>region/country.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>updated<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modified_nodes<sp/>=<sp/>set()</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>language_code<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>region_code<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n1<sp/>=<sp/>stylesheet_root.find(</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:office:1.0}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;styles&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n1<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>find<sp/>&apos;styles&apos;<sp/>element<sp/>in<sp/>styles.odt/styles.xml&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n2_nodes<sp/>=<sp/>n1.findall(</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:style:1.0}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;default-style&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>n2_nodes:</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>find<sp/>&apos;default-style&apos;<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;element<sp/>in<sp/>styles.xml&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>node<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>n2_nodes:</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>family<sp/>=<sp/>node.attrib.get(</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:style:1.0}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;family&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>family<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;paragraph&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>family<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;graphic&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n3<sp/>=<sp/>node.find(</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:style:1.0}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text-properties&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n3<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>find<sp/>&apos;text-properties&apos;<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;element<sp/>in<sp/>styles.xml&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>language_code<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n3.attrib[</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xsl-fo-compatible:1.0}language&apos;</highlight><highlight class="normal">]<sp/>=<sp/>language_code</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n3.attrib[</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:1.0}language-complex&apos;</highlight><highlight class="normal">]<sp/>=<sp/>language_code</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>updated<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modified_nodes.add(n3)</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>region_code<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n3.attrib[</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xsl-fo-compatible:1.0}country&apos;</highlight><highlight class="normal">]<sp/>=<sp/>region_code</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n3.attrib[</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:1.0}country-complex&apos;</highlight><highlight class="normal">]<sp/>=<sp/>region_code</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>updated<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modified_nodes.add(n3)</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>updated,<sp/>stylesheet_root,<sp/>modified_nodes</highlight></codeline>
<codeline lineno="634"><highlight class="normal"></highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a8208498fa847036ec30c7cb7a0383a81" kindref="member">write_zip_str</ref>(</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>zfile,<sp/>name,<sp/>bytes,<sp/>compress_type=zipfile.ZIP_DEFLATED):</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>localtime<sp/>=<sp/>time.localtime(time.time())</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zinfo<sp/>=<sp/>zipfile.ZipInfo(name,<sp/>localtime)</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>some<sp/>standard<sp/>UNIX<sp/>file<sp/>access<sp/>permissions<sp/>(-rw-r--r--).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zinfo.external_attr<sp/>=<sp/>(0x81a4<sp/>&amp;<sp/>0xFFFF)<sp/>&lt;&lt;<sp/>16</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zinfo.compress_type<sp/>=<sp/>compress_type</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zfile.writestr(zinfo,<sp/>bytes)</highlight></codeline>
<codeline lineno="643"><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a043ff6d70ff6fb31195fb662de54fc64" kindref="member">store_embedded_files</ref>(self,<sp/>zfile):</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>embedded_files<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref>.get_embedded_file_list()</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>source,<sp/>destination<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>embedded_files:</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>source<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zfile.write(source,<sp/>destination)</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>OSError:</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1Writer_1a6defb13b9010911696f7800122277f23" kindref="member">document</ref>.reporter.warning(</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Can&apos;t<sp/>open<sp/>file<sp/>%s.&quot;</highlight><highlight class="normal"><sp/>%<sp/>(source,<sp/>))</highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a3d9bb9f28cfe1af3fba90353b6791013" kindref="member">get_settings</ref>(self):</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="657"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>modeled<sp/>after<sp/>get_stylesheet</highlight></codeline>
<codeline lineno="658"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stylespath<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a0766fae0442a80f8316bfbbef0a23634" kindref="member">settings</ref>.stylesheet</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zfile<sp/>=<sp/>zipfile.ZipFile(stylespath,<sp/></highlight><highlight class="stringliteral">&apos;r&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>zfile.read(</highlight><highlight class="stringliteral">&apos;settings.xml&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zfile.close()</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s1</highlight></codeline>
<codeline lineno="664"><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a823f42f088743b6ef8bd41495054f727" kindref="member">get_stylesheet</ref>(self):</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Get<sp/>the<sp/>stylesheet<sp/>from<sp/>the<sp/>visitor.</highlight></codeline>
<codeline lineno="667"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Ask<sp/>the<sp/>visitor<sp/>to<sp/>setup<sp/>the<sp/>page.</highlight></codeline>
<codeline lineno="668"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a02e3cba4d386c32d1212583dd6e2fa49" kindref="member">visitor</ref>.setup_page()</highlight></codeline>
<codeline lineno="670"><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a58833099f40cc31fec3e5ca6579ff48f" kindref="member">copy_from_stylesheet</ref>(self,<sp/>outzipfile):</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Copy<sp/>images,<sp/>settings,<sp/>etc<sp/>from<sp/>the<sp/>stylesheet<sp/>doc<sp/>into<sp/>target<sp/>doc.</highlight></codeline>
<codeline lineno="673"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stylespath<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a0766fae0442a80f8316bfbbef0a23634" kindref="member">settings</ref>.stylesheet</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inzipfile<sp/>=<sp/>zipfile.ZipFile(stylespath,<sp/></highlight><highlight class="stringliteral">&apos;r&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Copy<sp/>the<sp/>styles.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>inzipfile.read(</highlight><highlight class="stringliteral">&apos;settings.xml&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a8208498fa847036ec30c7cb7a0383a81" kindref="member">write_zip_str</ref>(outzipfile,<sp/></highlight><highlight class="stringliteral">&apos;settings.xml&apos;</highlight><highlight class="normal">,<sp/>s1)</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Copy<sp/>the<sp/>images.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>namelist<sp/>=<sp/>inzipfile.namelist()</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>name<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>namelist:</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>name.startswith(</highlight><highlight class="stringliteral">&apos;Pictures/&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>imageobj<sp/>=<sp/>inzipfile.read(name)</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>outzipfile.writestr(name,<sp/>imageobj)</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inzipfile.close()</highlight></codeline>
<codeline lineno="686"><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a37815faa31401bba39e4ab9752c44472" kindref="member">assemble_parts</ref>(self):</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="689"><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1a6ede706a058d9d060f6772d9e8b42d0e" kindref="member">create_manifest</ref>(self):</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab43d5ae252940def01c6110427986c1a" kindref="member">Element</ref>(</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:manifest&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=MANIFEST_NAMESPACE_ATTRIB,</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsdict=MANIFEST_NAMESPACE_DICT,</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>doc<sp/>=<sp/>etree.ElementTree(root)</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;manifest:file-entry&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:media-type&apos;</highlight><highlight class="normal">:<sp/>self.MIME_TYPE,</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:full-path&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=MANNSD)</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;manifest:file-entry&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:media-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;text/xml&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:full-path&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;content.xml&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=MANNSD)</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;manifest:file-entry&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:media-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;text/xml&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:full-path&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;styles.xml&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=MANNSD)</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;manifest:file-entry&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:media-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;text/xml&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:full-path&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;settings.xml&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=MANNSD)</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;manifest:file-entry&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:media-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;text/xml&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;manifest:full-path&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;meta.xml&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=MANNSD)</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1abe3cf9a90138de24eeb3df33a5d102be" kindref="member">ToString</ref>(doc)</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>doc<sp/>=<sp/>minidom.parseString(s1)</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>doc.toprettyxml(</highlight><highlight class="stringliteral">&apos;<sp/><sp/>&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="720"><highlight class="normal"></highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Writer_1ab69e1200b9749ad0b5126d114f931edc" kindref="member">create_meta</ref>(self):</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab43d5ae252940def01c6110427986c1a" kindref="member">Element</ref>(</highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office:document-meta&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=META_NAMESPACE_ATTRIB,</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsdict=META_NAMESPACE_DICT,</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>doc<sp/>=<sp/>etree.ElementTree(root)</highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;office:meta&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;meta:generator&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Docutils/rst2odf.py/%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(VERSION,<sp/>)</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>os.environ.get(</highlight><highlight class="stringliteral">&apos;USER&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;meta:initial-creator&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>s1</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s2<sp/>=<sp/>time.strftime(</highlight><highlight class="stringliteral">&apos;%Y-%m-%dT%H:%M:%S&apos;</highlight><highlight class="normal">,<sp/>time.localtime())</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;meta:creation-date&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>s2</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;dc:creator&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>s1</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;dc:date&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>s2</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;dc:language&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;en-US&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;meta:editing-cycles&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;1&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;meta:editing-duration&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;PT00M01S&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title<sp/>=<sp/>self.visitor.get_title()</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;dc:title&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>title:</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>title</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;[no<sp/>title]&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>prop,<sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.visitor.get_meta_dict().items():</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;keywords&apos;,<sp/>&apos;description&apos;,<sp/>and<sp/>&apos;subject&apos;<sp/>have<sp/>their<sp/>own<sp/>fields:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>prop<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;keywords&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>keywords<sp/>=<sp/>re.split(</highlight><highlight class="stringliteral">&apos;,<sp/>*&apos;</highlight><highlight class="normal">,<sp/>value)</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>keyword<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>keywords:</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;meta:keyword&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>keyword</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>prop<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;description&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;dc:description&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>prop<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;subject&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;dc:subject&apos;</highlight><highlight class="normal">,<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="comment">#<sp/>Store<sp/>remaining<sp/>properties<sp/>as<sp/>custom/user-defined</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;meta:user-defined&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;meta:name&apos;</highlight><highlight class="normal">:<sp/>prop},<sp/>nsdict=METNSD)</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1abe3cf9a90138de24eeb3df33a5d102be" kindref="member">ToString</ref>(doc)</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>doc<sp/>=<sp/>minidom.parseString(s1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>s1<sp/>=<sp/>doc.toprettyxml(&apos;<sp/><sp/>&apos;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s1</highlight></codeline>
<codeline lineno="774"><highlight class="normal"></highlight></codeline>
<codeline lineno="775"><highlight class="normal"></highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight><highlight class="comment">#<sp/>class<sp/>ODFTranslator(nodes.SparseNodeVisitor):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="777" refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator" kindref="compound">ODFTranslator</ref>(<ref refid="classdocutils_1_1nodes_1_1GenericNodeVisitor" kindref="compound">nodes.GenericNodeVisitor</ref>):</highlight></codeline>
<codeline lineno="778"><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/>used_styles<sp/>=<sp/>(</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;attribution&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;blockindent&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;blockquote&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;blockquote-bulletitem&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;blockquote-bulletlist&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;blockquote-enumitem&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;blockquote-enumlist&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;bulletitem&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;bulletlist&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;caption&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;legend&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;centeredtextbody&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;codeblock&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;codeblock-indented&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;codeblock-classname&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;codeblock-comment&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;codeblock-functionname&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;codeblock-keyword&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;codeblock-name&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;codeblock-number&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;codeblock-operator&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;codeblock-string&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;emphasis&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;enumitem&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;enumlist&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;epigraph&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;epigraph-bulletitem&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;epigraph-bulletlist&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;epigraph-enumitem&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;epigraph-enumlist&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;footer&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;footnote&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;citation&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;header&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;highlights&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;highlights-bulletitem&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;highlights-bulletlist&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;highlights-enumitem&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;highlights-enumlist&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;horizontalline&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;inlineliteral&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;quotation&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;rubric&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;strong&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;table-title&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;textbody&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;tocbulletlist&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;tocenumlist&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;title&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;subtitle&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;heading1&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;heading2&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;heading3&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;heading4&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;heading5&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;heading6&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;heading7&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-attention-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-attention-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-caution-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-caution-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-danger-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-danger-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-error-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-error-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-generic-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-generic-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-hint-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-hint-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-important-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-important-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-note-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-note-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-tip-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-tip-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-warning-hdr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-warning-body&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;tableoption&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;tableoption.%c&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;tableoption.%c%d&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;Table%d&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;Table%d.%c&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Table%d.%c%d&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;lineblock1&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;lineblock2&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;lineblock3&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;lineblock4&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;lineblock5&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;lineblock6&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;image&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;figureframe&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="835"><highlight class="normal"></highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab6f1f484b71db23bce3309649f1b7c67" kindref="member">__init__</ref>(self,<sp/>document):</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>nodes.SparseNodeVisitor.__init__(self,<sp/>document)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes.GenericNodeVisitor.__init__(self,<sp/>document)</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref><sp/>=<sp/>document.settings</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aaecf7ce04ddcd10240d51f2d29469f06" kindref="member">language_code</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.language_code</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a11e5e8a34328545401386ab6f2a58cca" kindref="member">language</ref><sp/>=<sp/>languages.get_language(</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aaecf7ce04ddcd10240d51f2d29469f06" kindref="member">language_code</ref>,</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>document.reporter)</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2382ba60c8c604119e89b01396d8b4f8" kindref="member">format_map</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.odf_config_file:</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parser<sp/>=<sp/>ConfigParser()</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parser.read(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.odf_config_file)</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>rststyle,<sp/>format<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>parser.items(</highlight><highlight class="stringliteral">&quot;Formats&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>rststyle<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aea64dd6b3e7d92edad23903d505cb9c2" kindref="member">used_styles</ref>:</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1nodes_1_1NodeVisitor_1a3c594de0457219c7836d4c53d9398cdc" kindref="member">document</ref>.reporter.warning(</highlight></codeline>
<codeline lineno="851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Style<sp/>&quot;%s&quot;<sp/>is<sp/>not<sp/>a<sp/>style<sp/>used<sp/>by<sp/>odtwriter.&apos;</highlight><highlight class="normal"><sp/>%<sp/>(</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rststyle,<sp/>))</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2382ba60c8c604119e89b01396d8b4f8" kindref="member">format_map</ref>[rststyle]<sp/>=<sp/>format</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af4d18760fee5aa4e1163b2f517741f8a" kindref="member">section_level</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aefd0371e49d124f165dfe1a8ca48fe20" kindref="member">section_count</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Create<sp/>ElementTree<sp/>content<sp/>and<sp/>styles<sp/>documents.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab43d5ae252940def01c6110427986c1a" kindref="member">Element</ref>(</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office:document-content&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=CONTENT_NAMESPACE_ATTRIB,</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2511f723ba1f6f77c316c5f18a09ba7e" kindref="member">content_tree</ref><sp/>=<sp/>etree.ElementTree(element=root)</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref><sp/>=<sp/>root</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;office:scripts&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;office:font-face-decls&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;office:automatic-styles&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5e17687dac8d2f93f633320012af8521" kindref="member">automatic_styles</ref><sp/>=<sp/>el</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;office:body&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1acdd146e1e19fecd849f8ccc5e32d0a9b" kindref="member">generate_content_element</ref>(el)</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref><sp/>=<sp/>el</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a04e4e353dfd34d130ed45c4012aa357e" kindref="member">body_text_element</ref><sp/>=<sp/>el</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1adc2bbddc616230bc6cc4ac264bc6fbb2" kindref="member">paragraph_style_stack</ref><sp/>=<sp/>[self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(</highlight><highlight class="stringliteral">&apos;textbody&apos;</highlight><highlight class="normal">),<sp/>]</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aefa99b01250d3619cc8ce4f74f2e7ad6" kindref="member">list_style_stack</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1db20fd1c9da6791851d7342084f814b" kindref="member">table_count</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afd088e6f93b61d23525bffe6ee33fdd5" kindref="member">column_count</ref><sp/>=<sp/>ord(</highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">)<sp/>-<sp/>1</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aac5e04eb790077500023383e6f117c81" kindref="member">trace_level</ref><sp/>=<sp/>-1</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3232cc66d127ad57b57e2c10936d3e04" kindref="member">optiontablestyles_generated</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5518cbc329924b37af097ff80a60f325" kindref="member">field_name</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3b6d54b300bbcdb2938b65c9c874816d" kindref="member">field_element</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1adfe2335e9285f6763e621507f58e7dbe" kindref="member">title</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2010844ba616d5eff8b33b304a3c579e" kindref="member">image_count</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a147fafa6fa51540f4b24baacb57d8737" kindref="member">image_style_count</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a03d90cecb1245653783f410fadc5e700" kindref="member">image_dict</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad0ec5bee6656270a914cc4e663ccf816" kindref="member">embedded_file_list</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3918d3b94228ae07a5ef248449a1ec1e" kindref="member">syntaxhighlighting</ref><sp/>=<sp/>1</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a68a48965ad5d8a369bc6bf5f4486306c" kindref="member">syntaxhighlight_lexer</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;python&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad247fea094ea26405e94765f4070352d" kindref="member">header_content</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a06b15e241d745ed59d9e67e009d13707" kindref="member">footer_content</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a162e80a4b4fdd4e67e3c07742b9e5acc" kindref="member">in_header</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aacd75104bc4f106e87bc64afb8f0e8e4" kindref="member">in_footer</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aef66fb292d12be0e049e607f6cc9fd6b" kindref="member">blockstyle</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae57991dc1c64f6130203923b65a30aef" kindref="member">in_table_of_contents</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a0f98082df799c787450af9ae80777a1f" kindref="member">table_of_content_index_body</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8cab21c1c48cb5b654ff5e32c97d2ff6" kindref="member">list_level</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad06cdf987fa7c83538c18bacd247b74d" kindref="member">def_list_level</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4680a6f4be54e2f2c08acf0c82b87b4d" kindref="member">footnote_ref_dict</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1adc9848a41e9bb14460178b335ba286a1" kindref="member">footnote_list</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af3d652276e1f91d25e2b87b3289a4702" kindref="member">footnote_chars_idx</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a410bb70b3433c0e8b939e2b6407cc16c" kindref="member">footnote_level</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a29cece08732216fb4323e075185ceebe" kindref="member">pending_ids</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a6923d7099a80e9043fc59293db3473be" kindref="member">in_paragraph</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a317f9f693c3275d00213ee930b473e46" kindref="member">found_doc_title</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a518bf5d58d428b6ae05f235daffb5444" kindref="member">bumped_list_level_stack</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afb3bb30c23ee3b9f54e44e07da5fb6be" kindref="member">meta_dict</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac04aece75b48e36f27db9930ffdee031" kindref="member">line_block_level</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad653f29ad4274f1a7a859fb939e475c2" kindref="member">line_indent_level</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a509f5846a08f695ee222d46f42f877e5" kindref="member">citation_id</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>=<sp/>0<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>use<sp/>to<sp/>form<sp/>unique<sp/>style<sp/>names</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af139140ccb1d759cccf8cb7ad07ccc18" kindref="member">str_stylesheet</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aaf5745762351a42c25b7aaef2d4716f2" kindref="member">str_stylesheetcontent</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1ee2f0d2c31407df3679c14a053222de" kindref="member">dom_stylesheet</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8f8604aab5c3d9a21ba582be19b49f31" kindref="member">table_styles</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1adc3c22cd46c2881f24d184d2631e1127" kindref="member">in_citation</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="913"><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Keep<sp/>track<sp/>of<sp/>nested<sp/>styling<sp/>classes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae26a5a68f773896778fefe6271219814" kindref="member">inline_style_count_stack</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="916"><highlight class="normal"></highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a04dd61c8d57a502280ac783377e9d3fd" kindref="member">get_str_stylesheet</ref>(self):</highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af139140ccb1d759cccf8cb7ad07ccc18" kindref="member">str_stylesheet</ref></highlight></codeline>
<codeline lineno="919"><highlight class="normal"></highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac7c445796bac34904d9cd0cef28a82bc" kindref="member">retrieve_styles</ref>(self,<sp/>extension):</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Retrieve<sp/>the<sp/>stylesheet<sp/>from<sp/>either<sp/>a<sp/>.xml<sp/>file<sp/>or<sp/>from</highlight></codeline>
<codeline lineno="922"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>.odt<sp/>(zip)<sp/>file.<sp/><sp/>Return<sp/>the<sp/>content<sp/>as<sp/>a<sp/>string.</highlight></codeline>
<codeline lineno="923"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s2<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stylespath<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.stylesheet</highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ext<sp/>=<sp/>os.path.splitext(stylespath)[1]</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ext<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;.xml&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>open(stylespath,<sp/></highlight><highlight class="stringliteral">&apos;r&apos;</highlight><highlight class="normal">,<sp/>encoding=</highlight><highlight class="stringliteral">&apos;utf-8&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>stylesfile:</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>stylesfile.read()</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>ext<sp/>==<sp/>extension:</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zfile<sp/>=<sp/>zipfile.ZipFile(stylespath,<sp/></highlight><highlight class="stringliteral">&apos;r&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>zfile.read(</highlight><highlight class="stringliteral">&apos;styles.xml&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s2<sp/>=<sp/>zfile.read(</highlight><highlight class="stringliteral">&apos;content.xml&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>zfile.close()</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(</highlight><highlight class="stringliteral">&apos;stylesheet<sp/>path<sp/>(%s)<sp/>must<sp/>be<sp/>%s<sp/>or<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;.xml<sp/>file&apos;</highlight><highlight class="normal"><sp/>%<sp/>(stylespath,<sp/>extension))</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af139140ccb1d759cccf8cb7ad07ccc18" kindref="member">str_stylesheet</ref><sp/>=<sp/>s1</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aaf5745762351a42c25b7aaef2d4716f2" kindref="member">str_stylesheetcontent</ref><sp/>=<sp/>s2</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1ee2f0d2c31407df3679c14a053222de" kindref="member">dom_stylesheet</ref><sp/>=<sp/>etree.fromstring(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af139140ccb1d759cccf8cb7ad07ccc18" kindref="member">str_stylesheet</ref>)</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad9f7924b46f1f251a45e37252a5054e9" kindref="member">dom_stylesheetcontent</ref><sp/>=<sp/>etree.fromstring(</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aaf5745762351a42c25b7aaef2d4716f2" kindref="member">str_stylesheetcontent</ref>)</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8f8604aab5c3d9a21ba582be19b49f31" kindref="member">table_styles</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a00450635ecdeb8c0fa2b0e5c3cc93f36" kindref="member">extract_table_styles</ref>(s2)</highlight></codeline>
<codeline lineno="944"><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a00450635ecdeb8c0fa2b0e5c3cc93f36" kindref="member">extract_table_styles</ref>(self,<sp/>styles_str):</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root<sp/>=<sp/>etree.fromstring(styles_str)</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_styles<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>auto_styles<sp/>=<sp/>root.find(</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{%s}automatic-styles&apos;</highlight><highlight class="normal"><sp/>%<sp/>(CNSD[</highlight><highlight class="stringliteral">&apos;office&apos;</highlight><highlight class="normal">],<sp/>))</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>stylenode<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>auto_styles:</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/>stylenode.get(</highlight><highlight class="stringliteral">&apos;{%s}name&apos;</highlight><highlight class="normal"><sp/>%<sp/>(CNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],<sp/>))</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tablename<sp/>=<sp/>name.split(</highlight><highlight class="stringliteral">&apos;.&apos;</highlight><highlight class="normal">)[0]</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>family<sp/>=<sp/>stylenode.get(</highlight><highlight class="stringliteral">&apos;{%s}family&apos;</highlight><highlight class="normal"><sp/>%<sp/>(CNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],<sp/>))</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>name.startswith(TABLESTYLEPREFIX):</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tablestyle<sp/>=<sp/>table_styles.get(tablename)</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>tablestyle<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tablestyle<sp/>=<sp/><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1TableStyle" kindref="compound">TableStyle</ref>()</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_styles[tablename]<sp/>=<sp/>tablestyle</highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>family<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;table&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>stylenode.find(</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{%s}table-properties&apos;</highlight><highlight class="normal"><sp/>%<sp/>(CNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],<sp/>))</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>property<sp/>=<sp/>properties.get(</highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{%s}%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(CNSD[</highlight><highlight class="stringliteral">&apos;fo&apos;</highlight><highlight class="normal">],<sp/></highlight><highlight class="stringliteral">&apos;background-color&apos;</highlight><highlight class="normal">,<sp/>))</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>property<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>property<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tablestyle.backgroundcolor<sp/>=<sp/>property</highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>family<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;table-cell&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>properties<sp/>=<sp/>stylenode.find(</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{%s}table-cell-properties&apos;</highlight><highlight class="normal"><sp/>%<sp/>(CNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],<sp/>))</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>properties<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>border<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5b935cdc90c80944f8f8b5df0f23d18f" kindref="member">get_property</ref>(properties)</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>border<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tablestyle.border<sp/>=<sp/>border</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>table_styles</highlight></codeline>
<codeline lineno="974"><highlight class="normal"></highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5b935cdc90c80944f8f8b5df0f23d18f" kindref="member">get_property</ref>(self,<sp/>stylenode):</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>border<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>propertyname<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>TABLEPROPERTYNAMES:</highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>border<sp/>=<sp/>stylenode.get(</highlight><highlight class="stringliteral">&apos;{%s}%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(CNSD[</highlight><highlight class="stringliteral">&apos;fo&apos;</highlight><highlight class="normal">],<sp/>propertyname,<sp/>))</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>border<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>border<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>border</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>border</highlight></codeline>
<codeline lineno="982"><highlight class="normal"></highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae9107fe061df32c80567377adfa8758e" kindref="member">add_doc_title</ref>(self):</highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>text<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.title</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>text:</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1adfe2335e9285f6763e621507f58e7dbe" kindref="member">title</ref><sp/>=<sp/>text</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a317f9f693c3275d00213ee930b473e46" kindref="member">found_doc_title</ref>:</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab43d5ae252940def01c6110427986c1a" kindref="member">Element</ref>(</highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(</highlight><highlight class="stringliteral">&apos;title&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.text<sp/>=<sp/>text</highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a04e4e353dfd34d130ed45c4012aa357e" kindref="member">body_text_element</ref>.insert(0,<sp/>el)</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7a5cc5db7ebdcefc51383eb9846fcb54" kindref="member">find_first_text_p</ref>(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a04e4e353dfd34d130ed45c4012aa357e" kindref="member">body_text_element</ref>)</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>el<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af317e9f108600b8012995ddba1eef16b" kindref="member">attach_page_style</ref>(el)</highlight></codeline>
<codeline lineno="996"><highlight class="normal"></highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7a5cc5db7ebdcefc51383eb9846fcb54" kindref="member">find_first_text_p</ref>(self,<sp/>el):</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Search<sp/>the<sp/>generated<sp/>doc<sp/>and<sp/>return<sp/>the<sp/>first<sp/>&lt;text:p&gt;<sp/>element.</highlight></codeline>
<codeline lineno="999"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>el.tag<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>el.tag<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;text:h&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>el</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>child<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>el:</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7a5cc5db7ebdcefc51383eb9846fcb54" kindref="member">find_first_text_p</ref>(child)</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>el1<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>el1</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"></highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af317e9f108600b8012995ddba1eef16b" kindref="member">attach_page_style</ref>(self,<sp/>el):</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Attach<sp/>the<sp/>default<sp/>page<sp/>style.</highlight></codeline>
<codeline lineno="1011"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1012"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Create<sp/>an<sp/>automatic-style<sp/>that<sp/>refers<sp/>to<sp/>the<sp/>current<sp/>style</highlight></codeline>
<codeline lineno="1013"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>this<sp/>element<sp/>and<sp/>that<sp/>refers<sp/>to<sp/>the<sp/>default<sp/>page<sp/>style.</highlight></codeline>
<codeline lineno="1014"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_style<sp/>=<sp/>el.get(</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;P1003&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5e17687dac8d2f93f633320012af8521" kindref="member">automatic_styles</ref>,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>style_name,</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:master-page-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;rststyle-pagedefault&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;paragraph&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>current_style:</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.set(</highlight><highlight class="stringliteral">&apos;style:parent-style-name&apos;</highlight><highlight class="normal">,<sp/>current_style)</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.set(</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">,<sp/>style_name)</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"></highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(self,<sp/>name,<sp/>parameters=()):</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1029"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>the<sp/>style<sp/>name<sp/>to<sp/>use<sp/>for<sp/>the<sp/>given<sp/>style.</highlight></codeline>
<codeline lineno="1030"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1031"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If<sp/>`parameters`<sp/>is<sp/>given<sp/>`name`<sp/>must<sp/>contain<sp/>a<sp/>matching<sp/>number<sp/>of</highlight></codeline>
<codeline lineno="1032"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>``%``<sp/>and<sp/>is<sp/>used<sp/>as<sp/>a<sp/>format<sp/>expression<sp/>with<sp/>`parameters`<sp/>as</highlight></codeline>
<codeline lineno="1033"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>value.</highlight></codeline>
<codeline lineno="1034"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name1<sp/>=<sp/>name<sp/>%<sp/>parameters</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2382ba60c8c604119e89b01396d8b4f8" kindref="member">format_map</ref>.get(name1,<sp/></highlight><highlight class="stringliteral">&apos;rststyle-%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>name1)</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"></highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1acdd146e1e19fecd849f8ccc5e32d0a9b" kindref="member">generate_content_element</ref>(self,<sp/>root):</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(root,<sp/></highlight><highlight class="stringliteral">&apos;office:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"></highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a165cc23fe63f795b6fee05bbc6c1c6b8" kindref="member">setup_page</ref>(self):</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4db7a59aff857220945e3db05a9e370e" kindref="member">setup_paper</ref>(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1ee2f0d2c31407df3679c14a053222de" kindref="member">dom_stylesheet</ref>)</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(len(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad247fea094ea26405e94765f4070352d" kindref="member">header_content</ref>)<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>len(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a06b15e241d745ed59d9e67e009d13707" kindref="member">footer_content</ref>)<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.custom_header</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.custom_footer):</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a74265ec4b87fcf6e14fe30ae2f932390" kindref="member">add_header_footer</ref>(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1ee2f0d2c31407df3679c14a053222de" kindref="member">dom_stylesheet</ref>)</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>etree.tostring(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1ee2f0d2c31407df3679c14a053222de" kindref="member">dom_stylesheet</ref>)</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"></highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a84bc26be8beaa79a64f8350feaee20d8" kindref="member">get_dom_stylesheet</ref>(self):</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1ee2f0d2c31407df3679c14a053222de" kindref="member">dom_stylesheet</ref></highlight></codeline>
<codeline lineno="1052"><highlight class="normal"></highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4db7a59aff857220945e3db05a9e370e" kindref="member">setup_paper</ref>(self,<sp/>root_el):</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>only<sp/>call<sp/>paperconf,<sp/>if<sp/>it<sp/>is<sp/>actually<sp/>used</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>(i.e.<sp/>page<sp/>size<sp/>removed<sp/>from<sp/>&quot;styles.odt&quot;<sp/>with<sp/>rst2odt_prepstyles.py</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>cf.<sp/>conditional<sp/>in<sp/>walk()<sp/>below)?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dimensions<sp/>=<sp/>subprocess.check_output((</highlight><highlight class="stringliteral">&apos;paperconf&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-s&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stderr=subprocess.STDOUT)</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w,<sp/>h<sp/>=<sp/>(float(s)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>s<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dimensions.split())</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>(subprocess.CalledProcessError,<sp/>FileNotFoundError,<sp/>ValueError):</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1nodes_1_1NodeVisitor_1a3c594de0457219c7836d4c53d9398cdc" kindref="member">document</ref>.reporter.info(</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Cannot<sp/>use<sp/>`paperconf`,<sp/>defaulting<sp/>to<sp/>Letter.&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w,<sp/>h<sp/>=<sp/>612,<sp/>792<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>default<sp/>to<sp/>Letter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1065"><highlight class="normal"></highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">walk(el):</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>el.tag<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;{%s}page-layout-properties&quot;</highlight><highlight class="normal"><sp/>%<sp/>SNSD[</highlight><highlight class="stringliteral">&quot;style&quot;</highlight><highlight class="normal">]<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>\</highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;{%s}page-width&quot;</highlight><highlight class="normal"><sp/>%<sp/>SNSD[</highlight><highlight class="stringliteral">&quot;fo&quot;</highlight><highlight class="normal">]<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>el.attrib:</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.attrib[</highlight><highlight class="stringliteral">&quot;{%s}page-width&quot;</highlight><highlight class="normal"><sp/>%<sp/>SNSD[</highlight><highlight class="stringliteral">&quot;fo&quot;</highlight><highlight class="normal">]]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;%.3fpt&quot;</highlight><highlight class="normal"><sp/>%<sp/>w</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.attrib[</highlight><highlight class="stringliteral">&quot;{%s}page-height&quot;</highlight><highlight class="normal"><sp/>%<sp/>SNSD[</highlight><highlight class="stringliteral">&quot;fo&quot;</highlight><highlight class="normal">]]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;%.3fpt&quot;</highlight><highlight class="normal"><sp/>%<sp/>h</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.attrib[</highlight><highlight class="stringliteral">&quot;{%s}margin-left&quot;</highlight><highlight class="normal"><sp/>%<sp/>SNSD[</highlight><highlight class="stringliteral">&quot;fo&quot;</highlight><highlight class="normal">]]<sp/>=<sp/>\</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.attrib[</highlight><highlight class="stringliteral">&quot;{%s}margin-right&quot;</highlight><highlight class="normal"><sp/>%<sp/>SNSD[</highlight><highlight class="stringliteral">&quot;fo&quot;</highlight><highlight class="normal">]]<sp/>=<sp/>\</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%.3fpt&quot;</highlight><highlight class="normal"><sp/>%<sp/>(.1<sp/>*<sp/>w)</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.attrib[</highlight><highlight class="stringliteral">&quot;{%s}margin-top&quot;</highlight><highlight class="normal"><sp/>%<sp/>SNSD[</highlight><highlight class="stringliteral">&quot;fo&quot;</highlight><highlight class="normal">]]<sp/>=<sp/>\</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.attrib[</highlight><highlight class="stringliteral">&quot;{%s}margin-bottom&quot;</highlight><highlight class="normal"><sp/>%<sp/>SNSD[</highlight><highlight class="stringliteral">&quot;fo&quot;</highlight><highlight class="normal">]]<sp/>=<sp/>\</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%.3fpt&quot;</highlight><highlight class="normal"><sp/>%<sp/>(.1<sp/>*<sp/>h)</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>subel<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>el:</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>walk(subel)</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>walk(root_el)</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a74265ec4b87fcf6e14fe30ae2f932390" kindref="member">add_header_footer</ref>(self,<sp/>root_el):</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>automatic_styles<sp/>=<sp/>root_el.find(</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{%s}automatic-styles&apos;</highlight><highlight class="normal"><sp/>%<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;office&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{%s}master-styles&apos;</highlight><highlight class="normal"><sp/>%<sp/>(NAME_SPACE_1,<sp/>)</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>master_el<sp/>=<sp/>root_el.find(path)</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>master_el<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{%s}master-page&apos;</highlight><highlight class="normal"><sp/>%<sp/>(SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],<sp/>)</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>master_el_container<sp/>=<sp/>master_el.findall(path)</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>master_el<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_attrib<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{%s}name&apos;</highlight><highlight class="normal"><sp/>%<sp/>(SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],<sp/>)</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>target_name<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(</highlight><highlight class="stringliteral">&apos;pagedefault&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>el<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>master_el_container:</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>el.get(target_attrib)<sp/>==<sp/>target_name:</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>master_el<sp/>=<sp/>el</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>master_el<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>master_el</highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad247fea094ea26405e94765f4070352d" kindref="member">header_content</ref><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.custom_header:</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1,<sp/></highlight><highlight class="stringliteral">&apos;style:header&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=STYLES_NAMESPACE_ATTRIB,</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsdict=STYLES_NAMESPACE_DICT,</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>el<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad247fea094ea26405e94765f4070352d" kindref="member">header_content</ref>:</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrkey<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.attrib[attrkey]<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(</highlight><highlight class="stringliteral">&apos;header&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.append(el)</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.custom_header:</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a58eaec6218d3060c4e12e225226caa31" kindref="member">create_custom_headfoot</ref>(</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2,</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.custom_header,<sp/></highlight><highlight class="stringliteral">&apos;header&apos;</highlight><highlight class="normal">,<sp/>automatic_styles)</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a06b15e241d745ed59d9e67e009d13707" kindref="member">footer_content</ref><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.custom_footer:</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1,<sp/></highlight><highlight class="stringliteral">&apos;style:footer&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=STYLES_NAMESPACE_ATTRIB,</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsdict=STYLES_NAMESPACE_DICT,</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>el<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a06b15e241d745ed59d9e67e009d13707" kindref="member">footer_content</ref>:</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrkey<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.attrib[attrkey]<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(</highlight><highlight class="stringliteral">&apos;footer&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.append(el)</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.custom_footer:</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a58eaec6218d3060c4e12e225226caa31" kindref="member">create_custom_headfoot</ref>(</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2,</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.custom_footer,<sp/></highlight><highlight class="stringliteral">&apos;footer&apos;</highlight><highlight class="normal">,<sp/>automatic_styles)</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"></highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/>code_none,<sp/>code_field,<sp/>code_text<sp/>=<sp/>list(range(3))</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/>field_pat<sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">r&apos;%(..?)%&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"></highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a58eaec6218d3060c4e12e225226caa31" kindref="member">create_custom_headfoot</ref>(</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,<sp/>parent,<sp/>text,<sp/>style_name,<sp/>automatic_styles):</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parent<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_element<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>field_iter<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1addd46130a4e3d7071e7503fea55a8089" kindref="member">split_field_specifiers_iter</ref>(text)</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>item<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>field_iter:</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>item[0]<sp/>==<sp/>ODFTranslator.code_field:</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>item[1]<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;p&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;P&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;t1&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;t2&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;t3&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;t4&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;d1&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;d2&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;d3&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;d4&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;d5&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;s&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;t&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;bad<sp/>field<sp/>spec:<sp/>%%%s%%&apos;</highlight><highlight class="normal"><sp/>%<sp/>(item[1],<sp/>)</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(msg)</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab68fb6655370d988262cbc99f65108cf" kindref="member">make_field_element</ref>(</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parent,</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>item[1],<sp/>style_name,<sp/>automatic_styles)</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>el1<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;bad<sp/>field<sp/>spec:<sp/>%%%s%%&apos;</highlight><highlight class="normal"><sp/>%<sp/>(item[1],<sp/>)</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(msg)</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_element<sp/>=<sp/>el1</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>current_element<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parent.text<sp/>=<sp/>item[1]</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current_element.tail<sp/>=<sp/>item[1]</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"></highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab68fb6655370d988262cbc99f65108cf" kindref="member">make_field_element</ref>(self,<sp/>parent,<sp/>text,<sp/>style_name,<sp/>automatic_styles):</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;p&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:page-number&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;text:style-name&apos;:<sp/>self.rststyle(style_name),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:select-page&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;current&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;P&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:page-count&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;text:style-name&apos;:<sp/>self.rststyle(style_name),</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;t1&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:time&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:fixed&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:data-style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rst-time-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;number:time-style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rst-time-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:hours&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:minutes&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;t2&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:time&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:fixed&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:data-style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rst-time-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;number:time-style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rst-time-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:hours&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:minutes&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:seconds&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;t3&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:time&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:fixed&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:data-style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rst-time-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;number:time-style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rst-time-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:hours&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:minutes&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:am-pm&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;t4&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:time&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:fixed&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:data-style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rst-time-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;number:time-style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rst-time-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:hours&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:minutes&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:seconds&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:am-pm&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;d1&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:date&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:data-style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;number:date-style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:automatic-order&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:month&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:day&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:year&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;d2&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:date&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:data-style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;number:date-style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:automatic-order&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:month&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:day&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:year&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;d3&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:date&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:data-style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;number:date-style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:automatic-order&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:month&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:textual&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:day&apos;</highlight><highlight class="normal">,<sp/>attrib={})</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:year&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;d4&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:date&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:data-style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;number:date-style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:automatic-order&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:month&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:textual&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:day&apos;</highlight><highlight class="normal">,<sp/>attrib={})</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:year&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;d5&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref><sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:date&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:data-style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;number:date-style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rst-date-style-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afae637718ba9de8f7b32b0c55afb9cf7" kindref="member">style_index</ref>,</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:number&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xmlns:style&apos;</highlight><highlight class="normal">:<sp/>SNSD[</highlight><highlight class="stringliteral">&apos;style&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:year&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;-&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:month&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;-&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;number:day&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;number:style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;long&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;s&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:subject&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;t&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:title&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style_name),</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>text<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;a&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/></highlight><highlight class="stringliteral">&apos;text:author-name&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:fixed&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;false&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>el1</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"></highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1addd46130a4e3d7071e7503fea55a8089" kindref="member">split_field_specifiers_iter</ref>(self,<sp/>text):</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos1<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mo<sp/>=<sp/>ODFTranslator.field_pat.search(text,<sp/>pos1)</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>mo:</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos2<sp/>=<sp/>mo.start()</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos2<sp/>&gt;<sp/>pos1:</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>ODFTranslator.code_text,<sp/>text[pos1:pos2]</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>ODFTranslator.code_field,<sp/>mo.group(1)</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos1<sp/>=<sp/>mo.end()</highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>trailing<sp/>=<sp/>text[pos1:]</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>trailing:</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>ODFTranslator.code_text,<sp/>trailing</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"></highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3f9e2a3a9f67be40babe1e5b58007c29" kindref="member">astext</ref>(self):</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2511f723ba1f6f77c316c5f18a09ba7e" kindref="member">content_tree</ref>.getroot()</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>et<sp/>=<sp/>etree.ElementTree(root)</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1abe3cf9a90138de24eeb3df33a5d102be" kindref="member">ToString</ref>(et)</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"></highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad794dc1e6c9449b32aa0388bfc8a57f7" kindref="member">content_astext</ref>(self):</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3f9e2a3a9f67be40babe1e5b58007c29" kindref="member">astext</ref>()</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"></highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aecf9470d6461c86cfc19098aa2e71024" kindref="member">set_title</ref>(self,<sp/>title):</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1adfe2335e9285f6763e621507f58e7dbe" kindref="member">title</ref><sp/>=<sp/>title</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"></highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a9ab70ae406c9737f989ed54cd8f6657a" kindref="member">get_title</ref>(self):</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1adfe2335e9285f6763e621507f58e7dbe" kindref="member">title</ref></highlight></codeline>
<codeline lineno="1442"><highlight class="normal"></highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4f6e98cfbee893fa0c1a0b28ec836c48" kindref="member">set_embedded_file_list</ref>(self,<sp/>embedded_file_list):</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad0ec5bee6656270a914cc4e663ccf816" kindref="member">embedded_file_list</ref><sp/>=<sp/>embedded_file_list</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"></highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a93a6be0d10023c07189e1c08b2a3816f" kindref="member">get_embedded_file_list</ref>(self):</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad0ec5bee6656270a914cc4e663ccf816" kindref="member">embedded_file_list</ref></highlight></codeline>
<codeline lineno="1448"><highlight class="normal"></highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a78ee31fea9f2413d9f20189a3a18ca28" kindref="member">get_meta_dict</ref>(self):</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afb3bb30c23ee3b9f54e44e07da5fb6be" kindref="member">meta_dict</ref></highlight></codeline>
<codeline lineno="1451"><highlight class="normal"></highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a947e27dd590ff0bbd3d84900ae50de25" kindref="member">process_footnotes</ref>(self):</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>node,<sp/>el1<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1adc9848a41e9bb14460178b335ba286a1" kindref="member">footnote_list</ref>:</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>backrefs<sp/>=<sp/>node.attributes.get(</highlight><highlight class="stringliteral">&apos;backrefs&apos;</highlight><highlight class="normal">,<sp/>[])</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>first<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ref<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>backrefs:</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4680a6f4be54e2f2c08acf0c82b87b4d" kindref="member">footnote_ref_dict</ref>.get(ref)</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>el2<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>first:</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>first<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/>copy.deepcopy(el1)</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.append(el3)</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(el2)<sp/>&gt;<sp/>0:<sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>and<sp/>&apos;id&apos;<sp/>in<sp/>el2.attrib:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>child<sp/>=<sp/>el2[0]</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ref1<sp/>=<sp/>child.text</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribkey<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(</highlight><highlight class="stringliteral">&apos;text:id&apos;</highlight><highlight class="normal">,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>id1<sp/>=<sp/>el2.get(attribkey,<sp/></highlight><highlight class="stringliteral">&apos;footnote-error&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>id1<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>id1<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tag<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(</highlight><highlight class="stringliteral">&apos;text:note-ref&apos;</highlight><highlight class="normal">,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.tag<sp/>=<sp/>tag</highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.endnotes_end_doc:</highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note_class<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;endnote&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note_class<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;footnote&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.attrib.clear()</highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribkey<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(</highlight><highlight class="stringliteral">&apos;text:note-class&apos;</highlight><highlight class="normal">,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.attrib[attribkey]<sp/>=<sp/>note_class</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribkey<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(</highlight><highlight class="stringliteral">&apos;text:ref-name&apos;</highlight><highlight class="normal">,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.attrib[attribkey]<sp/>=<sp/>id1</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribkey<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(</highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:reference-format&apos;</highlight><highlight class="normal">,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.attrib[attribkey]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;page&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.text<sp/>=<sp/>ref1</highlight></codeline>
<codeline lineno="1486"><highlight class="normal"></highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1488"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Utility<sp/>methods</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1489"><highlight class="normal"></highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a694bc339b470466c36d2a8dc13b67bc5" kindref="member">append_child</ref>(self,<sp/>tag,<sp/>attrib=None,<sp/>parent=None):</highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>parent<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parent<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref></highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(parent,<sp/>tag,<sp/>attrib)</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"></highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af3c9689f148cbd3e374720f89e949373" kindref="member">append_p</ref>(self,<sp/>style,<sp/>text=None):</highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a694bc339b470466c36d2a8dc13b67bc5" kindref="member">append_child</ref>(</highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(style)})</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa7a9440da9404a5b9be24ee7f4497eea" kindref="member">append_pending_ids</ref>(result)</highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>text<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.text<sp/>=<sp/>text</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"></highlight></codeline>
<codeline lineno="1503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa7a9440da9404a5b9be24ee7f4497eea" kindref="member">append_pending_ids</ref>(self,<sp/>el):</highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1658540f8568a3f80bddba03d7abda7e" kindref="member">settings</ref>.create_links:</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>id<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a29cece08732216fb4323e075185ceebe" kindref="member">pending_ids</ref>:</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;text:reference-mark&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:name&apos;</highlight><highlight class="normal">:<sp/>id})</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a29cece08732216fb4323e075185ceebe" kindref="member">pending_ids</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"></highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a19280ba39e838ada2b74ad76ec5c54be" kindref="member">set_current_element</ref>(self,<sp/>el):</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref><sp/>=<sp/>el</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"></highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5ddcbbb0a16f5376e9404a6dbcecca08" kindref="member">set_to_parent</ref>(self):</highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref>.getparent()</highlight></codeline>
<codeline lineno="1515"><highlight class="normal"></highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8929c28cf754694b010f0219acf52215" kindref="member">generate_labeled_block</ref>(self,<sp/>node,<sp/>label):</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%s:&apos;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a11e5e8a34328545401386ab6f2a58cca" kindref="member">language</ref>.labels[label],<sp/>)</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af3c9689f148cbd3e374720f89e949373" kindref="member">append_p</ref>(</highlight><highlight class="stringliteral">&apos;textbody&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="1520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(</highlight><highlight class="stringliteral">&apos;strong&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>label</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af3c9689f148cbd3e374720f89e949373" kindref="member">append_p</ref>(</highlight><highlight class="stringliteral">&apos;blockindent&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"></highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a115130777ab563d7ab783f92cf7196e1" kindref="member">generate_labeled_line</ref>(self,<sp/>node,<sp/>label):</highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%s:&apos;</highlight><highlight class="normal"><sp/>%<sp/>(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a11e5e8a34328545401386ab6f2a58cca" kindref="member">language</ref>.labels[label],<sp/>)</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af3c9689f148cbd3e374720f89e949373" kindref="member">append_p</ref>(</highlight><highlight class="stringliteral">&apos;textbody&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a43eea1d2b07ebd05ab536cde50cff0f6" kindref="member">rststyle</ref>(</highlight><highlight class="stringliteral">&apos;strong&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>label</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.tail<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>el</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"></highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">encode(self,<sp/>text):</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>text.replace(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;<sp/>&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"></highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Visitor<sp/>functions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>In<sp/>alphabetic<sp/>order,<sp/>more<sp/>or<sp/>less.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>See<sp/>docutils.docutils.nodes.node_class_names.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1544"><highlight class="normal"></highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a163a6f7e93c529ab60332f423767c51f" kindref="member">dispatch_visit</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Override<sp/>to<sp/>catch<sp/>basic<sp/>attributes<sp/>which<sp/>many<sp/>nodes<sp/>have.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a283062263704f416c71276a85feabfaf" kindref="member">handle_basic_atts</ref>(node)</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes.GenericNodeVisitor.dispatch_visit(self,<sp/>node)</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"></highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a283062263704f416c71276a85feabfaf" kindref="member">handle_basic_atts</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node,<sp/><ref refid="classdocutils_1_1nodes_1_1Element" kindref="compound">nodes.Element</ref>)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>node[</highlight><highlight class="stringliteral">&apos;ids&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a29cece08732216fb4323e075185ceebe" kindref="member">pending_ids</ref><sp/>+=<sp/>node[</highlight><highlight class="stringliteral">&apos;ids&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"></highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad7e156e622ba30290deecfce13b86e92" kindref="member">default_visit</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1nodes_1_1NodeVisitor_1a3c594de0457219c7836d4c53d9398cdc" kindref="member">document</ref>.reporter.warning(</highlight><highlight class="stringliteral">&apos;missing<sp/>visit_%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(node.tagname,<sp/>))</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"></highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1affd528321c5946a1baf7b5248d35e381" kindref="member">default_departure</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1nodes_1_1NodeVisitor_1a3c594de0457219c7836d4c53d9398cdc" kindref="member">document</ref>.reporter.warning(</highlight><highlight class="stringliteral">&apos;missing<sp/>depart_%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(node.tagname,<sp/>))</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"></highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a38ac3d7e2776048418875dea501c2174" kindref="member">visit_Text</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Skip<sp/>nodes<sp/>whose<sp/>text<sp/>has<sp/>been<sp/>processed<sp/>in<sp/>parent<sp/>nodes.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1literal__block" kindref="compound">docutils.nodes.literal_block</ref>):</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>text<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Are<sp/>we<sp/>in<sp/>mixed<sp/>content?<sp/><sp/>If<sp/>so,<sp/>add<sp/>the<sp/>text<sp/>to<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>etree<sp/>tail<sp/>of<sp/>the<sp/>previous<sp/>sibling<sp/>element.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref>)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref>[-1].tail:</highlight></codeline>
<codeline lineno="1569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref>[-1].tail<sp/>+=<sp/>text</highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref>[-1].tail<sp/>=<sp/>text</highlight></codeline>
<codeline lineno="1572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref>.text:</highlight></codeline>
<codeline lineno="1574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref>.text<sp/>+=<sp/>text</highlight></codeline>
<codeline lineno="1575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a540b4f150cb3a2044e76e4467be1ba2d" kindref="member">current_element</ref>.text<sp/>=<sp/>text</highlight></codeline>
<codeline lineno="1577"><highlight class="normal"></highlight></codeline>
<codeline lineno="1578"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a9f347b64f674b98641ec5da049c1a8ba" kindref="member">depart_Text</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1580"><highlight class="normal"></highlight></codeline>
<codeline lineno="1581"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Pre-defined<sp/>fields</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1584"><highlight class="normal"></highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afbc94aabdda597b2adf95e114ebb0734" kindref="member">visit_address</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.generate_labeled_block(node,<sp/></highlight><highlight class="stringliteral">&apos;address&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"></highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa8a98bc883fb99352eaa35f0a5c097d6" kindref="member">depart_address</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"></highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac2a4efcacbb1a1a440158af0ee90650f" kindref="member">visit_author</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/>nodes.authors):</highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;blockindent&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.generate_labeled_block(node,<sp/></highlight><highlight class="stringliteral">&apos;author&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"></highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab6dadfc7d81137819d188d1689bca8e7" kindref="member">depart_author</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1601"><highlight class="normal"></highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a87fc1b48be8d9ebac0cfa9fdf2bda1f8" kindref="member">visit_authors</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%s:&apos;</highlight><highlight class="normal"><sp/>%<sp/>(self.language.labels[</highlight><highlight class="stringliteral">&apos;authors&apos;</highlight><highlight class="normal">],<sp/>)</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;textbody&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;strong&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="1608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>label</highlight></codeline>
<codeline lineno="1609"><highlight class="normal"></highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a292af62b09fb361b06636babdbec7e1a" kindref="member">depart_authors</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1612"><highlight class="normal"></highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1cbdb147875c29f89add2c851ca706b3" kindref="member">visit_contact</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.generate_labeled_block(node,<sp/></highlight><highlight class="stringliteral">&apos;contact&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"></highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae4d80146f56388ea2fc9bcbbc382fa15" kindref="member">depart_contact</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"></highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1affdf73800779ade83481260293e0c6c0" kindref="member">visit_copyright</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.generate_labeled_block(node,<sp/></highlight><highlight class="stringliteral">&apos;copyright&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"></highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5848ab57a0cdbb2246633d2eb13aef3d" kindref="member">depart_copyright</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1626"><highlight class="normal"></highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae86002b9afa77e21cb65379170dc6a0d" kindref="member">visit_date</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_labeled_line(node,<sp/></highlight><highlight class="stringliteral">&apos;date&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1629"><highlight class="normal"></highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af3af9613db67037a0721171b69391131" kindref="member">depart_date</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1632"><highlight class="normal"></highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5859b0a378b6c2fb81e195410c4a4728" kindref="member">visit_organization</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.generate_labeled_block(node,<sp/></highlight><highlight class="stringliteral">&apos;organization&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"></highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a29db732ece9ab8f8ff5a6715b763fa2b" kindref="member">depart_organization</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"></highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a596b32d43d787db3865e181391d19ec7" kindref="member">visit_status</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.generate_labeled_block(node,<sp/></highlight><highlight class="stringliteral">&apos;status&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"></highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5e88f5e3025b3734eb2cc4460639895c" kindref="member">depart_status</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1646"><highlight class="normal"></highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a9399e4468763ca222e373c4a2198cc9f" kindref="member">visit_revision</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_labeled_line(node,<sp/></highlight><highlight class="stringliteral">&apos;revision&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1649"><highlight class="normal"></highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5aa6970464b52e40a8050f8f22cd0e99" kindref="member">depart_revision</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1652"><highlight class="normal"></highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3cef7bf0026a0aa61f8ba53c9bb03ae2" kindref="member">visit_version</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_labeled_line(node,<sp/></highlight><highlight class="stringliteral">&apos;version&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>self.set_current_element(el)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1656"><highlight class="normal"></highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a0d66f9bcc9dac210b8d52901ad73069a" kindref="member">depart_version</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>self.set_to_parent()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1660"><highlight class="normal"></highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab40746b996b1b452735948dc128a2ac5" kindref="member">visit_attribution</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;attribution&apos;</highlight><highlight class="normal">,<sp/>node.astext())</highlight></codeline>
<codeline lineno="1663"><highlight class="normal"></highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aafde07214c23a9a13592c4de397cefb2" kindref="member">depart_attribution</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1666"><highlight class="normal"></highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3976d3bf900c0fe4bda7987a51123e86" kindref="member">visit_block_quote</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;epigraph&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;epigraph&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.blockstyle<sp/>=<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;epigraph&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;highlights&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;highlights&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.blockstyle<sp/>=<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;highlights&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;blockquote&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.blockstyle<sp/>=<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;blockquote&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.line_indent_level<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"></highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1abfd041604c566d3aa21f4a36286e723c" kindref="member">depart_block_quote</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.blockstyle<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.line_indent_level<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"></highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac5beab66d10e112f418b628115be1a7b" kindref="member">visit_bullet_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_level<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.in_table_of_contents:</highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.generate_oowriter_toc:</highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>\</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;auto-toc&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="1692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;tocenumlist&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;enumitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;tocbulletlist&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;bulletitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.blockstyle<sp/>==<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;blockquote&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;blockquote-bulletlist&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;blockquote-bulletitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.blockstyle<sp/>==<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;highlights&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;highlights-bulletlist&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;highlights-bulletitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.blockstyle<sp/>==<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;epigraph&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;epigraph-bulletlist&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;epigraph-bulletitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;bulletlist&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;bulletitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"></highlight></codeline>
<codeline lineno="1728"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa69a4e6b8b204be844d09232d61adec2" kindref="member">depart_bullet_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.in_table_of_contents:</highlight></codeline>
<codeline lineno="1730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.generate_oowriter_toc:</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.pop()</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.pop()</highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_level<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"></highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a54e16361da930dd0647da52e9551935f" kindref="member">visit_caption</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>nodes.SkipChildren()</highlight></codeline>
<codeline lineno="1742"><highlight class="normal"></highlight></codeline>
<codeline lineno="1743"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a22228831f6aa30f4e886930ff9fb5339" kindref="member">depart_caption</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1745"><highlight class="normal"></highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af3c5d7a214133e71da13f016d300ebdb" kindref="member">visit_comment</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;textbody&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;office:annotation&apos;</highlight><highlight class="normal">,<sp/>attrib={})</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;dc:creator&apos;</highlight><highlight class="normal">,<sp/>attrib={})</highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>os.environ.get(</highlight><highlight class="stringliteral">&apos;USER&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.text<sp/>=<sp/>s1</highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={})</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.text<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="1754"><highlight class="normal"></highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a345f0c72276835c7b603a2c7c350bfad" kindref="member">depart_comment</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1757"><highlight class="normal"></highlight></codeline>
<codeline lineno="1758"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab33679023ff39ec34cc9c555f5d6d48f" kindref="member">visit_compound</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>compound<sp/>directive<sp/>currently<sp/>receives<sp/>no<sp/>special<sp/>treatment.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1761"><highlight class="normal"></highlight></codeline>
<codeline lineno="1762"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3cc9084736221a12492c2d1fa3befca2" kindref="member">depart_compound</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1764"><highlight class="normal"></highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af1e783e77020ab96cf240ebbf05299db" kindref="member">visit_container</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>styles<sp/>=<sp/>node.attributes.get(</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">,<sp/>())</highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(styles)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.rststyle(styles[0]))</highlight></codeline>
<codeline lineno="1769"><highlight class="normal"></highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac5c2bb8a1be6a8418ac3b220ff18bbac" kindref="member">depart_container</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>styles<sp/>=<sp/>node.attributes.get(</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">,<sp/>())</highlight></codeline>
<codeline lineno="1772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(styles)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="1774"><highlight class="normal"></highlight></codeline>
<codeline lineno="1775"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a542259c9830f4faebea55ba5a86eb9e1" kindref="member">visit_decoration</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1777"><highlight class="normal"></highlight></codeline>
<codeline lineno="1778"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a09e51829b1186a69f230c69fe16cad8b" kindref="member">depart_decoration</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1780"><highlight class="normal"></highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a09930b7a9c56d2e18a3c47d250c6e402" kindref="member">visit_definition_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.def_list_level<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.list_level<sp/>&gt;<sp/>5:</highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(</highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;max<sp/>definition<sp/>list<sp/>nesting<sp/>level<sp/>exceeded&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1786"><highlight class="normal"></highlight></codeline>
<codeline lineno="1787"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa88a9656ea3012ad97184fb9d6390d95" kindref="member">depart_definition_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.def_list_level<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="1789"><highlight class="normal"></highlight></codeline>
<codeline lineno="1790"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad06ebcaaeb45b8ee12e91a8fb680daa7" kindref="member">visit_definition_list_item</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1792"><highlight class="normal"></highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1e1c0ba106cd242dfcbcee73210030b3" kindref="member">depart_definition_list_item</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1795"><highlight class="normal"></highlight></codeline>
<codeline lineno="1796"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a42a36987fab707bca85718d6885804e3" kindref="member">visit_term</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;deflist-term-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.def_list_level)</highlight></codeline>
<codeline lineno="1798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.text<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>nodes.SkipChildren()</highlight></codeline>
<codeline lineno="1801"><highlight class="normal"></highlight></codeline>
<codeline lineno="1802"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a0fa6d565176f93501255cc4d11f72f03" kindref="member">depart_term</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1804"><highlight class="normal"></highlight></codeline>
<codeline lineno="1805"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a82f5b8d159d26ac56e61066145ef10c6" kindref="member">visit_definition</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(</highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;deflist-def-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.def_list_level))</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.bumped_list_level_stack.append(ListLevel(1))</highlight></codeline>
<codeline lineno="1809"><highlight class="normal"></highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae4a159af296c915096687f9ed4702c31" kindref="member">depart_definition</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.bumped_list_level_stack.pop()</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"></highlight></codeline>
<codeline lineno="1814"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2caf3701b582ade02138fa48bd3c4742" kindref="member">visit_classifier</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.current_element)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.current_element[-1]</highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;emphasis&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>(%s)&apos;</highlight><highlight class="normal"><sp/>%<sp/>(node.astext(),<sp/>)</highlight></codeline>
<codeline lineno="1821"><highlight class="normal"></highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae83c48f0cc935a21c4e29ce171982ebe" kindref="member">depart_classifier</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1824"><highlight class="normal"></highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a72a5fd6e3e1ca402094d721613d0e614" kindref="member">visit_document</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1827"><highlight class="normal"></highlight></codeline>
<codeline lineno="1828"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a622febd4b5f17df68ef549871cc19943" kindref="member">depart_document</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.process_footnotes()</highlight></codeline>
<codeline lineno="1830"><highlight class="normal"></highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7f1cd5ad8222f544f166feed2aa5a672" kindref="member">visit_docinfo</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.section_level<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.section_count<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_sections:</highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:section&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Section%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.section_count,</highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Sect%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.section_level,</highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="1841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"></highlight></codeline>
<codeline lineno="1843"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab88ce4153ceaeba3cce378d8c5cc15f7" kindref="member">depart_docinfo</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.section_level<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="1845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_sections:</highlight></codeline>
<codeline lineno="1846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1847"><highlight class="normal"></highlight></codeline>
<codeline lineno="1848"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a30022319af90fd00bf514a540d04cd49" kindref="member">visit_emphasis</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;emphasis&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"></highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a035ab9b78039c8e0cfac986c361129b9" kindref="member">depart_emphasis</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1856"><highlight class="normal"></highlight></codeline>
<codeline lineno="1857"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2eef6945e30133610bca51fd78340466" kindref="member">visit_enumerated_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.current_element</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.blockstyle<sp/>==<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;blockquote&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;blockquote-enumlist&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;blockquote-enumitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.blockstyle<sp/>==<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;highlights&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;highlights-enumlist&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;highlights-enumitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.blockstyle<sp/>==<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;epigraph&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;epigraph-enumlist&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;epigraph-enumitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>liststylename<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;enumlist-%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(node.get(</highlight><highlight class="stringliteral">&apos;enumtype&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;arabic&apos;</highlight><highlight class="normal">),<sp/>)</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="1877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(liststylename),</highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;enumitem&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el2)</highlight></codeline>
<codeline lineno="1881"><highlight class="normal"></highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a235d1321d355503ded2a75d02d83fde7" kindref="member">depart_enumerated_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.list_style_stack.pop()</highlight></codeline>
<codeline lineno="1885"><highlight class="normal"></highlight></codeline>
<codeline lineno="1886"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a36447f769c0efa6b25d3c23ca1698e51" kindref="member">visit_list_item</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>we<sp/>are<sp/>in<sp/>a<sp/>&quot;bumped&quot;<sp/>list<sp/>level,<sp/>then<sp/>wrap<sp/>this</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>list<sp/>in<sp/>an<sp/>outer<sp/>lists<sp/>in<sp/>order<sp/>to<sp/>increase<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>indentation<sp/>level.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.in_table_of_contents:</highlight></codeline>
<codeline lineno="1891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.generate_oowriter_toc:</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(</highlight></codeline>
<codeline lineno="1893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;contents-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>(self.list_level,<sp/>)))</highlight></codeline>
<codeline lineno="1894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:list-item&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el1)</highlight></codeline>
<codeline lineno="1897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:list-item&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/>el1</highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.bumped_list_level_stack)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level_obj<sp/>=<sp/>self.bumped_list_level_stack[-1]</highlight></codeline>
<codeline lineno="1902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>level_obj.get_sibling():</highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level_obj.set_nested(</highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>level_obj1<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.bumped_list_level_stack:</highlight></codeline>
<codeline lineno="1905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>idx<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(level_obj1.get_level()):</highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:list&apos;</highlight><highlight class="normal">,<sp/>parent=el3)</highlight></codeline>
<codeline lineno="1907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/>self.append_child(</highlight></codeline>
<codeline lineno="1908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:list-item&apos;</highlight><highlight class="normal">,<sp/>parent=el2)</highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.list_style_stack[-1])</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el3)</highlight></codeline>
<codeline lineno="1911"><highlight class="normal"></highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8eefa27a872fb74f3b84f3ed9611e10b" kindref="member">depart_list_item</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.in_table_of_contents:</highlight></codeline>
<codeline lineno="1914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.generate_oowriter_toc:</highlight></codeline>
<codeline lineno="1915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.bumped_list_level_stack)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level_obj<sp/>=<sp/>self.bumped_list_level_stack[-1]</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>level_obj.get_sibling():</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level_obj.set_nested(</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>level_obj1<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.bumped_list_level_stack:</highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>idx<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(level_obj1.get_level()):</highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="1929"><highlight class="normal"></highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a31003cdde60b5674358be6b705467676" kindref="member">visit_header</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_header<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1932"><highlight class="normal"></highlight></codeline>
<codeline lineno="1933"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a63b7cc442f31fa26a93de21ad92b18e0" kindref="member">depart_header</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_header<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1935"><highlight class="normal"></highlight></codeline>
<codeline lineno="1936"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a31556ff814967cff365c51e2b6f2aa12" kindref="member">visit_footer</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_footer<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1938"><highlight class="normal"></highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a54daa02da2221c11ff3cbe1df052811b" kindref="member">depart_footer</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_footer<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1941"><highlight class="normal"></highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac4a5514a06d9ffe406c05c10e567a779" kindref="member">visit_field</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1944"><highlight class="normal"></highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa9496402d1e04942641b14528b1a9154" kindref="member">depart_field</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1947"><highlight class="normal"></highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8972aa481a3811717ea5b8acaf58b2fe" kindref="member">visit_field_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1950"><highlight class="normal"></highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7e23f46fb5aa5480ba2568416014dd5d" kindref="member">depart_field_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1953"><highlight class="normal"></highlight></codeline>
<codeline lineno="1954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae90255d81639671d15cf7eeefeb341e3" kindref="member">visit_field_name</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;textbody&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;strong&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="1959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="1960"><highlight class="normal"></highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a71daed001bd451bc408d18d236b144a4" kindref="member">depart_field_name</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1963"><highlight class="normal"></highlight></codeline>
<codeline lineno="1964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a15594ceab4b46a290c56ed8aa2fc221b" kindref="member">visit_field_body</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;blockindent&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1966"><highlight class="normal"></highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1adc554b5b7ffc4c6aff5bb3d7201deb22" kindref="member">depart_field_body</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="1969"><highlight class="normal"></highlight></codeline>
<codeline lineno="1970"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa8ae44e98d96f23b785fb4f27cee47a3" kindref="member">visit_figure</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1972"><highlight class="normal"></highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a632e3d15bdef6c431407b622ec4cf240" kindref="member">depart_figure</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1975"><highlight class="normal"></highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a009fa93aa64ddd4eec8963d29a97c5a5" kindref="member">visit_footnote</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.footnote_level<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.save_footnote_current<sp/>=<sp/>self.current_element</highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab43d5ae252940def01c6110427986c1a" kindref="member">Element</ref>(</highlight><highlight class="stringliteral">&apos;text:note-body&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element<sp/>=<sp/>el1</highlight></codeline>
<codeline lineno="1981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.footnote_list.append((node,<sp/>el1))</highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node,<sp/><ref refid="classdocutils_1_1nodes_1_1citation" kindref="compound">docutils.nodes.citation</ref>):</highlight></codeline>
<codeline lineno="1983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;citation&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;footnote&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1986"><highlight class="normal"></highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac67cc9a44f15fbde9b1688ce4444c2aa" kindref="member">depart_footnote</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element<sp/>=<sp/>self.save_footnote_current</highlight></codeline>
<codeline lineno="1990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.footnote_level<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="1991"><highlight class="normal"></highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/>footnote_chars<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;**&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;***&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;++&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;+++&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;##&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;###&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;@@&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;@@@&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1997"><highlight class="normal"><sp/><sp/><sp/><sp/>]</highlight></codeline>
<codeline lineno="1998"><highlight class="normal"></highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa0f43cb604d7dd61480bdd6699b9aec2" kindref="member">visit_footnote_reference</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.footnote_level<sp/>&lt;=<sp/>0:</highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>id<sp/>=<sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;ids&apos;</highlight><highlight class="normal">][0]</highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>refid<sp/>=<sp/>node.attributes.get(</highlight><highlight class="stringliteral">&apos;refid&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>refid<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>refid<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.endnotes_end_doc:</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note_class<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;endnote&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note_class<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;footnote&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:note&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:id&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(refid,<sp/>),</highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:note-class&apos;</highlight><highlight class="normal">:<sp/>note_class,</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>note_auto<sp/>=<sp/>str(node.attributes.get(</highlight><highlight class="stringliteral">&apos;auto&apos;</highlight><highlight class="normal">,<sp/>1))</highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node,<sp/><ref refid="classdocutils_1_1nodes_1_1citation__reference" kindref="compound">docutils.nodes.citation_reference</ref>):</highlight></codeline>
<codeline lineno="2015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>citation<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;[%s]&apos;</highlight><highlight class="normal"><sp/>%<sp/>node.astext()</highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:note-citation&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:label&apos;</highlight><highlight class="normal">:<sp/>citation,</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.text<sp/>=<sp/>citation</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>note_auto<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;1&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:note-citation&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:label&apos;</highlight><highlight class="normal">:<sp/>node.astext(),</highlight></codeline>
<codeline lineno="2023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.text<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="2025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>note_auto<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.footnote_chars_idx<sp/>&gt;=<sp/>len(</highlight></codeline>
<codeline lineno="2027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ODFTranslator.footnote_chars):</highlight></codeline>
<codeline lineno="2028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.footnote_chars_idx<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="2029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>footnote_char<sp/>=<sp/>ODFTranslator.footnote_chars[</highlight></codeline>
<codeline lineno="2030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.footnote_chars_idx]</highlight></codeline>
<codeline lineno="2031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.footnote_chars_idx<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:note-citation&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:label&apos;</highlight><highlight class="normal">:<sp/>footnote_char,</highlight></codeline>
<codeline lineno="2034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.text<sp/>=<sp/>footnote_char</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.footnote_ref_dict[id]<sp/>=<sp/>el1</highlight></codeline>
<codeline lineno="2037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>nodes.SkipChildren()</highlight></codeline>
<codeline lineno="2038"><highlight class="normal"></highlight></codeline>
<codeline lineno="2039"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad37a37f7ec7cbea01e0eede9b3cdd53c" kindref="member">depart_footnote_reference</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2041"><highlight class="normal"></highlight></codeline>
<codeline lineno="2042"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8cca37237500d654d564d65b6d170823" kindref="member">visit_citation</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_citation<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>id<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;ids&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="2045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.citation_id<sp/>=<sp/>id</highlight></codeline>
<codeline lineno="2046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;blockindent&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.bumped_list_level_stack.append(ListLevel(1))</highlight></codeline>
<codeline lineno="2049"><highlight class="normal"></highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2567815f88c05cdaa40a55d4bdaee394" kindref="member">depart_citation</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.citation_id<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.bumped_list_level_stack.pop()</highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_citation<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2055"><highlight class="normal"></highlight></codeline>
<codeline lineno="2056"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab9f81f04cfa68f0fc1e7d37f8ed8281b" kindref="member">visit_citation_reference</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_links:</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>id<sp/>=<sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;refid&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:reference-ref&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:ref-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(id,<sp/>),</highlight></codeline>
<codeline lineno="2061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:reference-format&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;text&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.current_element.text<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element.text<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2069"><highlight class="normal"></highlight></codeline>
<codeline lineno="2070"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a13863d8b2faaec2f489d3a9703f35a76" kindref="member">depart_citation_reference</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element.text<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;]&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_links:</highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"></highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a9e0afddff0fd8bb2aa391dd8e6e11a95" kindref="member">visit_label</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1footnote" kindref="compound">docutils.nodes.footnote</ref>):</highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>nodes.SkipChildren()</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.citation_id<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;textbody&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_links:</highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el0<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el0.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:reference-mark-start&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(self.citation_id,<sp/>),</highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2089"><highlight class="normal"></highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af8f943386ffc69edf368d62a4f8a5e52" kindref="member">depart_label</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1footnote" kindref="compound">docutils.nodes.footnote</ref>):</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.citation_id<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_links:</highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:reference-mark-end&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(self.citation_id,<sp/>),</highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el0<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el0.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;]&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element.text<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;]&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2103"><highlight class="normal"></highlight></codeline>
<codeline lineno="2104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7979e719d92c5ab6800cffde0b6b3065" kindref="member">visit_generated</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2106"><highlight class="normal"></highlight></codeline>
<codeline lineno="2107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a57a2a22e8779ecfaf5df0ade80edfb9e" kindref="member">depart_generated</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2109"><highlight class="normal"></highlight></codeline>
<codeline lineno="2110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1acd455407db5bb788664998490410743b" kindref="member">check_file_exists</ref>(self,<sp/>path):</highlight></codeline>
<codeline lineno="2111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>os.path.exists(path):</highlight></codeline>
<codeline lineno="2112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1</highlight></codeline>
<codeline lineno="2113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="2115"><highlight class="normal"></highlight></codeline>
<codeline lineno="2116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4a5995d35b4d8696cbfccb5b42f4083e" kindref="member">visit_image</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Capture<sp/>the<sp/>image<sp/>file.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>source<sp/>=<sp/>node[</highlight><highlight class="stringliteral">&apos;uri&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uri_parts<sp/>=<sp/>urllib.parse.urlparse(source)</highlight></codeline>
<codeline lineno="2120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>uri_parts.scheme<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>(</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;file&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>source<sp/>=<sp/>urllib.parse.unquote(uri_parts.path)</highlight></codeline>
<codeline lineno="2122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>source.startswith(</highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root_prefix<sp/>=<sp/>Path(self.settings.root_prefix)</highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>source<sp/>=<sp/>(root_prefix/source[1:]).as_posix()</highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>adapt<sp/>relative<sp/>paths</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>docsource,<sp/>line<sp/>=<sp/>utils.get_source_line(node)</highlight></codeline>
<codeline lineno="2128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>docsource:</highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dirname<sp/>=<sp/>os.path.dirname(docsource)</highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>dirname:</highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>source<sp/>=<sp/>os.path.join(dirname,<sp/>source)</highlight></codeline>
<codeline lineno="2132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.check_file_exists(source):</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&apos;Cannot<sp/>find<sp/>image<sp/>file<sp/>&quot;{source}&quot;.&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>source<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.image_dict:</highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>filename,<sp/>destination<sp/>=<sp/>self.image_dict[source]</highlight></codeline>
<codeline lineno="2138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.image_count<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>filename<sp/>=<sp/>os.path.split(source)[1]</highlight></codeline>
<codeline lineno="2141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>destination<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Pictures/1%08x%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(self.image_count,<sp/>filename)</highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>uri_parts.scheme<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>(</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;file&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec<sp/>=<sp/>(os.path.abspath(source),<sp/>destination,)</highlight></codeline>
<codeline lineno="2144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>urllib.request.urlopen(source)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>imgfile:</highlight></codeline>
<codeline lineno="2147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>content<sp/>=<sp/>imgfile.read()</highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>urllib.error.URLError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>err:</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&apos;Cannot<sp/>open<sp/>image<sp/>URL<sp/>&quot;{source}&quot;.<sp/>{err}&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>tempfile.NamedTemporaryFile(</highlight><highlight class="stringliteral">&apos;wb&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>delete=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>imgfile2:</highlight></codeline>
<codeline lineno="2154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>imgfile2.write(content)</highlight></codeline>
<codeline lineno="2155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>source<sp/>=<sp/>imgfile2.name</highlight></codeline>
<codeline lineno="2156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spec<sp/>=<sp/>(source,<sp/>destination,)</highlight></codeline>
<codeline lineno="2157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.embedded_file_list.append(spec)</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.image_dict[source]<sp/>=<sp/>(source,<sp/>destination,)</highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Is<sp/>this<sp/>a<sp/>figure<sp/>(containing<sp/>an<sp/>image)<sp/>or<sp/>just<sp/>a<sp/>plain<sp/>image?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.in_paragraph:</highlight></codeline>
<codeline lineno="2161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.current_element</highlight></codeline>
<codeline lineno="2162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;textbody&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="2166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/>el1</highlight></codeline>
<codeline lineno="2167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1figure" kindref="compound">docutils.nodes.figure</ref>):</highlight></codeline>
<codeline lineno="2168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3,<sp/>el4,<sp/>el5,<sp/>caption<sp/>=<sp/>self.generate_figure(</highlight></codeline>
<codeline lineno="2169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node,<sp/>source,</highlight></codeline>
<codeline lineno="2170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>destination,<sp/>el2)</highlight></codeline>
<codeline lineno="2171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="2172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el6,<sp/>width<sp/>=<sp/>self.generate_image(</highlight></codeline>
<codeline lineno="2173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node,<sp/>source,<sp/>destination,</highlight></codeline>
<codeline lineno="2174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el5,<sp/>attrib)</highlight></codeline>
<codeline lineno="2175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>caption<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el6.tail<sp/>=<sp/>caption</highlight></codeline>
<codeline lineno="2177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:<sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>if<sp/>isinstance(node.parent,<sp/>docutils.nodes.image):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_image(node,<sp/>source,<sp/>destination,<sp/>el2)</highlight></codeline>
<codeline lineno="2179"><highlight class="normal"></highlight></codeline>
<codeline lineno="2180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad3e109d84c13b4af712d9195beb55bea" kindref="member">depart_image</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2182"><highlight class="normal"></highlight></codeline>
<codeline lineno="2183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3e0a94bf98ff27be79355186fcf2c589" kindref="member">get_image_width_height</ref>(self,<sp/>node,<sp/>attr):</highlight></codeline>
<codeline lineno="2184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unit<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>attr<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes:</highlight></codeline>
<codeline lineno="2187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>node.attributes[attr]</highlight></codeline>
<codeline lineno="2188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>size.strip()</highlight></codeline>
<codeline lineno="2189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>For<sp/>conversion<sp/>factors,<sp/>see:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>http://www.unitconversion.org/unit_converter/typography-ex.html</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>size.endswith(</highlight><highlight class="stringliteral">&apos;%&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>attr<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;height&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Percentage<sp/>allowed<sp/>for<sp/>width<sp/>but<sp/>not<sp/>height.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&apos;percentage<sp/>not<sp/>allowed<sp/>for<sp/>height&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>size.rstrip(</highlight><highlight class="stringliteral">&apos;<sp/>%&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>float(size)<sp/>/<sp/>100.0</highlight></codeline>
<codeline lineno="2198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unit<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size,<sp/>unit<sp/>=<sp/>self.convert_to_cm(size)</highlight></codeline>
<codeline lineno="2201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ValueError<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>exp:</highlight></codeline>
<codeline lineno="2202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Invalid<sp/>%s<sp/>for<sp/>image:<sp/>&quot;%s&quot;.<sp/><sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Error:<sp/>&quot;%s&quot;.&apos;</highlight><highlight class="normal"><sp/>%<sp/>(</highlight></codeline>
<codeline lineno="2205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attr,<sp/>node.attributes[attr],<sp/>exp))</highlight></codeline>
<codeline lineno="2206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>size,<sp/>unit</highlight></codeline>
<codeline lineno="2207"><highlight class="normal"></highlight></codeline>
<codeline lineno="2208"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab7803e2a80e313f3d797c0a01de738e9" kindref="member">convert_to_cm</ref>(self,<sp/>size):</highlight></codeline>
<codeline lineno="2209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Convert<sp/>various<sp/>units<sp/>to<sp/>centimeters.</highlight></codeline>
<codeline lineno="2210"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="2211"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Note<sp/>that<sp/>a<sp/>call<sp/>to<sp/>this<sp/>method<sp/>should<sp/>be<sp/>wrapped<sp/>in:</highlight></codeline>
<codeline lineno="2212"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>try:<sp/>except<sp/>ValueError:</highlight></codeline>
<codeline lineno="2213"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>size.strip()</highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>size.endswith(</highlight><highlight class="stringliteral">&apos;px&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>float(size[:-2])<sp/>*<sp/>0.026<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>px<sp/>to<sp/>cm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>size.endswith(</highlight><highlight class="stringliteral">&apos;in&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>float(size[:-2])<sp/>*<sp/>2.54<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>in<sp/>to<sp/>cm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>size.endswith(</highlight><highlight class="stringliteral">&apos;pt&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>float(size[:-2])<sp/>*<sp/>0.035<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>pt<sp/>to<sp/>cm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>size.endswith(</highlight><highlight class="stringliteral">&apos;pc&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>float(size[:-2])<sp/>*<sp/>2.371<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>pc<sp/>to<sp/>cm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>size.endswith(</highlight><highlight class="stringliteral">&apos;mm&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>float(size[:-2])<sp/>*<sp/>0.1<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>mm<sp/>to<sp/>cm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>size.endswith(</highlight><highlight class="stringliteral">&apos;cm&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>float(size[:-2])</highlight></codeline>
<codeline lineno="2227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>ValueError(</highlight><highlight class="stringliteral">&apos;unknown<sp/>unit<sp/>type&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unit<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;cm&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>size,<sp/>unit</highlight></codeline>
<codeline lineno="2231"><highlight class="normal"></highlight></codeline>
<codeline lineno="2232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a0f3dc9eb4160f48e20c263c8c685a378" kindref="member">get_image_scale</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;scale&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes:</highlight></codeline>
<codeline lineno="2234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scale<sp/>=<sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;scale&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scale<sp/>=<sp/>int(scale)</highlight></codeline>
<codeline lineno="2237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ValueError:</highlight></codeline>
<codeline lineno="2238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Invalid<sp/>scale<sp/>for<sp/>image:<sp/>&quot;%s&quot;&apos;</highlight><highlight class="normal"><sp/>%<sp/>(</highlight></codeline>
<codeline lineno="2240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;scale&apos;</highlight><highlight class="normal">],<sp/>))</highlight></codeline>
<codeline lineno="2241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>scale<sp/>&lt;<sp/>1:<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>or<sp/>scale<sp/>&gt;<sp/>100:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;scale<sp/>out<sp/>of<sp/>range<sp/>(%s),<sp/>using<sp/>1.&apos;</highlight><highlight class="normal"><sp/>%<sp/>(scale,<sp/>))</highlight></codeline>
<codeline lineno="2244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scale<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="2245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scale<sp/>=<sp/>scale<sp/>*<sp/>0.01</highlight></codeline>
<codeline lineno="2246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scale<sp/>=<sp/>1.0</highlight></codeline>
<codeline lineno="2248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>scale</highlight></codeline>
<codeline lineno="2249"><highlight class="normal"></highlight></codeline>
<codeline lineno="2250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a66cc93b92e0981907f9c467139e44af9" kindref="member">get_image_scaled_width_height</ref>(self,<sp/>node,<sp/>source):</highlight></codeline>
<codeline lineno="2251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>image<sp/>size<sp/>in<sp/>centimeters<sp/>adjusted<sp/>by<sp/>image<sp/>attrs.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scale<sp/>=<sp/>self.get_image_scale(node)</highlight></codeline>
<codeline lineno="2253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width,<sp/>width_unit<sp/>=<sp/>self.get_image_width_height(node,<sp/></highlight><highlight class="stringliteral">&apos;width&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>height,<sp/>_<sp/>=<sp/>self.get_image_width_height(node,<sp/></highlight><highlight class="stringliteral">&apos;height&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dpi<sp/>=<sp/>(72,<sp/>72)</highlight></codeline>
<codeline lineno="2256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>PIL<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>source<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.image_dict:</highlight></codeline>
<codeline lineno="2257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>filename,<sp/>destination<sp/>=<sp/>self.image_dict[source]</highlight></codeline>
<codeline lineno="2258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>PIL.Image.open(filename,<sp/></highlight><highlight class="stringliteral">&apos;r&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>img:</highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>img_size<sp/>=<sp/>img.size</highlight></codeline>
<codeline lineno="2260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dpi<sp/>=<sp/>img.info.get(</highlight><highlight class="stringliteral">&apos;dpi&apos;</highlight><highlight class="normal">,<sp/>dpi)</highlight></codeline>
<codeline lineno="2261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>dpi<sp/>information<sp/>can<sp/>be<sp/>(xdpi,<sp/>ydpi)<sp/>or<sp/>xydpi</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iter(dpi)</highlight></codeline>
<codeline lineno="2264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>TypeError:</highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dpi<sp/>=<sp/>(dpi,<sp/>dpi)</highlight></codeline>
<codeline lineno="2266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>img_size<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>width<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>height<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>img_size<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>RuntimeError(</highlight></codeline>
<codeline lineno="2271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;image<sp/>size<sp/>not<sp/>fully<sp/>specified<sp/>and<sp/>PIL<sp/>not<sp/>installed&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>width<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width<sp/>=<sp/>img_size[0]</highlight></codeline>
<codeline lineno="2274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width<sp/>=<sp/>float(width)<sp/>*<sp/>0.026<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>px<sp/>to<sp/>cm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>height<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>height<sp/>=<sp/>img_size[1]</highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>height<sp/>=<sp/>float(height)<sp/>*<sp/>0.026<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>px<sp/>to<sp/>cm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>width_unit<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;%&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>factor<sp/>=<sp/>width</highlight></codeline>
<codeline lineno="2280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>image_width<sp/>=<sp/>img_size[0]</highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>image_width<sp/>=<sp/>float(image_width)<sp/>*<sp/>0.026<sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>px<sp/>to<sp/>cm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>image_height<sp/>=<sp/>img_size[1]</highlight></codeline>
<codeline lineno="2283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>image_height<sp/>=<sp/>float(image_height)<sp/>*<sp/>0.026<sp/><sp/></highlight><highlight class="comment">#<sp/>convert<sp/>px<sp/>to<sp/>cm</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line_width<sp/>=<sp/>self.get_page_width()</highlight></codeline>
<codeline lineno="2285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width<sp/>=<sp/>factor<sp/>*<sp/>line_width</highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>factor<sp/>=<sp/>(factor<sp/>*<sp/>line_width)<sp/>/<sp/>image_width</highlight></codeline>
<codeline lineno="2287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>height<sp/>=<sp/>factor<sp/>*<sp/>image_height</highlight></codeline>
<codeline lineno="2288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width<sp/>*=<sp/>scale</highlight></codeline>
<codeline lineno="2289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>height<sp/>*=<sp/>scale</highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%.2fcm&apos;</highlight><highlight class="normal"><sp/>%<sp/>width</highlight></codeline>
<codeline lineno="2291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>height<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%.2fcm&apos;</highlight><highlight class="normal"><sp/>%<sp/>height</highlight></codeline>
<codeline lineno="2292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>width,<sp/>height</highlight></codeline>
<codeline lineno="2293"><highlight class="normal"></highlight></codeline>
<codeline lineno="2294"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a68792f56cd6d913814b495ec3c65a8a4" kindref="member">get_page_width</ref>(self):</highlight></codeline>
<codeline lineno="2295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>the<sp/>document&apos;s<sp/>page<sp/>width<sp/>in<sp/>centimeters.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>root<sp/>=<sp/>self.get_dom_stylesheet()</highlight></codeline>
<codeline lineno="2297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nodes<sp/>=<sp/>root.iterfind(</highlight></codeline>
<codeline lineno="2298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;.//{urn:oasis:names:tc:opendocument:xmlns:style:1.0}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;page-layout/&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:style:1.0}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;page-layout-properties&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>node<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>nodes:</highlight></codeline>
<codeline lineno="2304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>page_width<sp/>=<sp/>node.get(</highlight></codeline>
<codeline lineno="2305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;page-width&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>margin_left<sp/>=<sp/>node.get(</highlight></codeline>
<codeline lineno="2308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;margin-left&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>margin_right<sp/>=<sp/>node.get(</highlight></codeline>
<codeline lineno="2311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;margin-right&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(page_width<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>margin_left<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>margin_right<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>page_width,<sp/>_<sp/>=<sp/>self.convert_to_cm(page_width)</highlight></codeline>
<codeline lineno="2319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>margin_left,<sp/>_<sp/>=<sp/>self.convert_to_cm(margin_left)</highlight></codeline>
<codeline lineno="2320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>margin_right,<sp/>_<sp/>=<sp/>self.convert_to_cm(margin_right)</highlight></codeline>
<codeline lineno="2321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>ValueError:</highlight></codeline>
<codeline lineno="2322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Stylesheet<sp/>file<sp/>contains<sp/>invalid<sp/>page<sp/>width<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;or<sp/>margin<sp/>size.&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width<sp/>=<sp/>page_width<sp/>-<sp/>margin_left<sp/>-<sp/>margin_right</highlight></codeline>
<codeline lineno="2326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>width<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>can&apos;t<sp/>find<sp/>the<sp/>width<sp/>in<sp/>styles,<sp/>so<sp/>we<sp/>make<sp/>a<sp/>guess.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Use<sp/>a<sp/>width<sp/>of<sp/>6<sp/>in<sp/>=<sp/>15.24<sp/>cm.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width<sp/>=<sp/>15.24</highlight></codeline>
<codeline lineno="2330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>width</highlight></codeline>
<codeline lineno="2331"><highlight class="normal"></highlight></codeline>
<codeline lineno="2332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa3d345805d046f6f14792591082bc4cc" kindref="member">generate_figure</ref>(self,<sp/>node,<sp/>source,<sp/>destination,<sp/>current_element):</highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caption<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width,<sp/>height<sp/>=<sp/>self.get_image_scaled_width_height(node,<sp/>source)</highlight></codeline>
<codeline lineno="2335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>node1<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.parent.children:</highlight></codeline>
<codeline lineno="2336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>node1.tagname<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;caption&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>caption<sp/>=<sp/>node1.astext()</highlight></codeline>
<codeline lineno="2338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.image_style_count<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>the<sp/>style<sp/>for<sp/>the<sp/>caption.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>caption<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:class&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;extra&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;paragraph&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Caption&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:parent-style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Standard&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=attrib,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:margin-bottom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.0835in&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:margin-top&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.0835in&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:line-number&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:number-lines&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;false&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;style:paragraph-properties&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=attrib,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:font-size&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;12pt&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:font-style&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;italic&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:font-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Times&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:font-name-complex&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Lucidasans1&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:font-size-asian&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;12pt&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:font-size-complex&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;12pt&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:font-style-asian&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;italic&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:font-style-complex&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;italic&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;style:text-properties&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=attrib,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;rstframestyle%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.image_style_count</highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>draw_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;graphics%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>next(IMAGE_NAME_COUNTER)</highlight></codeline>
<codeline lineno="2372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>the<sp/>styles</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>style_name,</highlight></codeline>
<codeline lineno="2375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;graphic&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:parent-style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;figureframe&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="2377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,</highlight></codeline>
<codeline lineno="2379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib=attrib,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wrap<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classes<sp/>=<sp/>node.parent.attributes.get(</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>classes<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;wrap&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>classes:</highlight></codeline>
<codeline lineno="2384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wrap<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>wrap:</highlight></codeline>
<codeline lineno="2386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;style:wrap&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;dynamic&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;style:wrap&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;style:graphic-properties&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=attrib,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:style-name&apos;</highlight><highlight class="normal">:<sp/>style_name,</highlight></codeline>
<codeline lineno="2393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:name&apos;</highlight><highlight class="normal">:<sp/>draw_name,</highlight></codeline>
<codeline lineno="2394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:anchor-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;paragraph&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:z-index&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;svg:width&apos;</highlight><highlight class="normal">]<sp/>=<sp/>width</highlight></codeline>
<codeline lineno="2398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(current_element,<sp/></highlight><highlight class="stringliteral">&apos;draw:frame&apos;</highlight><highlight class="normal">,<sp/>attrib=attrib)</highlight></codeline>
<codeline lineno="2399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="2400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el4<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el3,<sp/></highlight><highlight class="stringliteral">&apos;draw:text-box&apos;</highlight><highlight class="normal">,<sp/>attrib=attrib)</highlight></codeline>
<codeline lineno="2401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;caption&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="2403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el5<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el4,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib=attrib)</highlight></codeline>
<codeline lineno="2405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>el3,<sp/>el4,<sp/>el5,<sp/>caption</highlight></codeline>
<codeline lineno="2406"><highlight class="normal"></highlight></codeline>
<codeline lineno="2407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af4e6a9bdb04cd09a39639e99ebd12b37" kindref="member">generate_image</ref>(self,<sp/>node,<sp/>source,<sp/>destination,<sp/>current_element,</highlight></codeline>
<codeline lineno="2408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>frame_attrs=None):</highlight></codeline>
<codeline lineno="2409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>width,<sp/>height<sp/>=<sp/>self.get_image_scaled_width_height(node,<sp/>source)</highlight></codeline>
<codeline lineno="2410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.image_style_count<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;rstframestyle%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.image_style_count</highlight></codeline>
<codeline lineno="2412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>the<sp/>style.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>style_name,</highlight></codeline>
<codeline lineno="2415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;graphic&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:parent-style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;image&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="2417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,</highlight></codeline>
<codeline lineno="2419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib=attrib,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>halign<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>valign<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;align&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes:</highlight></codeline>
<codeline lineno="2423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>align<sp/>=<sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;align&apos;</highlight><highlight class="normal">].split()</highlight></codeline>
<codeline lineno="2424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>val<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>align:</highlight></codeline>
<codeline lineno="2425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>val<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>(</highlight><highlight class="stringliteral">&apos;left&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;center&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;right&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>halign<sp/>=<sp/>val</highlight></codeline>
<codeline lineno="2427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>val<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>(</highlight><highlight class="stringliteral">&apos;top&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;middle&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;bottom&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>valign<sp/>=<sp/>val</highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>frame_attrs<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:vertical-pos&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;top&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:vertical-rel&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;paragraph&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:horizontal-rel&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;paragraph&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:mirror&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:clip&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rect(0cm<sp/>0cm<sp/>0cm<sp/>0cm)&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:luminance&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0%&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:contrast&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0%&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:red&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0%&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:green&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0%&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:blue&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0%&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:gamma&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;100%&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:color-inversion&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;false&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:image-opacity&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;100%&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:color-mode&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;standard&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>frame_attrs</highlight></codeline>
<codeline lineno="2448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>halign<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;style:horizontal-pos&apos;</highlight><highlight class="normal">]<sp/>=<sp/>halign</highlight></codeline>
<codeline lineno="2450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>valign<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;style:vertical-pos&apos;</highlight><highlight class="normal">]<sp/>=<sp/>valign</highlight></codeline>
<codeline lineno="2452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>there<sp/>is<sp/>a<sp/>classes/wrap<sp/>directive<sp/>or<sp/>we<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>inside<sp/>a<sp/>table,<sp/>add<sp/>a<sp/>no-wrap<sp/>style.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wrap<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classes<sp/>=<sp/>node.attributes.get(</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>classes<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;wrap&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>classes:</highlight></codeline>
<codeline lineno="2457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wrap<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>wrap:</highlight></codeline>
<codeline lineno="2459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;style:wrap&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;dynamic&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;style:wrap&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>we<sp/>are<sp/>inside<sp/>a<sp/>table,<sp/>add<sp/>a<sp/>no-wrap<sp/>style.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.is_in_table(node):</highlight></codeline>
<codeline lineno="2464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;style:wrap&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;style:graphic-properties&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib=attrib,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>draw_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;graphics%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>next(IMAGE_NAME_COUNTER)</highlight></codeline>
<codeline lineno="2468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Add<sp/>the<sp/>content.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>el<sp/>=<sp/>SubElement(current_element,<sp/>&apos;text:p&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>attrib={&apos;text:style-name&apos;:<sp/>self.rststyle(&apos;textbody&apos;)})</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="2472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:style-name&apos;</highlight><highlight class="normal">:<sp/>style_name,</highlight></codeline>
<codeline lineno="2473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:name&apos;</highlight><highlight class="normal">:<sp/>draw_name,</highlight></codeline>
<codeline lineno="2474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;draw:z-index&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;1&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/>nodes.TextElement):</highlight></codeline>
<codeline lineno="2477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;text:anchor-type&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;as-char&apos;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>vds</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;text:anchor-type&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;paragraph&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;svg:width&apos;</highlight><highlight class="normal">]<sp/>=<sp/>width</highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;svg:height&apos;</highlight><highlight class="normal">]<sp/>=<sp/>height</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(current_element,<sp/></highlight><highlight class="stringliteral">&apos;draw:frame&apos;</highlight><highlight class="normal">,<sp/>attrib=attrib)</highlight></codeline>
<codeline lineno="2483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;draw:image&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xlink:href&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>(destination,<sp/>),</highlight></codeline>
<codeline lineno="2485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xlink:type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;simple&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xlink:show&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;embed&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xlink:actuate&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;onLoad&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>el1,<sp/>width</highlight></codeline>
<codeline lineno="2490"><highlight class="normal"></highlight></codeline>
<codeline lineno="2491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad44d703ee56878536dbe2668209291c1" kindref="member">is_in_table</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node1<sp/>=<sp/>node.parent</highlight></codeline>
<codeline lineno="2493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>node1:</highlight></codeline>
<codeline lineno="2494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node1,<sp/><ref refid="classdocutils_1_1nodes_1_1entry" kindref="compound">docutils.nodes.entry</ref>):</highlight></codeline>
<codeline lineno="2495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node1<sp/>=<sp/>node1.parent</highlight></codeline>
<codeline lineno="2497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2498"><highlight class="normal"></highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a271738bae1ddc883537c2d792b5346db" kindref="member">visit_legend</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1figure" kindref="compound">docutils.nodes.figure</ref>):</highlight></codeline>
<codeline lineno="2501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.current_element[-1]</highlight></codeline>
<codeline lineno="2502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>el1[0][0]</highlight></codeline>
<codeline lineno="2503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element<sp/>=<sp/>el1</highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(self.rststyle(</highlight><highlight class="stringliteral">&apos;legend&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="2505"><highlight class="normal"></highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac39860bd3f9e0f39c71d94a18834747d" kindref="member">depart_legend</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1figure" kindref="compound">docutils.nodes.figure</ref>):</highlight></codeline>
<codeline lineno="2508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2512"><highlight class="normal"></highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a9914cb2582682796be2644169dbb45bf" kindref="member">visit_line_block</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.line_indent_level<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.line_block_level<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2516"><highlight class="normal"></highlight></codeline>
<codeline lineno="2517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a309ac30664a4e260e0f28afc27810e99" kindref="member">depart_line_block</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.line_indent_level<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="2519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.line_block_level<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="2520"><highlight class="normal"></highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a6abc3924d1397693dfff218837a97f8e" kindref="member">visit_line</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;lineblock%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.line_indent_level</highlight></codeline>
<codeline lineno="2523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(style),<sp/>})</highlight></codeline>
<codeline lineno="2525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element<sp/>=<sp/>el1</highlight></codeline>
<codeline lineno="2526"><highlight class="normal"></highlight></codeline>
<codeline lineno="2527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8d392d29d092e8c1f744299d68c61718" kindref="member">depart_line</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2529"><highlight class="normal"></highlight></codeline>
<codeline lineno="2530"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a0926ad371d217f70fa85646225c65bac" kindref="member">visit_literal</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="2532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;inlineliteral&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="2534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2535"><highlight class="normal"></highlight></codeline>
<codeline lineno="2536"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1e3778a1c63c16123d13c47ba3b7293f" kindref="member">depart_literal</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2538"><highlight class="normal"></highlight></codeline>
<codeline lineno="2539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac69ccabb09add0510e41570f2ee33dd9" kindref="member">visit_inline</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>styles<sp/>=<sp/>node.attributes.get(</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">,<sp/>())</highlight></codeline>
<codeline lineno="2541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>styles:</highlight></codeline>
<codeline lineno="2542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.current_element</highlight></codeline>
<codeline lineno="2543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>inline_style<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>styles:</highlight></codeline>
<codeline lineno="2544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(inline_style)})</highlight></codeline>
<codeline lineno="2547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>len(styles)</highlight></codeline>
<codeline lineno="2548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>No<sp/>style<sp/>was<sp/>specified<sp/>so<sp/>use<sp/>a<sp/>default<sp/>style<sp/>(old<sp/>code</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>crashed<sp/>if<sp/>no<sp/>style<sp/>was<sp/>given)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="2553"><highlight class="normal"></highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.inline_style_count_stack.append(count)</highlight></codeline>
<codeline lineno="2556"><highlight class="normal"></highlight></codeline>
<codeline lineno="2557"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa3fd197b9e64f8e546ea5c1ae4e67c17" kindref="member">depart_inline</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>self.inline_style_count_stack.pop()</highlight></codeline>
<codeline lineno="2559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(count):</highlight></codeline>
<codeline lineno="2560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2561"><highlight class="normal"></highlight></codeline>
<codeline lineno="2562"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a398f490c1aea8b2e175f2e9a055a78c0" kindref="member">_calculate_code_block_padding</ref>(self,<sp/>line):</highlight></codeline>
<codeline lineno="2563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="2564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>matchobj<sp/>=<sp/>SPACES_PATTERN.match(line)</highlight></codeline>
<codeline lineno="2565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>matchobj:</highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pad<sp/>=<sp/>matchobj.group()</highlight></codeline>
<codeline lineno="2567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>len(pad)</highlight></codeline>
<codeline lineno="2568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>matchobj<sp/>=<sp/>TABS_PATTERN.match(line)</highlight></codeline>
<codeline lineno="2570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>matchobj:</highlight></codeline>
<codeline lineno="2571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pad<sp/>=<sp/>matchobj.group()</highlight></codeline>
<codeline lineno="2572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>len(pad)<sp/>*<sp/>8</highlight></codeline>
<codeline lineno="2573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>count</highlight></codeline>
<codeline lineno="2574"><highlight class="normal"></highlight></codeline>
<codeline lineno="2575"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7a942f3e9100fcf42aa7379cb924c2fb" kindref="member">_add_syntax_highlighting</ref>(self,<sp/>insource,<sp/>language):</highlight></codeline>
<codeline lineno="2576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lexer<sp/>=<sp/><ref refid="namespacepygments_1_1lexers_1a9bf5bc86a4c1741093cd3279ff4a333e" kindref="member">pygments.lexers.get_lexer_by_name</ref>(language,<sp/>stripall=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>language<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>(</highlight><highlight class="stringliteral">&apos;latex&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;tex&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fmtr<sp/>=<sp/>OdtPygmentsLaTeXFormatter(</highlight></codeline>
<codeline lineno="2579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>name,<sp/>parameters=():</highlight></codeline>
<codeline lineno="2580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(name,<sp/>parameters),</highlight></codeline>
<codeline lineno="2581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>escape_function=escape_cdata)</highlight></codeline>
<codeline lineno="2582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fmtr<sp/>=<sp/>OdtPygmentsProgFormatter(</highlight></codeline>
<codeline lineno="2584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>name,<sp/>parameters=():</highlight></codeline>
<codeline lineno="2585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(name,<sp/>parameters),</highlight></codeline>
<codeline lineno="2586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>escape_function=escape_cdata)</highlight></codeline>
<codeline lineno="2587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacepygments_1a9b56057c6a9cfcfc3c8bf0d75a3df3d2" kindref="member">pygments.highlight</ref>(insource,<sp/>lexer,<sp/>fmtr)</highlight></codeline>
<codeline lineno="2588"><highlight class="normal"></highlight></codeline>
<codeline lineno="2589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7c4018a4ac8df3f26bf5b73cf1f849c6" kindref="member">fill_line</ref>(self,<sp/>line):</highlight></codeline>
<codeline lineno="2590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>FILL_PAT1.sub(self.fill_func1,<sp/>line)</highlight></codeline>
<codeline lineno="2591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>FILL_PAT2.sub(self.fill_func2,<sp/>line)</highlight></codeline>
<codeline lineno="2592"><highlight class="normal"></highlight></codeline>
<codeline lineno="2593"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ace9e20ff9bc159fabdb484a6b9905ca0" kindref="member">fill_func1</ref>(self,<sp/>matchobj):</highlight></codeline>
<codeline lineno="2594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spaces<sp/>=<sp/>matchobj.group(0)</highlight></codeline>
<codeline lineno="2595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&lt;text:s<sp/>text:c=&quot;%d&quot;/&gt;&apos;</highlight><highlight class="normal"><sp/>%<sp/>(len(spaces),<sp/>)</highlight></codeline>
<codeline lineno="2596"><highlight class="normal"></highlight></codeline>
<codeline lineno="2597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aece327d41c695266c8a58682902fad36" kindref="member">fill_func2</ref>(self,<sp/>matchobj):</highlight></codeline>
<codeline lineno="2598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spaces<sp/>=<sp/>matchobj.group(0)</highlight></codeline>
<codeline lineno="2599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;<sp/>&lt;text:s<sp/>text:c=&quot;%d&quot;/&gt;&apos;</highlight><highlight class="normal"><sp/>%<sp/>(len(spaces)<sp/>-<sp/>1,<sp/>)</highlight></codeline>
<codeline lineno="2600"><highlight class="normal"></highlight></codeline>
<codeline lineno="2601"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab6dad15c10d5e6da8314832a74dc01af" kindref="member">visit_literal_block</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.paragraph_style_stack)<sp/>&gt;<sp/>1:</highlight></codeline>
<codeline lineno="2603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wrapper1<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;text:p<sp/>text:style-name=&quot;%s&quot;&gt;%%s&lt;/text:p&gt;&apos;</highlight><highlight class="normal"><sp/>%<sp/>(</highlight></codeline>
<codeline lineno="2604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;codeblock-indented&apos;</highlight><highlight class="normal">),<sp/>)</highlight></codeline>
<codeline lineno="2605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>wrapper1<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;text:p<sp/>text:style-name=&quot;%s&quot;&gt;%%s&lt;/text:p&gt;&apos;</highlight><highlight class="normal"><sp/>%<sp/>(</highlight></codeline>
<codeline lineno="2607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;codeblock&apos;</highlight><highlight class="normal">),<sp/>)</highlight></codeline>
<codeline lineno="2608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>source<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="2609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pygments<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.settings.add_syntax_highlighting):</highlight></codeline>
<codeline lineno="2610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>language<sp/>=<sp/>node.get(</highlight><highlight class="stringliteral">&apos;language&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;python&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>source<sp/>=<sp/>self._add_syntax_highlighting(source,<sp/>language)</highlight></codeline>
<codeline lineno="2612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>source<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a78a238cb5555dc38b7751b781f2ddde5" kindref="member">escape_cdata</ref>(source)</highlight></codeline>
<codeline lineno="2614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lines<sp/>=<sp/>source.split(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>there<sp/>is<sp/>an<sp/>empty<sp/>last<sp/>line,<sp/>remove<sp/>it.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>lines[-1]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>lines[-1]</highlight></codeline>
<codeline lineno="2618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lines1<sp/>=<sp/>[</highlight><highlight class="stringliteral">&apos;&lt;wrappertag1<sp/>xmlns:text=&quot;urn:oasis:names:tc:&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;opendocument:xmlns:text:1.0&quot;&gt;&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>my_lines<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="2621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>my_line<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>lines:</highlight></codeline>
<codeline lineno="2622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>my_line<sp/>=<sp/>self.fill_line(my_line)</highlight></codeline>
<codeline lineno="2623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>my_line<sp/>=<sp/>my_line.replace(</highlight><highlight class="stringliteral">&quot;&amp;#10;&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>my_lines.append(my_line)</highlight></codeline>
<codeline lineno="2625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>my_lines_str<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;text:line-break/&gt;&apos;</highlight><highlight class="normal">.join(my_lines)</highlight></codeline>
<codeline lineno="2626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>my_lines_str2<sp/>=<sp/>wrapper1<sp/>%<sp/>(my_lines_str,<sp/>)</highlight></codeline>
<codeline lineno="2627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lines1.append(my_lines_str2)</highlight></codeline>
<codeline lineno="2628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lines1.append(</highlight><highlight class="stringliteral">&apos;&lt;/wrappertag1&gt;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">.join(lines1)</highlight></codeline>
<codeline lineno="2630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>s1.encode(</highlight><highlight class="stringliteral">&quot;utf-8&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>etree.fromstring(s1)</highlight></codeline>
<codeline lineno="2632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>child<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>el1:</highlight></codeline>
<codeline lineno="2633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element.append(child)</highlight></codeline>
<codeline lineno="2634"><highlight class="normal"></highlight></codeline>
<codeline lineno="2635"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a256fa71c524a38b718bc9014355a24fa" kindref="member">depart_literal_block</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2637"><highlight class="normal"></highlight></codeline>
<codeline lineno="2638"><highlight class="normal"><sp/><sp/><sp/><sp/>visit_doctest_block<sp/>=<sp/>visit_literal_block</highlight></codeline>
<codeline lineno="2639"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_doctest_block<sp/>=<sp/>depart_literal_block</highlight></codeline>
<codeline lineno="2640"><highlight class="normal"></highlight></codeline>
<codeline lineno="2641"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>placeholder<sp/>for<sp/>math<sp/>(see<sp/>docs/dev/todo.txt)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2642"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa145e9cfdf81919cfa2fca2bb4634d2e" kindref="member">visit_math</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight><highlight class="stringliteral">&apos;&quot;math&quot;<sp/>role<sp/>not<sp/>supported&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base_node=node)</highlight></codeline>
<codeline lineno="2645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.visit_literal(node)</highlight></codeline>
<codeline lineno="2646"><highlight class="normal"></highlight></codeline>
<codeline lineno="2647"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4224c41d78a82019ff9721fc374d343e" kindref="member">depart_math</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.depart_literal(node)</highlight></codeline>
<codeline lineno="2649"><highlight class="normal"></highlight></codeline>
<codeline lineno="2650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4d582b9de1a56c7cfd286e2911d2e992" kindref="member">visit_math_block</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight><highlight class="stringliteral">&apos;&quot;math&quot;<sp/>directive<sp/>not<sp/>supported&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base_node=node)</highlight></codeline>
<codeline lineno="2653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.visit_literal_block(node)</highlight></codeline>
<codeline lineno="2654"><highlight class="normal"></highlight></codeline>
<codeline lineno="2655"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aec4b95d336dfad3a04819c29a2c1b191" kindref="member">depart_math_block</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.depart_literal_block(node)</highlight></codeline>
<codeline lineno="2657"><highlight class="normal"></highlight></codeline>
<codeline lineno="2658"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a9154d726d3858677fa29111ab7e16a54" kindref="member">visit_meta</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/>node.attributes.get(</highlight><highlight class="stringliteral">&apos;name&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>content<sp/>=<sp/>node.attributes.get(</highlight><highlight class="stringliteral">&apos;content&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>name<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>content<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.meta_dict[name]<sp/>=<sp/>content</highlight></codeline>
<codeline lineno="2663"><highlight class="normal"></highlight></codeline>
<codeline lineno="2664"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4ea40247d11ae89ef090482730942e85" kindref="member">depart_meta</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2666"><highlight class="normal"></highlight></codeline>
<codeline lineno="2667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa06ac541ef6ffb6e0cd17bd610be7c68" kindref="member">visit_option_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;tableoption&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Generate<sp/>automatic<sp/>styles</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.optiontablestyles_generated:</highlight></codeline>
<codeline lineno="2672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.optiontablestyles_generated<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(table_name),</highlight></codeline>
<codeline lineno="2675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;style:table-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:width&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;17.59cm&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:align&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;left&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:shadow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;%s.%%c&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">,<sp/>)),</highlight></codeline>
<codeline lineno="2682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table-column&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;style:table-column-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:column-width&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;4.999cm&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;%s.%%c&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;B&apos;</highlight><highlight class="normal">,<sp/>)),</highlight></codeline>
<codeline lineno="2687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table-column&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;style:table-column-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:column-width&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;12.587cm&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="2692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s.%%c%%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">,<sp/>1,<sp/>)),</highlight></codeline>
<codeline lineno="2693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table-cell&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;style:table-cell-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:background-color&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;transparent&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:padding&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.097cm&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-left&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.035cm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-right&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-top&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.035cm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-bottom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.035cm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;style:background-image&apos;</highlight><highlight class="normal">,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="2704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s.%%c%%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;B&apos;</highlight><highlight class="normal">,<sp/>1,<sp/>)),</highlight></codeline>
<codeline lineno="2705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table-cell&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;style:table-cell-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:padding&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.097cm&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.035cm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="2711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s.%%c%%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">,<sp/>2,<sp/>)),</highlight></codeline>
<codeline lineno="2712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table-cell&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;style:table-cell-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:padding&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.097cm&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-left&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.035cm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-right&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-top&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-bottom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.035cm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="2721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s.%%c%%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;B&apos;</highlight><highlight class="normal">,<sp/>2,<sp/>)),</highlight></codeline>
<codeline lineno="2722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table-cell&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;style:table-cell-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:padding&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.097cm&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-left&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.035cm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-right&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.035cm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-top&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;none&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-bottom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.035cm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal">},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="2729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Generate<sp/>table<sp/>data</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;table:table&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(table_name),</highlight></codeline>
<codeline lineno="2733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(table_name),</highlight></codeline>
<codeline lineno="2734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;table:table-column&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="2737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s.%%c&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">,<sp/>))})</highlight></codeline>
<codeline lineno="2738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;table:table-column&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="2740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s.%%c&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;B&apos;</highlight><highlight class="normal">,<sp/>))})</highlight></codeline>
<codeline lineno="2741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;table:table-header-rows&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;table:table-row&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;table:table-cell&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="2745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s.%%c%%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">,<sp/>1,<sp/>)),</highlight></codeline>
<codeline lineno="2746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office:value-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;string&apos;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="2747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el4<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el3,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Table_20_Heading&apos;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="2749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el4.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Option&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;table:table-cell&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="2752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s.%%c%%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(</highlight><highlight class="stringliteral">&apos;B&apos;</highlight><highlight class="normal">,<sp/>1,<sp/>)),</highlight></codeline>
<codeline lineno="2753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office:value-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;string&apos;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="2754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el4<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el3,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Table_20_Heading&apos;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="2756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el4.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Description&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2758"><highlight class="normal"></highlight></codeline>
<codeline lineno="2759"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a110e1785c942cce970aadcea46e41c24" kindref="member">depart_option_list</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2761"><highlight class="normal"></highlight></codeline>
<codeline lineno="2762"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad1f8c75309428ed864243700b9f1282a" kindref="member">visit_option_list_item</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;table:table-row&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2765"><highlight class="normal"></highlight></codeline>
<codeline lineno="2766"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a659857f1a902e603625321aec54c05ee" kindref="member">depart_option_list_item</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2768"><highlight class="normal"></highlight></codeline>
<codeline lineno="2769"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ab621b43dd0c78a86cac744f2e7bd5aa7" kindref="member">visit_option_group</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;table:table-cell&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Table%d.A2&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.table_count,</highlight></codeline>
<codeline lineno="2772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office:value-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;string&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2775"><highlight class="normal"></highlight></codeline>
<codeline lineno="2776"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ade87e7c56a0a2c776be3a29f9489439b" kindref="member">depart_option_group</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2778"><highlight class="normal"></highlight></codeline>
<codeline lineno="2779"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a76fb03986125bb2304f8bd4540074ac4" kindref="member">visit_option</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Table_20_Contents&apos;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="2782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.text<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="2783"><highlight class="normal"></highlight></codeline>
<codeline lineno="2784"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a89088980c27513c85ff0e5577d80ceae" kindref="member">depart_option</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2786"><highlight class="normal"></highlight></codeline>
<codeline lineno="2787"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7666039feb04110b7adbad1ebd8a0394" kindref="member">visit_option_string</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2789"><highlight class="normal"></highlight></codeline>
<codeline lineno="2790"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7a52ae8eb4420219094c64b4e1932b7a" kindref="member">depart_option_string</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2792"><highlight class="normal"></highlight></codeline>
<codeline lineno="2793"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5ccef3e6702f7aab0949ae9affae4098" kindref="member">visit_option_argument</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2795"><highlight class="normal"></highlight></codeline>
<codeline lineno="2796"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a57866f0c914ea0b68ad5cfdd0b4ae937" kindref="member">depart_option_argument</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2798"><highlight class="normal"></highlight></codeline>
<codeline lineno="2799"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a503f073ad76eaef23fc8d9677cb77bb9" kindref="member">visit_description</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;table:table-cell&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Table%d.B2&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.table_count,</highlight></codeline>
<codeline lineno="2802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office:value-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;string&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Table_20_Contents&apos;</highlight><highlight class="normal">})</highlight></codeline>
<codeline lineno="2806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="2807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>nodes.SkipChildren()</highlight></codeline>
<codeline lineno="2808"><highlight class="normal"></highlight></codeline>
<codeline lineno="2809"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa104b6729657b210234f4479c155eeca" kindref="member">depart_description</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2811"><highlight class="normal"></highlight></codeline>
<codeline lineno="2812"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8ac0fbc4a87128693d8ad3648e997470" kindref="member">visit_paragraph</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_paragraph<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.in_header:</highlight></codeline>
<codeline lineno="2815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;header&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.in_footer:</highlight></codeline>
<codeline lineno="2817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;footer&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style_name<sp/>=<sp/>self.paragraph_style_stack[-1]</highlight></codeline>
<codeline lineno="2820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight></codeline>
<codeline lineno="2821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>style_name})</highlight></codeline>
<codeline lineno="2823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_pending_ids(el)</highlight></codeline>
<codeline lineno="2824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2825"><highlight class="normal"></highlight></codeline>
<codeline lineno="2826"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1d275944af606b30b98ef71dab6ed458" kindref="member">depart_paragraph</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_paragraph<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.in_header:</highlight></codeline>
<codeline lineno="2830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.header_content.append(self.current_element[-1])</highlight></codeline>
<codeline lineno="2831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element.remove(self.current_element[-1])</highlight></codeline>
<codeline lineno="2832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.in_footer:</highlight></codeline>
<codeline lineno="2833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.footer_content.append(self.current_element[-1])</highlight></codeline>
<codeline lineno="2834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element.remove(self.current_element[-1])</highlight></codeline>
<codeline lineno="2835"><highlight class="normal"></highlight></codeline>
<codeline lineno="2836"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2dc474c9b69a3959b6c98158c8644afd" kindref="member">visit_problematic</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2838"><highlight class="normal"></highlight></codeline>
<codeline lineno="2839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a71fb741077df305698eb57bd8d32cb06" kindref="member">depart_problematic</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2841"><highlight class="normal"></highlight></codeline>
<codeline lineno="2842"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1821fe79382a3e24af95ade81ef3c6aa" kindref="member">visit_raw</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;format&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes:</highlight></codeline>
<codeline lineno="2844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>formats<sp/>=<sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;format&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>formatlist<sp/>=<sp/>formats.split()</highlight></codeline>
<codeline lineno="2846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;odt&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>formatlist:</highlight></codeline>
<codeline lineno="2847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rawstr<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="2848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrstr<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">.join(</highlight></codeline>
<codeline lineno="2849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s=&quot;%s&quot;&apos;</highlight><highlight class="normal"><sp/>%<sp/>(k,<sp/>v,<sp/>)</highlight></codeline>
<codeline lineno="2850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,<sp/>v<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list(CONTENT_NAMESPACE_ATTRIB.items()))</highlight></codeline>
<codeline lineno="2851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contentstr<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;stuff<sp/>%s&gt;%s&lt;/stuff&gt;&apos;</highlight><highlight class="normal"><sp/>%<sp/>(attrstr,<sp/>rawstr,<sp/>)</highlight></codeline>
<codeline lineno="2852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contentstr<sp/>=<sp/>contentstr.encode(</highlight><highlight class="stringliteral">&quot;utf-8&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>content<sp/>=<sp/>etree.fromstring(contentstr)</highlight></codeline>
<codeline lineno="2854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(content)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="2855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>content[0]</highlight></codeline>
<codeline lineno="2856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.in_header:</highlight></codeline>
<codeline lineno="2857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.in_footer:</highlight></codeline>
<codeline lineno="2859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_element.append(el1)</highlight></codeline>
<codeline lineno="2862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>nodes.SkipChildren()</highlight></codeline>
<codeline lineno="2863"><highlight class="normal"></highlight></codeline>
<codeline lineno="2864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a739f50b6566b7fe597326b74bf974760" kindref="member">depart_raw</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.in_header:</highlight></codeline>
<codeline lineno="2866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.in_footer:</highlight></codeline>
<codeline lineno="2868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2871"><highlight class="normal"></highlight></codeline>
<codeline lineno="2872"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1acc750b3b76a05b1da273e4258841f63d" kindref="member">visit_reference</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>text<sp/>=<sp/>node.astext()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_links:</highlight></codeline>
<codeline lineno="2875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;refuri&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node:</highlight></codeline>
<codeline lineno="2876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>href<sp/>=<sp/>node[</highlight><highlight class="stringliteral">&apos;refuri&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(self.settings.cloak_email_addresses</highlight></codeline>
<codeline lineno="2878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>href.startswith(</highlight><highlight class="stringliteral">&apos;mailto:&apos;</highlight><highlight class="normal">)):</highlight></codeline>
<codeline lineno="2879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>href<sp/>=<sp/>self.cloak_mailto(href)</highlight></codeline>
<codeline lineno="2880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:a&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xlink:href&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>href,</highlight></codeline>
<codeline lineno="2882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;xlink:type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;simple&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;refid&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node:</highlight></codeline>
<codeline lineno="2886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_links:</highlight></codeline>
<codeline lineno="2887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>href<sp/>=<sp/>node[</highlight><highlight class="stringliteral">&apos;refid&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:reference-ref&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:ref-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>href,</highlight></codeline>
<codeline lineno="2890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:reference-format&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;text&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;References<sp/>must<sp/>have<sp/>&quot;refuri&quot;<sp/>or<sp/>&quot;refid&quot;<sp/>attribute.&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(self.in_table_of_contents</highlight></codeline>
<codeline lineno="2896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>len(node.children)<sp/>&gt;=<sp/>1</highlight></codeline>
<codeline lineno="2897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>isinstance(node.children[0],<sp/><ref refid="classdocutils_1_1nodes_1_1generated" kindref="compound">docutils.nodes.generated</ref>)):</highlight></codeline>
<codeline lineno="2898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node.remove(node.children[0])</highlight></codeline>
<codeline lineno="2899"><highlight class="normal"></highlight></codeline>
<codeline lineno="2900"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a118075f2549afc6c7784fa6e84458113" kindref="member">depart_reference</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_links:</highlight></codeline>
<codeline lineno="2902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;refuri&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node:</highlight></codeline>
<codeline lineno="2903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2904"><highlight class="normal"></highlight></codeline>
<codeline lineno="2905"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a112488ffae64ab2228621751c35bb0c8" kindref="member">visit_rubric</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style_name<sp/>=<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;rubric&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classes<sp/>=<sp/>node.get(</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>classes:</highlight></codeline>
<codeline lineno="2909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>class1<sp/>=<sp/>classes[0]</highlight></codeline>
<codeline lineno="2910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>class1:</highlight></codeline>
<codeline lineno="2911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>style_name<sp/>=<sp/>class1</highlight></codeline>
<codeline lineno="2912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:h&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;text:outline-level&apos;:<sp/>&apos;%d&apos;<sp/>%<sp/>section_level,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;text:style-name&apos;:<sp/>&apos;Heading_20_%d&apos;<sp/>%<sp/>section_level,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>style_name,</highlight></codeline>
<codeline lineno="2916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>text<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="2918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.text<sp/>=<sp/>self.encode(text)</highlight></codeline>
<codeline lineno="2919"><highlight class="normal"></highlight></codeline>
<codeline lineno="2920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1e413f4ab8bd5956d9c34b40d92364f4" kindref="member">depart_rubric</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2922"><highlight class="normal"></highlight></codeline>
<codeline lineno="2923"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a95df724a4bd779208285053dd413d7d6" kindref="member">visit_section</ref>(self,<sp/>node,<sp/>move_ids=1):</highlight></codeline>
<codeline lineno="2924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.section_level<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.section_count<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_sections:</highlight></codeline>
<codeline lineno="2927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:section&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="2928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Section%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.section_count,</highlight></codeline>
<codeline lineno="2929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Sect%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.section_level,</highlight></codeline>
<codeline lineno="2930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="2931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2932"><highlight class="normal"></highlight></codeline>
<codeline lineno="2933"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a7d1d4dbeadf430cdefda2f8dda4544c9" kindref="member">depart_section</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.section_level<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="2935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.create_sections:</highlight></codeline>
<codeline lineno="2936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2937"><highlight class="normal"></highlight></codeline>
<codeline lineno="2938"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a0924c9356c6d1ad1bb292bde2c85b141" kindref="member">visit_strong</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;strong&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="2941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="2942"><highlight class="normal"></highlight></codeline>
<codeline lineno="2943"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2e0abb14bf6ebd5b9bf6aef38161abac" kindref="member">depart_strong</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="2945"><highlight class="normal"></highlight></codeline>
<codeline lineno="2946"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a78105df0c98f3f32d59bc3363f31ded8" kindref="member">visit_substitution_definition</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>nodes.SkipChildren()</highlight></codeline>
<codeline lineno="2948"><highlight class="normal"></highlight></codeline>
<codeline lineno="2949"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a70461446da8bd0881c8919103c3dbb88" kindref="member">depart_substitution_definition</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2951"><highlight class="normal"></highlight></codeline>
<codeline lineno="2952"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a631b4018c153020ee1d674ca5c5a5b00" kindref="member">visit_system_message</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2954"><highlight class="normal"></highlight></codeline>
<codeline lineno="2955"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae0474067d9f31660879bd89925c53838" kindref="member">depart_system_message</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2957"><highlight class="normal"></highlight></codeline>
<codeline lineno="2958"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ac2e63f8f4c7d217c612906003929b923" kindref="member">get_table_style</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_style<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_name<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str_classes<sp/>=<sp/>node.get(</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>str_classes<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>str_class<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>str_classes:</highlight></codeline>
<codeline lineno="2964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>str_class.startswith(TABLESTYLEPREFIX):</highlight></codeline>
<codeline lineno="2965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_name<sp/>=<sp/>str_class</highlight></codeline>
<codeline lineno="2966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>table_name<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_style<sp/>=<sp/>self.table_styles.get(table_name)</highlight></codeline>
<codeline lineno="2969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>table_style<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>we<sp/>can&apos;t<sp/>find<sp/>the<sp/>table<sp/>style,<sp/>issue<sp/>warning</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>and<sp/>use<sp/>the<sp/>default<sp/>table<sp/>style.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Can\&apos;t<sp/>find<sp/>table<sp/>style<sp/>&quot;%s&quot;.<sp/><sp/>Using<sp/>default.&apos;</highlight><highlight class="normal"><sp/>%<sp/>(</highlight></codeline>
<codeline lineno="2974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_name,<sp/>))</highlight></codeline>
<codeline lineno="2975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_name<sp/>=<sp/>TABLENAMEDEFAULT</highlight></codeline>
<codeline lineno="2976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_style<sp/>=<sp/>self.table_styles.get(table_name)</highlight></codeline>
<codeline lineno="2977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>table_style<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>we<sp/>can&apos;t<sp/>find<sp/>the<sp/>default<sp/>table<sp/>style,<sp/>issue<sp/>a<sp/>warning</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>and<sp/>use<sp/>a<sp/>built-in<sp/>default<sp/>style.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Can\&apos;t<sp/>find<sp/>default<sp/>table<sp/>style<sp/>&quot;%s&quot;.<sp/><sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Using<sp/>built-in<sp/>default.&apos;</highlight><highlight class="normal"><sp/>%<sp/>(</highlight></codeline>
<codeline lineno="2983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_name,<sp/>))</highlight></codeline>
<codeline lineno="2984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_style<sp/>=<sp/>BUILTIN_DEFAULT_TABLE_STYLE</highlight></codeline>
<codeline lineno="2985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_name<sp/>=<sp/>TABLENAMEDEFAULT</highlight></codeline>
<codeline lineno="2987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_style<sp/>=<sp/>self.table_styles.get(table_name)</highlight></codeline>
<codeline lineno="2988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>table_style<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>we<sp/>can&apos;t<sp/>find<sp/>the<sp/>default<sp/>table<sp/>style,<sp/>issue<sp/>a<sp/>warning</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/>and<sp/>use<sp/>a<sp/>built-in<sp/>default<sp/>style.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="2992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Can\&apos;t<sp/>find<sp/>default<sp/>table<sp/>style<sp/>&quot;%s&quot;.<sp/><sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Using<sp/>built-in<sp/>default.&apos;</highlight><highlight class="normal"><sp/>%<sp/>(</highlight></codeline>
<codeline lineno="2994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_name,<sp/>))</highlight></codeline>
<codeline lineno="2995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_style<sp/>=<sp/>BUILTIN_DEFAULT_TABLE_STYLE</highlight></codeline>
<codeline lineno="2996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>table_style</highlight></codeline>
<codeline lineno="2997"><highlight class="normal"></highlight></codeline>
<codeline lineno="2998"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a6b134f07ffe8ac763865a3e69a0b4c6c" kindref="member">visit_table</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="2999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.table_count<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="3000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_style<sp/>=<sp/>self.get_table_style(node)</highlight></codeline>
<codeline lineno="3001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>table_name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%s%%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>TABLESTYLEPREFIX</highlight></codeline>
<codeline lineno="3002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="3004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(self.table_count,<sp/>)),</highlight></codeline>
<codeline lineno="3005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="3007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>table_style.backgroundcolor<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;style:table-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;style:width&apos;:<sp/>&apos;17.59cm&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;table:align&apos;:<sp/>&apos;margins&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:align&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;left&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:margin-top&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0in&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:margin-bottom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.10in&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="3015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;style:table-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;style:width&apos;:<sp/>&apos;17.59cm&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:align&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;margins&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:margin-top&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0in&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:margin-bottom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.10in&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:background-color&apos;</highlight><highlight class="normal">:<sp/>table_style.backgroundcolor,</highlight></codeline>
<codeline lineno="3022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="3023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>use<sp/>a<sp/>single<sp/>cell<sp/>style<sp/>for<sp/>all<sp/>cells<sp/>in<sp/>this<sp/>table.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>That&apos;s<sp/>probably<sp/>not<sp/>correct,<sp/>but<sp/>seems<sp/>to<sp/>work.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="3027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s.%%c%%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(self.table_count,<sp/></highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">,<sp/>1,<sp/>)),</highlight></codeline>
<codeline lineno="3028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table-cell&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="3030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>thickness<sp/>=<sp/>self.settings.table_border_thickness</highlight></codeline>
<codeline lineno="3031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>thickness<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line_style1<sp/>=<sp/>table_style.border</highlight></codeline>
<codeline lineno="3033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line_style1<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;0.%03dcm<sp/>solid<sp/>#000000&apos;</highlight><highlight class="normal"><sp/>%<sp/>(thickness,<sp/>)</highlight></codeline>
<codeline lineno="3035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;style:table-cell-properties&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:padding&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;0.049cm&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-left&apos;</highlight><highlight class="normal">:<sp/>line_style1,</highlight></codeline>
<codeline lineno="3038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-right&apos;</highlight><highlight class="normal">:<sp/>line_style1,</highlight></codeline>
<codeline lineno="3039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-top&apos;</highlight><highlight class="normal">:<sp/>line_style1,</highlight></codeline>
<codeline lineno="3040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;fo:border-bottom&apos;</highlight><highlight class="normal">:<sp/>line_style1,</highlight></codeline>
<codeline lineno="3041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="3042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>child<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.children:</highlight></codeline>
<codeline lineno="3044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>child.tagname<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;title&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title<sp/>=<sp/>child.astext()</highlight></codeline>
<codeline lineno="3046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>title<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;table-title&apos;</highlight><highlight class="normal">,<sp/>title)</highlight></codeline>
<codeline lineno="3049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el4<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;table:table&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="3053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(self.table_count,<sp/>)),</highlight></codeline>
<codeline lineno="3054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="3055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>table_name,<sp/>(self.table_count,<sp/>)),</highlight></codeline>
<codeline lineno="3056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el4)</highlight></codeline>
<codeline lineno="3058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.current_table_style<sp/>=<sp/>el1</highlight></codeline>
<codeline lineno="3059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.table_width<sp/>=<sp/>0.0</highlight></codeline>
<codeline lineno="3060"><highlight class="normal"></highlight></codeline>
<codeline lineno="3061"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4a12407a10e35bf810444aa7022789d3" kindref="member">depart_table</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribkey<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1ab32ad2a86488d1ed805c762a4a9fc7db" kindref="member">add_ns</ref>(</highlight><highlight class="stringliteral">&apos;style:width&apos;</highlight><highlight class="normal">,<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="3063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attribval<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%.4fin&apos;</highlight><highlight class="normal"><sp/>%<sp/>(self.table_width,<sp/>)</highlight></codeline>
<codeline lineno="3064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.current_table_style</highlight></codeline>
<codeline lineno="3065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/>el1[0]</highlight></codeline>
<codeline lineno="3066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.attrib[attribkey]<sp/>=<sp/>attribval</highlight></codeline>
<codeline lineno="3067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="3068"><highlight class="normal"></highlight></codeline>
<codeline lineno="3069"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8c5a00f4f86907a0f43cd7e078204023" kindref="member">visit_tgroup</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.column_count<sp/>=<sp/>ord(</highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">)<sp/>-<sp/>1</highlight></codeline>
<codeline lineno="3071"><highlight class="normal"></highlight></codeline>
<codeline lineno="3072"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8e570c7ba70f543bde596c00451fdafa" kindref="member">depart_tgroup</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3074"><highlight class="normal"></highlight></codeline>
<codeline lineno="3075"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1f4851b56fa541a6ee76802ebcc7c051" kindref="member">visit_colspec</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.column_count<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="3077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colspec_name<sp/>=<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="3078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s%%d.%%s&apos;</highlight><highlight class="normal"><sp/>%<sp/>TABLESTYLEPREFIX,</highlight></codeline>
<codeline lineno="3079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.table_count,<sp/>chr(self.column_count),<sp/>)</highlight></codeline>
<codeline lineno="3080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>colwidth<sp/>=<sp/>node[</highlight><highlight class="stringliteral">&apos;colwidth&apos;</highlight><highlight class="normal">]<sp/>/<sp/>12.0</highlight></codeline>
<codeline lineno="3082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.automatic_styles,<sp/></highlight><highlight class="stringliteral">&apos;style:style&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:name&apos;</highlight><highlight class="normal">:<sp/>colspec_name,</highlight></codeline>
<codeline lineno="3084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:family&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;table-column&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>},<sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="3086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;style:table-column-properties&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;style:column-width&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%.4fin&apos;</highlight><highlight class="normal"><sp/>%<sp/>colwidth},</highlight></codeline>
<codeline lineno="3088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nsdict=SNSD)</highlight></codeline>
<codeline lineno="3089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;table:table-column&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/>colspec_name,<sp/>})</highlight></codeline>
<codeline lineno="3091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.table_width<sp/>+=<sp/>colwidth</highlight></codeline>
<codeline lineno="3092"><highlight class="normal"></highlight></codeline>
<codeline lineno="3093"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a6b963b08974b46c43c8d087368dc9b7a" kindref="member">depart_colspec</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3095"><highlight class="normal"></highlight></codeline>
<codeline lineno="3096"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ade3234e6c127bde515498e34e1556417" kindref="member">visit_thead</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;table:table-header-rows&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="3099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_thead<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(</highlight><highlight class="stringliteral">&apos;Table_20_Heading&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3101"><highlight class="normal"></highlight></codeline>
<codeline lineno="3102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a9d892c7c06a697be21abd6afcebf4147" kindref="member">depart_thead</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="3104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_thead<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="3106"><highlight class="normal"></highlight></codeline>
<codeline lineno="3107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a2c68e645f648a8af072ead0cfc153f99" kindref="member">visit_row</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.column_count<sp/>=<sp/>ord(</highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">)<sp/>-<sp/>1</highlight></codeline>
<codeline lineno="3109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;table:table-row&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="3111"><highlight class="normal"></highlight></codeline>
<codeline lineno="3112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa8757b336af79f22578cfeb328392d6b" kindref="member">depart_row</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="3114"><highlight class="normal"></highlight></codeline>
<codeline lineno="3115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a48804043d4ccfb0f9c0fd06d477b231f" kindref="member">visit_entry</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.column_count<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="3117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cellspec_name<sp/>=<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="3118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;%s%%d.%%c%%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>TABLESTYLEPREFIX,</highlight></codeline>
<codeline lineno="3119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(self.table_count,<sp/></highlight><highlight class="stringliteral">&apos;A&apos;</highlight><highlight class="normal">,<sp/>1,<sp/>)</highlight></codeline>
<codeline lineno="3120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="3121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="3122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;table:style-name&apos;</highlight><highlight class="normal">:<sp/>cellspec_name,</highlight></codeline>
<codeline lineno="3123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;office:value-type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;string&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>morecols<sp/>=<sp/>node.get(</highlight><highlight class="stringliteral">&apos;morecols&apos;</highlight><highlight class="normal">,<sp/>0)</highlight></codeline>
<codeline lineno="3126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>morecols<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="3127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;table:number-columns-spanned&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>(morecols<sp/>+<sp/>1,)</highlight></codeline>
<codeline lineno="3128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.column_count<sp/>+=<sp/>morecols</highlight></codeline>
<codeline lineno="3129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>morerows<sp/>=<sp/>node.get(</highlight><highlight class="stringliteral">&apos;morerows&apos;</highlight><highlight class="normal">,<sp/>0)</highlight></codeline>
<codeline lineno="3130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>morerows<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="3131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib[</highlight><highlight class="stringliteral">&apos;table:number-rows-spanned&apos;</highlight><highlight class="normal">]<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>(morerows<sp/>+<sp/>1,)</highlight></codeline>
<codeline lineno="3132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;table:table-cell&apos;</highlight><highlight class="normal">,<sp/>attrib=attrib)</highlight></codeline>
<codeline lineno="3133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el1)</highlight></codeline>
<codeline lineno="3134"><highlight class="normal"></highlight></codeline>
<codeline lineno="3135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1abdb456d60429001a0af08e4c25bba263" kindref="member">depart_entry</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="3137"><highlight class="normal"></highlight></codeline>
<codeline lineno="3138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a5581e882e84a4574b82369887102d274" kindref="member">visit_tbody</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3140"><highlight class="normal"></highlight></codeline>
<codeline lineno="3141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8210d087d2f2405fe5c09b5c0c898ac8" kindref="member">depart_tbody</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3143"><highlight class="normal"></highlight></codeline>
<codeline lineno="3144"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1abbca06a3690b581734bf27077c62d88c" kindref="member">visit_target</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>I<sp/>don&apos;t<sp/>know<sp/>how<sp/>to<sp/>implement<sp/>targets<sp/>in<sp/>ODF.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>How<sp/>do<sp/>we<sp/>create<sp/>a<sp/>target<sp/>in<sp/>oowriter?<sp/><sp/>A<sp/>cross-reference?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="stringliteral">&apos;refuri&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node</highlight></codeline>
<codeline lineno="3149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;refid&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node</highlight></codeline>
<codeline lineno="3150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;refname&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node):</highlight></codeline>
<codeline lineno="3151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3154"><highlight class="normal"></highlight></codeline>
<codeline lineno="3155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1abf706d2ab67640399d318e3b7eb778df" kindref="member">depart_target</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3157"><highlight class="normal"></highlight></codeline>
<codeline lineno="3158"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8dd336e583039dbe245469c4f00fdd73" kindref="member">visit_title</ref>(self,<sp/>node,<sp/>move_ids=1,<sp/>title_type=&apos;title&apos;):</highlight></codeline>
<codeline lineno="3159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1section" kindref="compound">docutils.nodes.section</ref>):</highlight></codeline>
<codeline lineno="3160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>section_level<sp/>=<sp/>self.section_level</highlight></codeline>
<codeline lineno="3161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>section_level<sp/>&gt;<sp/>7:</highlight></codeline>
<codeline lineno="3162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="3163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Heading/section<sp/>levels<sp/>greater<sp/>than<sp/>7<sp/>not<sp/>supported.&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.document.reporter.warning(</highlight></codeline>
<codeline lineno="3165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/>Reducing<sp/>to<sp/>heading<sp/>level<sp/>7<sp/>for<sp/>heading:<sp/>&quot;%s&quot;&apos;</highlight><highlight class="normal"><sp/>%<sp/>(</highlight></codeline>
<codeline lineno="3166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node.astext(),<sp/>))</highlight></codeline>
<codeline lineno="3167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>section_level<sp/>=<sp/>7</highlight></codeline>
<codeline lineno="3168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.append_child(</highlight></codeline>
<codeline lineno="3169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:h&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:outline-level&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>section_level,</highlight></codeline>
<codeline lineno="3171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;text:style-name&apos;:<sp/>&apos;Heading_20_%d&apos;<sp/>%<sp/>section_level,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="3173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;heading%d&apos;</highlight><highlight class="normal">,<sp/>(section_level,<sp/>)),</highlight></codeline>
<codeline lineno="3174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_pending_ids(el1)</highlight></codeline>
<codeline lineno="3176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el1)</highlight></codeline>
<codeline lineno="3177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1document" kindref="compound">docutils.nodes.document</ref>):</highlight></codeline>
<codeline lineno="3178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>text<sp/>=<sp/>self.settings.title</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>else:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/>text<sp/>=<sp/>node.astext()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(title_type),</highlight></codeline>
<codeline lineno="3183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_pending_ids(el1)</highlight></codeline>
<codeline lineno="3185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>text<sp/>=<sp/>node.astext()</highlight></codeline>
<codeline lineno="3186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.title<sp/>=<sp/>text</highlight></codeline>
<codeline lineno="3187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.found_doc_title<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el1)</highlight></codeline>
<codeline lineno="3189"><highlight class="normal"></highlight></codeline>
<codeline lineno="3190"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a8e39fef64f9b7569c9c07491949f0894" kindref="member">depart_title</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1section" kindref="compound">docutils.nodes.section</ref>)</highlight></codeline>
<codeline lineno="3192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>isinstance(node.parent,<sp/><ref refid="classdocutils_1_1nodes_1_1document" kindref="compound">docutils.nodes.document</ref>)):</highlight></codeline>
<codeline lineno="3193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="3194"><highlight class="normal"></highlight></codeline>
<codeline lineno="3195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a6b40fa46dfb04ce8d1c1867590b481f3" kindref="member">visit_subtitle</ref>(self,<sp/>node,<sp/>move_ids=1):</highlight></codeline>
<codeline lineno="3196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.visit_title(node,<sp/>move_ids,<sp/>title_type=</highlight><highlight class="stringliteral">&apos;subtitle&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3197"><highlight class="normal"></highlight></codeline>
<codeline lineno="3198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a6a8a93177c59d1fa076c62b9eb7019d1" kindref="member">depart_subtitle</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.depart_title(node)</highlight></codeline>
<codeline lineno="3200"><highlight class="normal"></highlight></codeline>
<codeline lineno="3201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4bd513e17b53015db5a184e285e45bd3" kindref="member">visit_title_reference</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;quotation&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="3204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el.text<sp/>=<sp/>self.encode(node.astext())</highlight></codeline>
<codeline lineno="3205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">raise</highlight><highlight class="normal"><sp/>nodes.SkipChildren()</highlight></codeline>
<codeline lineno="3206"><highlight class="normal"></highlight></codeline>
<codeline lineno="3207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afdfb8e1da4047bee108482db1a435bd9" kindref="member">depart_title_reference</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3209"><highlight class="normal"></highlight></codeline>
<codeline lineno="3210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1afd584e1334b04cae0c182a70f5727c7e" kindref="member">generate_table_of_content_entry_template</ref>(self,<sp/>el1):</highlight></codeline>
<codeline lineno="3211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>idx<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(1,<sp/>11):</highlight></codeline>
<codeline lineno="3212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="3213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1,</highlight></codeline>
<codeline lineno="3214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:table-of-content-entry-template&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight></codeline>
<codeline lineno="3216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:outline-level&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;%d&quot;</highlight><highlight class="normal"><sp/>%<sp/>(idx,<sp/>),</highlight></codeline>
<codeline lineno="3217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;contents-%d&apos;</highlight><highlight class="normal"><sp/>%<sp/>(idx,<sp/>)),</highlight></codeline>
<codeline lineno="3218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;text:index-entry-chapter&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;text:index-entry-text&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;text:index-entry-tab-stop&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:leader-char&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;.&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;style:type&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&quot;right&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;text:index-entry-page-number&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3226"><highlight class="normal"></highlight></codeline>
<codeline lineno="3227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a91adb5f19062ae281b82795fbbbed423" kindref="member">find_title_label</ref>(self,<sp/>node,<sp/>class_type,<sp/>label_key):</highlight></codeline>
<codeline lineno="3228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title_node<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>child<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.children:</highlight></codeline>
<codeline lineno="3231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(child,<sp/>class_type):</highlight></codeline>
<codeline lineno="3232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title_node<sp/>=<sp/>child</highlight></codeline>
<codeline lineno="3233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>title_node<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label<sp/>=<sp/>title_node.astext()</highlight></codeline>
<codeline lineno="3236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label<sp/>=<sp/>self.language.labels[label_key]</highlight></codeline>
<codeline lineno="3238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>label</highlight></codeline>
<codeline lineno="3239"><highlight class="normal"></highlight></codeline>
<codeline lineno="3240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa59215166aaf02efba6cf2b548972078" kindref="member">visit_topic</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes:</highlight></codeline>
<codeline lineno="3242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;contents&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="3243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label<sp/>=<sp/>self.find_title_label(</highlight></codeline>
<codeline lineno="3244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node,<sp/><ref refid="classdocutils_1_1nodes_1_1title" kindref="compound">docutils.nodes.title</ref>,<sp/></highlight><highlight class="stringliteral">&apos;contents&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.generate_oowriter_toc:</highlight></codeline>
<codeline lineno="3246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:table-of-content&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Table<sp/>of<sp/>Contents1&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:protected&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;true&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Sect1&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="3252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1,</highlight></codeline>
<codeline lineno="3253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:table-of-content-source&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight></codeline>
<codeline lineno="3255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:outline-level&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;10&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el2,<sp/></highlight><highlight class="stringliteral">&apos;text:index-title-template&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Contents_20_Heading&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el3.text<sp/>=<sp/>label</highlight></codeline>
<codeline lineno="3261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_table_of_content_entry_template(el2)</highlight></codeline>
<codeline lineno="3262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el4<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:index-body&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el5<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el4,<sp/></highlight><highlight class="stringliteral">&apos;text:index-title&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el6<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el5,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;contents-heading&apos;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="3266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el6.text<sp/>=<sp/>label</highlight></codeline>
<codeline lineno="3268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.save_current_element<sp/>=<sp/>self.current_element</highlight></codeline>
<codeline lineno="3269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.table_of_content_index_body<sp/>=<sp/>el4</highlight></codeline>
<codeline lineno="3270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el4)</highlight></codeline>
<codeline lineno="3271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;horizontalline&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;centeredtextbody&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="3275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;strong&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="3277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>label</highlight></codeline>
<codeline lineno="3278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_table_of_contents<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;abstract&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="3280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;horizontalline&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;centeredtextbody&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="3283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;strong&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="3285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label<sp/>=<sp/>self.find_title_label(</highlight></codeline>
<codeline lineno="3286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node,<sp/><ref refid="classdocutils_1_1nodes_1_1title" kindref="compound">docutils.nodes.title</ref>,</highlight></codeline>
<codeline lineno="3287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;abstract&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>label</highlight></codeline>
<codeline lineno="3289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;dedication&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="3290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;horizontalline&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;centeredtextbody&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(</highlight></codeline>
<codeline lineno="3293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el,<sp/></highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attrib={</highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;strong&apos;</highlight><highlight class="normal">)})</highlight></codeline>
<codeline lineno="3295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>label<sp/>=<sp/>self.find_title_label(</highlight></codeline>
<codeline lineno="3296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>node,<sp/><ref refid="classdocutils_1_1nodes_1_1title" kindref="compound">docutils.nodes.title</ref>,</highlight></codeline>
<codeline lineno="3297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;dedication&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>label</highlight></codeline>
<codeline lineno="3299"><highlight class="normal"></highlight></codeline>
<codeline lineno="3300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a3b128050ceb48e23ec42136f2349aede" kindref="member">depart_topic</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes:</highlight></codeline>
<codeline lineno="3302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;contents&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.attributes[</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="3303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.settings.generate_oowriter_toc:</highlight></codeline>
<codeline lineno="3304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.update_toc_page_numbers(</highlight></codeline>
<codeline lineno="3305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.table_of_content_index_body)</highlight></codeline>
<codeline lineno="3306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(self.save_current_element)</highlight></codeline>
<codeline lineno="3307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;horizontalline&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.in_table_of_contents<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3310"><highlight class="normal"></highlight></codeline>
<codeline lineno="3311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a73eac36812b792f84750cff532b8a6d5" kindref="member">update_toc_page_numbers</ref>(self,<sp/>el):</highlight></codeline>
<codeline lineno="3312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>collection<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="3313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.update_toc_collect(el,<sp/>0,<sp/>collection)</highlight></codeline>
<codeline lineno="3314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.update_toc_add_numbers(collection)</highlight></codeline>
<codeline lineno="3315"><highlight class="normal"></highlight></codeline>
<codeline lineno="3316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a414233994ba85a8ebefe9351eeebcaf7" kindref="member">update_toc_collect</ref>(self,<sp/>el,<sp/>level,<sp/>collection):</highlight></codeline>
<codeline lineno="3317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>collection.append((level,<sp/>el))</highlight></codeline>
<codeline lineno="3318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>level<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="3319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>child_el<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>el:</highlight></codeline>
<codeline lineno="3320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>child_el.tag<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;text:index-body&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.update_toc_collect(child_el,<sp/>level,<sp/>collection)</highlight></codeline>
<codeline lineno="3322"><highlight class="normal"></highlight></codeline>
<codeline lineno="3323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ad0620268d19c960ade04fc769be8d443" kindref="member">update_toc_add_numbers</ref>(self,<sp/>collection):</highlight></codeline>
<codeline lineno="3324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>level,<sp/>el1<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>collection:</highlight></codeline>
<codeline lineno="3325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(el1.tag<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>el1.text<sp/>!=<sp/></highlight><highlight class="stringliteral">&apos;Table<sp/>of<sp/>Contents&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="3327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(el1,<sp/></highlight><highlight class="stringliteral">&apos;text:tab&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el2.tail<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;9999&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3329"><highlight class="normal"></highlight></codeline>
<codeline lineno="3330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a12973a208e60c293aee46c2d1392f75f" kindref="member">visit_transition</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.append_p(</highlight><highlight class="stringliteral">&apos;horizontalline&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3332"><highlight class="normal"></highlight></codeline>
<codeline lineno="3333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a20626cf532bc9385397a25a4b9187607" kindref="member">depart_transition</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3335"><highlight class="normal"></highlight></codeline>
<codeline lineno="3336"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3337"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Admonitions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3339"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1acdd376af9a1f704f1cc5e03b9de68987" kindref="member">visit_warning</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;warning&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3341"><highlight class="normal"></highlight></codeline>
<codeline lineno="3342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aca1a429bdf3bc78f0f1cbbeb0a061a59" kindref="member">depart_warning</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.pop()</highlight></codeline>
<codeline lineno="3344"><highlight class="normal"></highlight></codeline>
<codeline lineno="3345"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1ae44bffd59fe82668e18f809bc610d644" kindref="member">visit_attention</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;attention&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3347"><highlight class="normal"></highlight></codeline>
<codeline lineno="3348"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_attention<sp/>=<sp/>depart_warning</highlight></codeline>
<codeline lineno="3349"><highlight class="normal"></highlight></codeline>
<codeline lineno="3350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af89b1b208a445050f9d3e870d936b5e4" kindref="member">visit_caution</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;caution&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3352"><highlight class="normal"></highlight></codeline>
<codeline lineno="3353"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_caution<sp/>=<sp/>depart_warning</highlight></codeline>
<codeline lineno="3354"><highlight class="normal"></highlight></codeline>
<codeline lineno="3355"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a250952abe27414c74b44a9a4dae81fe8" kindref="member">visit_danger</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;danger&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3357"><highlight class="normal"></highlight></codeline>
<codeline lineno="3358"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_danger<sp/>=<sp/>depart_warning</highlight></codeline>
<codeline lineno="3359"><highlight class="normal"></highlight></codeline>
<codeline lineno="3360"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aefa768f43e8a03da7f5bc1ea3c9b5c7f" kindref="member">visit_error</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;error&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3362"><highlight class="normal"></highlight></codeline>
<codeline lineno="3363"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_error<sp/>=<sp/>depart_warning</highlight></codeline>
<codeline lineno="3364"><highlight class="normal"></highlight></codeline>
<codeline lineno="3365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa793acf27839ff6791128d85cd495da7" kindref="member">visit_hint</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;hint&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3367"><highlight class="normal"></highlight></codeline>
<codeline lineno="3368"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_hint<sp/>=<sp/>depart_warning</highlight></codeline>
<codeline lineno="3369"><highlight class="normal"></highlight></codeline>
<codeline lineno="3370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a32a7776c6ce18e358b617d96a07b56f8" kindref="member">visit_important</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;important&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3372"><highlight class="normal"></highlight></codeline>
<codeline lineno="3373"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_important<sp/>=<sp/>depart_warning</highlight></codeline>
<codeline lineno="3374"><highlight class="normal"></highlight></codeline>
<codeline lineno="3375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a06f294599354c0ed3d1b0c4bcbe0e0b7" kindref="member">visit_note</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;note&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3377"><highlight class="normal"></highlight></codeline>
<codeline lineno="3378"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_note<sp/>=<sp/>depart_warning</highlight></codeline>
<codeline lineno="3379"><highlight class="normal"></highlight></codeline>
<codeline lineno="3380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a81d9b06fb6492df313dc5dd492136b22" kindref="member">visit_tip</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;tip&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3382"><highlight class="normal"></highlight></codeline>
<codeline lineno="3383"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_tip<sp/>=<sp/>depart_warning</highlight></codeline>
<codeline lineno="3384"><highlight class="normal"></highlight></codeline>
<codeline lineno="3385"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a4f2708c67df9b2581158eb6f79de2efd" kindref="member">visit_admonition</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>child<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>node.children:</highlight></codeline>
<codeline lineno="3388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>child.tagname<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;title&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title<sp/>=<sp/>child.astext()</highlight></codeline>
<codeline lineno="3390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>title<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>classes1<sp/>=<sp/>node.get(</highlight><highlight class="stringliteral">&apos;classes&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>classes1:</highlight></codeline>
<codeline lineno="3393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>title<sp/>=<sp/>classes1[0]</highlight></codeline>
<codeline lineno="3394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.generate_admonition(node,<sp/></highlight><highlight class="stringliteral">&apos;generic&apos;</highlight><highlight class="normal">,<sp/>title)</highlight></codeline>
<codeline lineno="3395"><highlight class="normal"></highlight></codeline>
<codeline lineno="3396"><highlight class="normal"><sp/><sp/><sp/><sp/>depart_admonition<sp/>=<sp/>depart_warning</highlight></codeline>
<codeline lineno="3397"><highlight class="normal"></highlight></codeline>
<codeline lineno="3398"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a72d96e59318db6fe9145890d3dd55a66" kindref="member">generate_admonition</ref>(self,<sp/>node,<sp/>label,<sp/>title=None):</highlight></codeline>
<codeline lineno="3399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(self.language,<sp/></highlight><highlight class="stringliteral">&apos;labels&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="3400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>translated_label<sp/>=<sp/>self.language.labels.get(label,<sp/>label)</highlight></codeline>
<codeline lineno="3401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>translated_label<sp/>=<sp/>label</highlight></codeline>
<codeline lineno="3403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1<sp/>=<sp/><ref refid="namespacedocutils_1_1writers_1_1odf__odt_1a6a78463ce4b4badf6583d1612fb8e1cc" kindref="member">SubElement</ref>(self.current_element,<sp/></highlight><highlight class="stringliteral">&apos;text:p&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/>self.rststyle(</highlight></codeline>
<codeline lineno="3405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;admon-%s-hdr&apos;</highlight><highlight class="normal">,<sp/>(label,<sp/>)),</highlight></codeline>
<codeline lineno="3406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>title:</highlight></codeline>
<codeline lineno="3408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/>title</highlight></codeline>
<codeline lineno="3409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el1.text<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;%s!&apos;</highlight><highlight class="normal"><sp/>%<sp/>(translated_label.capitalize(),<sp/>)</highlight></codeline>
<codeline lineno="3411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s1<sp/>=<sp/>self.rststyle(</highlight><highlight class="stringliteral">&apos;admon-%s-body&apos;</highlight><highlight class="normal">,<sp/>(label,<sp/>))</highlight></codeline>
<codeline lineno="3412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.paragraph_style_stack.append(s1)</highlight></codeline>
<codeline lineno="3413"><highlight class="normal"></highlight></codeline>
<codeline lineno="3414"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Roles<sp/>(e.g.<sp/>subscript,<sp/>superscript,<sp/>strong,<sp/>...</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3416"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a050dce737f052387789127cd6a5aa0e9" kindref="member">visit_subscript</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rststyle-subscript&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="3422"><highlight class="normal"></highlight></codeline>
<codeline lineno="3423"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1af003ed99410f7f034dcc3a010af118f6" kindref="member">depart_subscript</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="3425"><highlight class="normal"></highlight></codeline>
<codeline lineno="3426"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a6978c84dfd49fb7b0ec625bc06ca3724" kindref="member">visit_superscript</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>el<sp/>=<sp/>self.append_child(</highlight><highlight class="stringliteral">&apos;text:span&apos;</highlight><highlight class="normal">,<sp/>attrib={</highlight></codeline>
<codeline lineno="3428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;text:style-name&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;rststyle-superscript&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="3429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>})</highlight></codeline>
<codeline lineno="3430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_current_element(el)</highlight></codeline>
<codeline lineno="3431"><highlight class="normal"></highlight></codeline>
<codeline lineno="3432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a535ba68d362c2cc1c81c3b34362f05d1" kindref="member">depart_superscript</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.set_to_parent()</highlight></codeline>
<codeline lineno="3434"><highlight class="normal"></highlight></codeline>
<codeline lineno="3435"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a1a34d2c31adef26e3592f3f58d44747d" kindref="member">visit_abbreviation</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3437"><highlight class="normal"></highlight></codeline>
<codeline lineno="3438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a6e7bef3d2fab71abd1172bae7d39f650" kindref="member">depart_abbreviation</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3440"><highlight class="normal"></highlight></codeline>
<codeline lineno="3441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a02a09e88af1c9c2b61e3b596877c211c" kindref="member">visit_acronym</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3443"><highlight class="normal"></highlight></codeline>
<codeline lineno="3444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a9ba25761d69be0f0024816807927eb06" kindref="member">depart_acronym</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3446"><highlight class="normal"></highlight></codeline>
<codeline lineno="3447"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1a580804ec71028ca52d4a2aef5daf56fe" kindref="member">visit_sidebar</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3449"><highlight class="normal"></highlight></codeline>
<codeline lineno="3450"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1ODFTranslator_1aa72a70f459f4a7428df2fd7aded593ff" kindref="member">depart_sidebar</ref>(self,<sp/>node):</highlight></codeline>
<codeline lineno="3451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3452"><highlight class="normal"></highlight></codeline>
<codeline lineno="3453"><highlight class="normal"></highlight></codeline>
<codeline lineno="3454"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Use<sp/>an<sp/>own<sp/>reader<sp/>to<sp/>modify<sp/>transformations<sp/>done.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3455" refid="classdocutils_1_1writers_1_1odf__odt_1_1Reader" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">Reader(standalone.Reader):</highlight></codeline>
<codeline lineno="3456"><highlight class="normal"></highlight></codeline>
<codeline lineno="3457"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Reader_1a65e0a6d9e50438f445a9785d309d51cc" kindref="member">get_transforms</ref>(self):</highlight></codeline>
<codeline lineno="3458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transforms<sp/>=<sp/>super().<ref refid="classdocutils_1_1writers_1_1odf__odt_1_1Reader_1a65e0a6d9e50438f445a9785d309d51cc" kindref="member">get_transforms</ref>()</highlight></codeline>
<codeline lineno="3459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.settings.create_links:</highlight></codeline>
<codeline lineno="3460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>transforms.remove(references.DanglingReferences)</highlight></codeline>
<codeline lineno="3461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>transforms</highlight></codeline>
    </programlisting>
    <location file="docs/venv/lib/python3.12/site-packages/docutils/writers/odf_odt/__init__.py"/>
  </compounddef>
</doxygen>
