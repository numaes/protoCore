<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="math2html_8py" kind="file" language="Python">
    <compoundname>math2html.py</compoundname>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Trace" prot="public">docutils::utils::math::math2html::Trace</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerConfig" prot="public">docutils::utils::math::math2html::ContainerConfig</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EscapeConfig" prot="public">docutils::utils::math::math2html::EscapeConfig</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConfig" prot="public">docutils::utils::math::math2html::FormulaConfig</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser" prot="public">docutils::utils::math::math2html::CommandLineParser</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options" prot="public">docutils::utils::math::math2html::Options</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Cloner" prot="public">docutils::utils::math::math2html::Cloner</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor" prot="public">docutils::utils::math::math2html::ContainerExtractor</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser" prot="public">docutils::utils::math::math2html::Parser</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LoneCommand" prot="public">docutils::utils::math::math2html::LoneCommand</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser" prot="public">docutils::utils::math::math2html::TextParser</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ExcludingParser" prot="public">docutils::utils::math::math2html::ExcludingParser</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BoundedParser" prot="public">docutils::utils::math::math2html::BoundedParser</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BoundedDummy" prot="public">docutils::utils::math::math2html::BoundedDummy</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringParser" prot="public">docutils::utils::math::math2html::StringParser</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerOutput" prot="public">docutils::utils::math::math2html::ContainerOutput</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyOutput" prot="public">docutils::utils::math::math2html::EmptyOutput</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FixedOutput" prot="public">docutils::utils::math::math2html::FixedOutput</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput" prot="public">docutils::utils::math::math2html::ContentsOutput</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" prot="public">docutils::utils::math::math2html::TaggedOutput</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput" prot="public">docutils::utils::math::math2html::FilteredOutput</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringOutput" prot="public">docutils::utils::math::math2html::StringOutput</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable" prot="public">docutils::utils::math::math2html::Globable</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList" prot="public">docutils::utils::math::math2html::EndingList</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding" prot="public">docutils::utils::math::math2html::PositionEnding</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position" prot="public">docutils::utils::math::math2html::Position</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition" prot="public">docutils::utils::math::math2html::TextPosition</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container" prot="public">docutils::utils::math::math2html::Container</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BlackBox" prot="public">docutils::utils::math::math2html::BlackBox</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer" prot="public">docutils::utils::math::math2html::StringContainer</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant" prot="public">docutils::utils::math::math2html::Constant</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1DocumentParameters" prot="public">docutils::utils::math::math2html::DocumentParameters</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser" prot="public">docutils::utils::math::math2html::FormulaParser</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" prot="public">docutils::utils::math::math2html::FormulaBit</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" prot="public">docutils::utils::math::math2html::TaggedBit</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" prot="public">docutils::utils::math::math2html::FormulaConstant</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1RawText" prot="public">docutils::utils::math::math2html::RawText</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaSymbol" prot="public">docutils::utils::math::math2html::FormulaSymbol</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaNumber" prot="public">docutils::utils::math::math2html::FormulaNumber</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Comment" prot="public">docutils::utils::math::math2html::Comment</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1WhiteSpace" prot="public">docutils::utils::math::math2html::WhiteSpace</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket" prot="public">docutils::utils::math::math2html::Bracket</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SquareBracket" prot="public">docutils::utils::math::math2html::SquareBracket</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MathsProcessor" prot="public">docutils::utils::math::math2html::MathsProcessor</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor" prot="public">docutils::utils::math::math2html::FormulaProcessor</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula" prot="public">docutils::utils::math::math2html::Formula</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1WholeFormula" prot="public">docutils::utils::math::math2html::WholeFormula</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory" prot="public">docutils::utils::math::math2html::FormulaFactory</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand" prot="public">docutils::utils::math::math2html::FormulaCommand</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" prot="public">docutils::utils::math::math2html::CommandBit</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyCommand" prot="public">docutils::utils::math::math2html::EmptyCommand</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SpacedCommand" prot="public">docutils::utils::math::math2html::SpacedCommand</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1AlphaCommand" prot="public">docutils::utils::math::math2html::AlphaCommand</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction" prot="public">docutils::utils::math::math2html::OneParamFunction</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SymbolFunction" prot="public">docutils::utils::math::math2html::SymbolFunction</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextFunction" prot="public">docutils::utils::math::math2html::TextFunction</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FontFunction" prot="public">docutils::utils::math::math2html::FontFunction</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket" prot="public">docutils::utils::math::math2html::BigBracket</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaEquation" prot="public">docutils::utils::math::math2html::FormulaEquation</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCell" prot="public">docutils::utils::math::math2html::FormulaCell</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow" prot="public">docutils::utils::math::math2html::FormulaRow</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula" prot="public">docutils::utils::math::math2html::MultiRowFormula</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray" prot="public">docutils::utils::math::math2html::FormulaArray</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaMatrix" prot="public">docutils::utils::math::math2html::FormulaMatrix</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases" prot="public">docutils::utils::math::math2html::FormulaCases</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment" prot="public">docutils::utils::math::math2html::EquationEnvironment</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BeginCommand" prot="public">docutils::utils::math::math2html::BeginCommand</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CombiningFunction" prot="public">docutils::utils::math::math2html::CombiningFunction</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OversetFunction" prot="public">docutils::utils::math::math2html::OversetFunction</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1UndersetFunction" prot="public">docutils::utils::math::math2html::UndersetFunction</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitCommand" prot="public">docutils::utils::math::math2html::LimitCommand</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitPreviousCommand" prot="public">docutils::utils::math::math2html::LimitPreviousCommand</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor" prot="public">docutils::utils::math::math2html::LimitsProcessor</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketCommand" prot="public">docutils::utils::math::math2html::BracketCommand</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor" prot="public">docutils::utils::math::math2html::BracketProcessor</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition" prot="public">docutils::utils::math::math2html::ParameterDefinition</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction" prot="public">docutils::utils::math::math2html::ParameterFunction</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction" prot="public">docutils::utils::math::math2html::HybridFunction</innerclass>
    <innerclass refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridSize" prot="public">docutils::utils::math::math2html::HybridSize</innerclass>
    <innernamespace refid="namespacedocutils">docutils</innernamespace>
    <innernamespace refid="namespacedocutils_1_1utils">docutils::utils</innernamespace>
    <innernamespace refid="namespacedocutils_1_1utils_1_1math">docutils::utils::math</innernamespace>
    <innernamespace refid="namespacedocutils_1_1utils_1_1math_1_1math2html">docutils::utils::math::math2html</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacedocutils_1_1utils_1_1math_1_1math2html" refkind="compound"><highlight class="comment">#!<sp/>/usr/bin/env<sp/>python3</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>math2html:<sp/>convert<sp/>LaTeX<sp/>equations<sp/>to<sp/>HTML<sp/>output.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>Copyright<sp/>(C)<sp/>2009-2011<sp/>Alex<sp/>Fernández,<sp/>2021<sp/>Günter<sp/>Milde</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>Released<sp/>under<sp/>the<sp/>terms<sp/>of<sp/>the<sp/>`2-Clause<sp/>BSD<sp/>license&apos;_,<sp/>in<sp/>short:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>Copying<sp/>and<sp/>distribution<sp/>of<sp/>this<sp/>file,<sp/>with<sp/>or<sp/>without<sp/>modification,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>are<sp/>permitted<sp/>in<sp/>any<sp/>medium<sp/>without<sp/>royalty<sp/>provided<sp/>the<sp/>copyright</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>notice<sp/>and<sp/>this<sp/>notice<sp/>are<sp/>preserved.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>This<sp/>file<sp/>is<sp/>offered<sp/>as-is,<sp/>without<sp/>any<sp/>warranty.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">#</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">#<sp/>..<sp/>_2-Clause<sp/>BSD<sp/>license:<sp/>https://opensource.org/licenses/BSD-2-Clause</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>Based<sp/>on<sp/>eLyXer:<sp/>convert<sp/>LyX<sp/>source<sp/>files<sp/>to<sp/>HTML<sp/>output.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/>http://alexfernandez.github.io/elyxer/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Versions:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="comment">#<sp/>1.2.5<sp/><sp/>2015-02-26<sp/><sp/>eLyXer<sp/>standalone<sp/>formula<sp/>conversion<sp/>to<sp/>HTML.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="comment">#<sp/>1.3<sp/><sp/><sp/><sp/>2021-06-02<sp/><sp/>Removed<sp/>code<sp/>for<sp/>conversion<sp/>of<sp/>LyX<sp/>files<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>required<sp/>for<sp/>LaTeX<sp/>math.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Support<sp/>for<sp/>more<sp/>math<sp/>commands<sp/>from<sp/>the<sp/>AMS<sp/>&quot;math-guide&quot;.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="comment">#<sp/>2.0<sp/><sp/><sp/><sp/>2021-12-31<sp/><sp/>Drop<sp/>2.7<sp/>compatibility<sp/>code.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>pathlib</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>sys</highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>unicodedata</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacedocutils_1_1utils_1_1math" kindref="compound">docutils.utils.math</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>tex2unichar</highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight></codeline>
<codeline lineno="31"><highlight class="normal">__version__<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;1.3<sp/>(2021-06-02)&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Trace" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Trace" kindref="compound">Trace</ref>:</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>tracing<sp/>class&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/>debugmode<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/>quietmode<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/>showlinesmode<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/>prefix<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Trace_1aeebb9e3dbc3411bdf142f0daa5e82ec9" kindref="member">debug</ref>(cls,<sp/>message):</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>a<sp/>debug<sp/>message&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>Trace.debugmode<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>Trace.quietmode:</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.show(message,<sp/>sys.stdout)</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Trace_1a8e149b47299237dd9a6d93b2568b292d" kindref="member">message</ref>(cls,<sp/>message):</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>a<sp/>trace<sp/>message&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>Trace.quietmode:</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>Trace.prefix<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>Trace.showlinesmode:</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>=<sp/>Trace.prefix<sp/>+<sp/>message</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.show(message,<sp/>sys.stdout)</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Trace_1a119c2f4ef083478385b7e6f0b6330018" kindref="member">error</ref>(cls,<sp/>message):</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>an<sp/>error<sp/>message&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;*<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>message</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>Trace.prefix<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>Trace.showlinesmode:</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>=<sp/>Trace.prefix<sp/>+<sp/>message</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.show(message,<sp/>sys.stderr)</highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Trace_1aaf7db3ed10af52980f4d8752d07cc9f2" kindref="member">show</ref>(cls,<sp/>message,<sp/>channel):</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>a<sp/>message<sp/>out<sp/>of<sp/>a<sp/>channel&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>channel.write(message<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/>debug<sp/>=<sp/>classmethod(debug)</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/>message<sp/>=<sp/>classmethod(message)</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/>error<sp/>=<sp/>classmethod(error)</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/>show<sp/>=<sp/>classmethod(show)</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight></codeline>
<codeline lineno="74" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerConfig" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerConfig" kindref="compound">ContainerConfig</ref>:</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Configuration<sp/>class<sp/>from<sp/>elyxer.config<sp/>file&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/>extracttext<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;allowed&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;FormulaConstant&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;extracted&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;AlphaCommand&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Bracket&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;BracketCommand&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;CombiningFunction&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;EmptyCommand&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;FontFunction&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Formula&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;FormulaNumber&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;FormulaSymbol&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;OneParamFunction&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;OversetFunction&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;RawText&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;SpacedCommand&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;SymbolFunction&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;TextFunction&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;UndersetFunction&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>],</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EscapeConfig" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EscapeConfig" kindref="compound">EscapeConfig</ref>:</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Configuration<sp/>class<sp/>from<sp/>elyxer.config<sp/>file&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>chars<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&apos;&quot;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;’&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;`&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;‘&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/>entities<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&amp;&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&amp;amp;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&amp;lt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&gt;&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&amp;gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"></highlight></codeline>
<codeline lineno="115" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConfig" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConfig" kindref="compound">FormulaConfig</ref>:</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Configuration<sp/>class<sp/>from<sp/>elyxer.config<sp/>file&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/>alphacommands<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\AmS&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;textsc&quot;&gt;AmS&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\AA&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Å&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\AE&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Æ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\DH&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Ð&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\L&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Ł&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\O&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Ø&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\OE&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Œ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\TH&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;Þ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\aa&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;å&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ae&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;æ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dh&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ð&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\i&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ı&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\j&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ȷ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\l&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ł&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\o&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ø&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\oe&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;œ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ss&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ß&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\th&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;þ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\hbar&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ħ&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>cf.<sp/>\hslash:<sp/>ℏ<sp/>in<sp/>tex2unichar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>key,<sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>tex2unichar.mathalpha.items():</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alphacommands[</highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal">+key]<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/>array<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;begin&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">r&apos;\begin&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;cellseparator&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&amp;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;end&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">r&apos;\end&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;rowseparator&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">r&apos;\\&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/>bigbrackets<sp/>=<sp/>{</highlight><highlight class="stringliteral">&apos;(&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;⎛&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎜&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎝&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;)&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;⎞&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎟&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎠&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;⎡&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎢&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎣&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;]&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;⎤&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎥&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎦&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;{&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;⎧&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎪&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎨&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎩&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;}&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;⎫&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎪&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎬&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;⎭&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>2-row<sp/>brackets<sp/>with<sp/>⎰⎱<sp/>(\lmoustache<sp/>\rmoustache)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;|&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;|&apos;</highlight><highlight class="normal">],<sp/><sp/></highlight><highlight class="comment">#<sp/>007C<sp/>VERTICAL<sp/>LINE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;|&apos;:<sp/>[&apos;⎮&apos;],<sp/><sp/>#<sp/>23AE<sp/>INTEGRAL<sp/>EXTENSION</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;|&apos;:<sp/>[&apos;⎪&apos;],<sp/><sp/>#<sp/>23AA<sp/>CURLY<sp/>BRACKET<sp/>EXTENSION</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;‖&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;‖&apos;</highlight><highlight class="normal">],<sp/><sp/></highlight><highlight class="comment">#<sp/>2016<sp/>DOUBLE<sp/>VERTICAL<sp/>LINE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;∥&apos;:<sp/>[&apos;∥&apos;],<sp/><sp/>#<sp/>2225<sp/>PARALLEL<sp/>TO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/>bracketcommands<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\left&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;stretchy&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\left.&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;leftdot&quot;&gt;&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\middle&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;stretchy&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\right&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;stretchy&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\right.&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;rightdot&quot;&gt;&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/>combiningfunctions<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;\\&apos;&quot;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u0301&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x́</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\&quot;&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u0308&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>ẍ</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\^&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u0302&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x̂</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\`&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u0300&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x̀</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\~&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u0303&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x̃</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\c&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u0327&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x̧</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\r&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u030a&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x̊</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\s&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u0329&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x̩</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textcircled&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u20dd&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x⃝</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textsubring&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u0325&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x̥</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\v&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u030c&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>x̌</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>key,<sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>tex2unichar.mathaccent.items():</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>combiningfunctions[</highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal">+key]<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/>commands<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\\\&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;br/&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\\n&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>escaped<sp/>whitespace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\\t&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>escaped<sp/>whitespace</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\centerdot&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2B1D&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>BLACK<sp/>VERY<sp/>SMALL<sp/>SQUARE,<sp/>mathbin</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\colon&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;:<sp/>&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\copyright&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;©&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dotminus&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;∸&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dots&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;…&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dotsb&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⋯&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dotsc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;…&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dotsi&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⋯&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dotsm&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⋯&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dotso&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;…&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\euro&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;€&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\guillemotleft&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;«&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\guillemotright&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;»&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\lVert&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;‖&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Arrowvert&apos;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="stringliteral">&apos;‖&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\lvert&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;|&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\newline&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;br/&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nobreakspace&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos; &apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nolimits&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nonumber&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\qquad&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;  &apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\rVert&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;‖&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\rvert&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;|&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textasciicircum&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;^&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textasciitilde&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;~&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textbackslash&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textcopyright&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;©&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textdegree&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;°&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textellipsis&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;…&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textemdash&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;—&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textendash&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;—&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\texteuro&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;€&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textgreater&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textless&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textordfeminine&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ª&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textordmasculine&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;º&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textquotedblleft&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;“&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textquotedblright&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;”&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textquoteright&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;’&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textregistered&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;®&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textrightarrow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;→&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textsection&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;§&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\texttrademark&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;™&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\texttwosuperior&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;²&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textvisiblespace&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\thickspace&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;thickspace&quot;&gt;<sp/>&lt;/span&gt;&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>5/13<sp/>em</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\;&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;thickspace&quot;&gt;<sp/>&lt;/span&gt;&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>5/13<sp/>em</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\triangle&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u25B3&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>WHITE<sp/>UP-POINTING<sp/>TRIANGLE,<sp/>mathord</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\triangledown&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u25BD&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>WHITE<sp/>DOWN-POINTING<sp/>TRIANGLE,<sp/>mathord</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\varnothing&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2300&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>⌀<sp/>DIAMETER<sp/>SIGN</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>functions</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Pr&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Pr&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\arccos&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;arccos&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\arcsin&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;arcsin&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\arctan&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;arctan&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\arg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;arg&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\cos&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;cos&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\cosh&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;cosh&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\cot&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;cot&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\coth&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;coth&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\csc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;csc&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\deg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;deg&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\det&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;det&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dim&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;dim&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\exp&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;exp&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\gcd&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;gcd&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\hom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;hom&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\injlim&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;inj lim&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ker&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ker&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\lg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;lg&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\liminf&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;lim inf&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\limsup&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;lim sup&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ln&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ln&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\log&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;log&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\projlim&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;proj lim&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\sec&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;sec&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\sin&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;sin&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\sinh&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;sinh&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\tan&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;tan&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\tanh&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;tanh&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>cmddict<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/>cmddict.update(tex2unichar.mathbin)<sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>spacing<sp/>around<sp/>binary<sp/>operators</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/>cmddict.update(tex2unichar.mathopen)</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/>cmddict.update(tex2unichar.mathclose)</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>cmddict.update(tex2unichar.mathfence)</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/>cmddict.update(tex2unichar.mathord)</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>cmddict.update(tex2unichar.mathpunct)</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/>cmddict.update(tex2unichar.space)</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/>commands.update((</highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal"><sp/>+<sp/>key,<sp/>value)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>key,<sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>cmddict.items())</highlight></codeline>
<codeline lineno="281"><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>oversetfunctions<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>math<sp/>accents<sp/>(cf.<sp/>combiningfunctions)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\acute&apos;:<sp/><sp/><sp/><sp/>&apos;´&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bar&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;‒&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>FIGURE<sp/>DASH</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\breve&apos;:<sp/><sp/><sp/><sp/>&apos;˘&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\check&apos;:<sp/><sp/><sp/><sp/>&apos;ˇ&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dddot&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;smallsymbol&quot;&gt;⋯&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\ddot&apos;:<sp/><sp/><sp/><sp/><sp/>&apos;··&apos;,<sp/>#<sp/>¨<sp/>too<sp/>high</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\dot&apos;:<sp/><sp/><sp/><sp/><sp/><sp/>&apos;·&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\grave&apos;:<sp/><sp/><sp/><sp/>&apos;`&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\hat&apos;:<sp/><sp/><sp/><sp/><sp/><sp/>&apos;^&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\mathring&apos;:<sp/>&apos;˚&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\tilde&apos;:<sp/><sp/><sp/><sp/>&apos;~&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\vec&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;smallsymbol&quot;&gt;→&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>embellishments</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\overleftarrow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⟵&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\overleftrightarrow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⟷&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\overrightarrow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⟶&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\widehat&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;^&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\widetilde&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;～&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/>undersetfunctions<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\underleftarrow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⟵&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\underleftrightarrow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⟷&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\underrightarrow&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⟶&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="309"><highlight class="normal"></highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/>endings<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;bracket&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;}&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;complex&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\\]&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;endafter&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;}&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;endbefore&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\\end{&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;squarebracket&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;]&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/>environments<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;align&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;r&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;l&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;eqnarray&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;r&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;c&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;l&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;gathered&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;l&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;l&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;smallmatrix&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;c&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;c&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/>fontfunctions<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\boldsymbol&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;b&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;blackboard&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{A}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝔸&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{B}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝔹&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{C}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℂ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{D}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝔻&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{E}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝔼&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{F}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝔽&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{G}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝔾&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{H}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℍ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{J}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝕁&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{K}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝕂&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{L}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝕃&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{N}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℕ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{O}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝕆&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{P}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℙ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{Q}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℚ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{R}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℝ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{S}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝕊&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{T}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝕋&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{W}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝕎&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbb{Z}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℤ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathbf&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;b&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathcal&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;scriptfont&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathcal{B}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℬ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathcal{E}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℰ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathcal{F}&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;ℱ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathcal{H}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℋ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathcal{I}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℐ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathcal{L}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℒ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathcal{M}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℳ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathcal{R}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℛ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathfrak&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;fraktur&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathfrak{C}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℭ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathfrak{F}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;𝔉&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathfrak{H}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℌ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathfrak{I}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℑ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathfrak{R}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℜ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathfrak{Z}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℨ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathit&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathring{A}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Å&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathring{U}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;Ů&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathring{a}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;å&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathring{u}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ů&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathring{w}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ẘ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathring{y}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ẙ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathrm&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;mathrm&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathscr&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;mathscr&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathscr{B}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℬ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathscr{E}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℰ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathscr{F}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℱ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathscr{H}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℋ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathscr{I}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℐ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathscr{L}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℒ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathscr{M}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℳ&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\mathscr{R}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;ℛ&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathsf&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;mathsf&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mathtt&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;mathtt&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\operatorname&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;mathrm&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="354"><highlight class="normal"></highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>hybridfunctions<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\addcontentsline&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}{$q!}{$r!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ignored&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\addtocontents&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}{$q!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ignored&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\backmatter&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ignored&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\binom&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f2{(}f0{f1{$1}f1{$2}}f2{)}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;binom&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;binomstack&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size2&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\boxed&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;boxed&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\cfrac&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$p!]{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{f3{(}f1{$1}f3{)/(}f2{$2}f3{)}}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;fullfraction&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;numerator<sp/>align-$p&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;denominator&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;ignored&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\color&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>style=&quot;color:<sp/>$p;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\colorbox&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;colorbox&quot;<sp/>style=&quot;background:<sp/>$p;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dbinom&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;(f0{f1{f2{$1}}f1{f2{ }}f1{f2{$2}}})&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;binomial&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;binomrow&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;binomcell&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dfrac&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{f3{(}f1{$1}f3{)/(}f2{$2}f3{)}}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;fullfraction&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;numerator&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;denominator&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;ignored&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\displaystyle&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;displaystyle&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\fancyfoot&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$p!]{$q!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ignored&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\fancyhead&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$p!]{$q!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ignored&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\fbox&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;fbox&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\fboxrule&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ignored&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\fboxsep&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ignored&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\fcolorbox&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}{$q!}{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;boxed&quot;<sp/>style=&quot;border-color:<sp/>$p;<sp/>background:<sp/>$q;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\frac&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{f3{(}f1{$1}f3{)/(}f2{$2}f3{)}}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;fraction&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;numerator&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;denominator&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;ignored&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\framebox&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$p!][$q!]{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;framebox<sp/>align-$q&quot;<sp/>style=&quot;width:<sp/>$p;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\frontmatter&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ignored&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\href&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$o]{$u!}{$t!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$t}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;a<sp/>href=&quot;$u&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\hspace&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{<sp/>}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;hspace&quot;<sp/>style=&quot;width:<sp/>$p;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\leftroot&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{<sp/>}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;leftroot&quot;<sp/>style=&quot;width:<sp/>$p;px&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>convert<sp/>1<sp/>mu<sp/>to<sp/>1/18<sp/>em</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\mspace&apos;:<sp/>[&apos;{$p!}&apos;,<sp/>&apos;f0{<sp/>}&apos;,<sp/>&apos;span<sp/>class=&quot;hspace&quot;<sp/>style=&quot;width:<sp/>$p;&quot;&apos;],</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nicefrac&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{f1{$1}⁄f2{$2}}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;fraction&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;sup<sp/>class=&quot;numerator&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;sub<sp/>class=&quot;denominator&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;ignored&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\parbox&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$p!]{$w!}{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;div<sp/>class=&quot;Boxed&quot;<sp/>style=&quot;width:<sp/>$w;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\raisebox&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1.font}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;raisebox&quot;<sp/>style=&quot;vertical-align:<sp/>$p;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\renewenvironment&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1!}{$2!}{$3!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\rule&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$v!]{$w!}{$h!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0/&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;hr<sp/>class=&quot;line&quot;<sp/>style=&quot;width:<sp/>$w;<sp/>height:<sp/>$h;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\scriptscriptstyle&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;scriptscriptstyle&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\scriptstyle&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;scriptstyle&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>increase<sp/>√-size<sp/>with<sp/>argument<sp/>(\frac<sp/>in<sp/>display<sp/>mode,<sp/>...)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\sqrt&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$0]{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{f1{$0}f2{√}f4{(}f3{$1}f4{)}}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;sqrt&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;sup<sp/>class=&quot;root&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;radical&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;root&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;ignored&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\stackrel&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{f1{$1}f2{$2}}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;stackrel&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;upstackrel&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;downstackrel&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\tbinom&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;(f0{f1{f2{$1}}f1{f2{ }}f1{f2{$2}}})&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;binomial&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;binomrow&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;binomcell&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\tfrac&apos;</highlight><highlight class="normal">:<sp/><sp/>[</highlight><highlight class="stringliteral">&apos;{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{f3{(}f1{$1}f3{)/(}f2{$2}f3{)}}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;textfraction&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;numerator&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;denominator&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;ignored&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textcolor&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>style=&quot;color:<sp/>$p;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textstyle&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;textstyle&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\thispagestyle&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;ignored&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\unit&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$0]{$1}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;$0f0{$1.font}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;unit&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\unitfrac&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;[$0]{$1}{$2}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;$0f0{f1{$1.font}⁄f2{$2.font}}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;fraction&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;sup<sp/>class=&quot;unit&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;sub<sp/>class=&quot;unit&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\uproot&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{<sp/>}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;uproot&quot;<sp/>style=&quot;width:<sp/>$p;px&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\url&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$u!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{$u}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;a<sp/>href=&quot;$u&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\vspace&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;{$p!}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;f0{<sp/>}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;vspace&quot;<sp/>style=&quot;height:<sp/>$p;&quot;&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="402"><highlight class="normal"></highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/>hybridsizes<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\binom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;$1+$2&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\cfrac&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;$1+$2&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\dbinom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;$1+$2+1&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\dfrac&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;$1+$2&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\frac&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;$1+$2&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\tbinom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;$1+$2+1&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="407"><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>labelfunctions<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\label&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;a<sp/>name=&quot;#&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="411"><highlight class="normal"></highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/>limitcommands<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\biginterleave&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⫼&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\inf&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;inf&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\lim&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;lim&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\max&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;max&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\min&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;min&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\sup&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;sup&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ointop&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∮&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigcap&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⋂&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigcup&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⋃&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigodot&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⨀&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigoplus&apos;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⨁&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigotimes&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⨂&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigsqcap&apos;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⨅&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigsqcup&apos;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⨆&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\biguplus&apos;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⨄&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigvee&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⋁&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigwedge&apos;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⋀&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\coprod&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;∐&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\intop&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∫&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\prod&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;∏&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\sum&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;∑&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\varprod&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator&quot;&gt;⨉&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\zcmp&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⨟&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\zhide&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⧹&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\zpipe&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⨠&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\zproject&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;⨡&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>integrals<sp/>have<sp/>limits<sp/>in<sp/>index<sp/>position<sp/>with<sp/>LaTeX<sp/>default<sp/>settings</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>move<sp/>to<sp/>commands?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\int&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∫&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\iint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∬&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\iiint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∭&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\iiiint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;⨌&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\fint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;⨏&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\idotsint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∫⋯∫&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\oint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∮&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\oiint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∯&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\oiiint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∰&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ointclockwise&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∲&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ointctrclockwise&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∳&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\smallint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;smallsymbol<sp/>integral&quot;&gt;∫&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\sqint&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;⨖&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\varointclockwise&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;bigoperator<sp/>integral&quot;&gt;∲&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="453"><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/>modified<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&amp;&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;<sp/><sp/>&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\&apos;&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;’&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;+&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2009+\u2009&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;,&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;,\u2009&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;-&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2009−\u2009&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2009⁄\u2009&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;:&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;<sp/>:<sp/>&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&lt;&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2009&amp;lt;\u2009&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;=&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2009=\u2009&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&gt;&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2009&amp;gt;\u2009&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;@&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;~&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u00a0&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/>onefunctions<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\big&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size1&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigl&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size1&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigr&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size1&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Big&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size2&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Bigl&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size2&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Bigr&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size2&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\bigg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size3&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\biggl&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size3&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\biggr&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size3&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Bigg&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size4&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Biggl&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size4&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Biggr&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bigdelimiter<sp/>size4&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>&apos;\\bar&apos;:<sp/>&apos;span<sp/>class=&quot;bar&quot;&apos;,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\begin{array}&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;arraydef&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\centering&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;align-center&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ensuremath&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;ensuremath&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\hphantom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;phantom&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\noindent&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;noindent&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\overbrace&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;overbrace&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\overline&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;overline&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\phantom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;phantom&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\underbrace&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;underbrace&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\underline&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\vphantom&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;phantom&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>relations<sp/>(put<sp/>additional<sp/>space<sp/>before<sp/>and<sp/>after<sp/>the<sp/>symbol)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/>spacedcommands<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>negated<sp/>symbols<sp/>without<sp/>pre-composed<sp/>Unicode<sp/>character</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nleqq&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u2266\u0338&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>≦̸</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ngeqq&apos;</highlight><highlight class="normal">:<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\u2267\u0338&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>≧̸</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nleqslant&apos;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="stringliteral">&apos;\u2a7d\u0338&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>⩽̸</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\ngeqslant&apos;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="stringliteral">&apos;\u2a7e\u0338&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>⩾̸</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nsubseteqq&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2AC5\u0338&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>⫅̸</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nsupseteqq&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\u2AC6\u0338&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>⫆̸</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nsqsubset&apos;</highlight><highlight class="normal">:<sp/><sp/></highlight><highlight class="stringliteral">&apos;\u2276\u228F&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>⊏̸</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>modified<sp/>glyphs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\shortmid&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;smallsymbol&quot;&gt;∣&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\shortparallel&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;smallsymbol&quot;&gt;∥&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nshortmid&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;smallsymbol&quot;&gt;∤&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\nshortparallel&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;smallsymbol&quot;&gt;∦&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\smallfrown&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;smallsymbol&quot;&gt;⌢&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\smallsmile&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;smallsymbol&quot;&gt;⌣&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\thickapprox&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;boldsymbol&quot;&gt;≈&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\thicksim&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;boldsymbol&quot;&gt;∼&lt;/span&gt;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\varpropto&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;&lt;span<sp/>class=&quot;mathsf&quot;&gt;\u221d&lt;/span&gt;&apos;</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">#<sp/>∝<sp/>PROPORTIONAL<sp/>TO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>key,<sp/>value<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>tex2unichar.mathrel.items():</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>spacedcommands[</highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal">+key]<sp/>=<sp/>value</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/>starts<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;beginafter&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;}&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;beginbefore&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\\begin{&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;bracket&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;{&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;command&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;comment&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;%&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;complex&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;\\[&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;simple&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;squarebracket&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;unnumbered&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="515"><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/>symbolfunctions<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;^&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;sup&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;_&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;sub&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="519"><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/>textfunctions<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\mbox&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;mbox&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\text&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;text&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textbf&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;textbf&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textit&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;textit&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textnormal&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;textnormal&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textrm&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;textrm&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textsc&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;textsc&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textsf&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;textsf&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textsl&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;textsl&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\texttt&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;texttt&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\textup&apos;</highlight><highlight class="normal">:<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;normal&quot;&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="533"><highlight class="normal"></highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/>unmodified<sp/>=<sp/>{</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;characters&apos;</highlight><highlight class="normal">:<sp/>[</highlight><highlight class="stringliteral">&apos;.&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;€&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;(&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;)&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;]&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;·&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;!&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;|&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;§&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;?&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="538"><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"></highlight></codeline>
<codeline lineno="540" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser" kindref="compound">CommandLineParser</ref>:</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>parser<sp/>for<sp/>runtime<sp/>options&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="542"><highlight class="normal"></highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1a74a79ffc4992950bcea1eb2e3fde7a67" kindref="member">__init__</ref>(self,<sp/>options):</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1a8aa2bd3627070736471cbd9e786e41f5" kindref="member">options</ref><sp/>=<sp/>options</highlight></codeline>
<codeline lineno="545"><highlight class="normal"></highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1ad68e93d601d44e8a287c564f3537149f" kindref="member">parseoptions</ref>(self,<sp/>args):</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>command<sp/>line<sp/>options&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(args)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>len(args)<sp/>&gt;<sp/>0<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>args[0].startswith(</highlight><highlight class="stringliteral">&apos;--&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>key,<sp/>value<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1ac22132e1b94b3df1fcae5765f5cbacbf" kindref="member">readoption</ref>(args)</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>key:</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Option<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>value<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>not<sp/>recognized&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>value:</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Option<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>key<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>needs<sp/>a<sp/>value&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>setattr(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1a8aa2bd3627070736471cbd9e786e41f5" kindref="member">options</ref>,<sp/>key,<sp/>value)</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="558"><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1ac22132e1b94b3df1fcae5765f5cbacbf" kindref="member">readoption</ref>(self,<sp/>args):</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>the<sp/>key<sp/>and<sp/>value<sp/>for<sp/>an<sp/>option&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arg<sp/>=<sp/>args[0][2:]</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>args[0]</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;=&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>arg:</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>key<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1a0cb05ef59bd1c58d9cf5f1bf7de222be" kindref="member">readequalskey</ref>(arg,<sp/>args)</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>key<sp/>=<sp/>arg.replace(</highlight><highlight class="stringliteral">&apos;-&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>hasattr(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1a8aa2bd3627070736471cbd9e786e41f5" kindref="member">options</ref>,<sp/>key):</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>key</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current<sp/>=<sp/>getattr(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1a8aa2bd3627070736471cbd9e786e41f5" kindref="member">options</ref>,<sp/>key)</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(current,<sp/>bool):</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>key,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>read<sp/>value</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(args)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>key,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>args[0].startswith(</highlight><highlight class="stringliteral">&apos;&quot;&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>initial<sp/>=<sp/>args[0]</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>args[0]</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>key,<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1ad7980923b60d0bbeffcdd9b2bc36262f" kindref="member">readquoted</ref>(args,<sp/>initial)</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>args[0].decode(</highlight><highlight class="stringliteral">&apos;utf-8&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>args[0]</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(current,<sp/>list):</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current.append(value)</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>key,<sp/>current</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>key,<sp/>value</highlight></codeline>
<codeline lineno="585"><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1ad7980923b60d0bbeffcdd9b2bc36262f" kindref="member">readquoted</ref>(self,<sp/>args,<sp/>initial):</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>a<sp/>value<sp/>between<sp/>quotes&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Oops&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>initial[1:]</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>len(args)<sp/>&gt;<sp/>0<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>args[0].endswith(</highlight><highlight class="stringliteral">&apos;&quot;&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>args[0].startswith(</highlight><highlight class="stringliteral">&apos;--&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Appending<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>args[0])</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>args[0]</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>args[0]</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(args)<sp/>==<sp/>0<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>args[0].startswith(</highlight><highlight class="stringliteral">&apos;--&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>args[0:-1]</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>value</highlight></codeline>
<codeline lineno="598"><highlight class="normal"></highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser_1a0cb05ef59bd1c58d9cf5f1bf7de222be" kindref="member">readequalskey</ref>(self,<sp/>arg,<sp/>args):</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>a<sp/>key<sp/>using<sp/>equals&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>split<sp/>=<sp/>arg.split(</highlight><highlight class="stringliteral">&apos;=&apos;</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>key<sp/>=<sp/>split[0]</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>split[1]</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>args.insert(0,<sp/>value)</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>key</highlight></codeline>
<codeline lineno="606"><highlight class="normal"></highlight></codeline>
<codeline lineno="607"><highlight class="normal"></highlight></codeline>
<codeline lineno="608" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options" kindref="compound">Options</ref>:</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>set<sp/>of<sp/>runtime<sp/>options&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="610"><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/>location<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="612"><highlight class="normal"></highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/>debug<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/>quiet<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/>version<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/>help<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/>simplemath<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/>showlines<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"></highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/>branches<sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1a4a64e78d9d15c29d707a744c2c2a825f" kindref="member">parseoptions</ref>(self,<sp/>args):</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>command<sp/>line<sp/>options&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Options.location<sp/>=<sp/>args[0]</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>args[0]</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parser<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandLineParser" kindref="compound">CommandLineParser</ref>(Options)</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>parser.parseoptions(args)</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>result:</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(result)</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1acf2e3c907f45dcc5335fb0d87b526799" kindref="member">usage</ref>()</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1a75028246d841400f38c842d98fdfbc2d" kindref="member">processoptions</ref>()</highlight></codeline>
<codeline lineno="632"><highlight class="normal"></highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1a75028246d841400f38c842d98fdfbc2d" kindref="member">processoptions</ref>(self):</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Process<sp/>all<sp/>options<sp/>parsed.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>Options.help:</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1acf2e3c907f45dcc5335fb0d87b526799" kindref="member">usage</ref>()</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>Options.version:</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1aa8e270260c45209142029d3d14057998" kindref="member">showversion</ref>()</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>set<sp/>in<sp/>Trace<sp/>if<sp/>necessary</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>param<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>dir(Trace):</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>param.endswith(</highlight><highlight class="stringliteral">&apos;mode&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>setattr(Trace,<sp/>param,<sp/>getattr(self,<sp/>param[:-4]))</highlight></codeline>
<codeline lineno="643"><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1acf2e3c907f45dcc5335fb0d87b526799" kindref="member">usage</ref>(self):</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>correct<sp/>usage&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(f</highlight><highlight class="stringliteral">&apos;Usage:<sp/>{pathlib.Path(Options.location).parent}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;<sp/>[options]<sp/>&quot;input<sp/>string&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Convert<sp/>input<sp/>string<sp/>with<sp/>LaTeX<sp/>math<sp/>to<sp/>MathML&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1a88fa05913788d52178b39aa16a0d62fe" kindref="member">showoptions</ref>()</highlight></codeline>
<codeline lineno="650"><highlight class="normal"></highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1a88fa05913788d52178b39aa16a0d62fe" kindref="member">showoptions</ref>(self):</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>all<sp/>possible<sp/>options&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/>--help:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>show<sp/>this<sp/>online<sp/>help&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/>--quiet:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>disables<sp/>all<sp/>runtime<sp/>messages&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/>--debug:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>enable<sp/>debugging<sp/>messages<sp/>(for<sp/>developers)&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/>--version:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>show<sp/>version<sp/>number<sp/>and<sp/>release<sp/>date&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;<sp/><sp/><sp/><sp/>--simplemath:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>do<sp/>not<sp/>generate<sp/>fancy<sp/>math<sp/>constructions&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys.exit()</highlight></codeline>
<codeline lineno="659"><highlight class="normal"></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options_1aa8e270260c45209142029d3d14057998" kindref="member">showversion</ref>(self):</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>current<sp/>eLyXer<sp/>version<sp/>string&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;math2html<sp/>&apos;</highlight><highlight class="normal">+__version__)</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sys.exit()</highlight></codeline>
<codeline lineno="664"><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"></highlight></codeline>
<codeline lineno="666" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Cloner" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Cloner" kindref="compound">Cloner</ref>:</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;An<sp/>object<sp/>used<sp/>to<sp/>clone<sp/>other<sp/>objects.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Cloner_1a54b617b8c1217e0c00cb964c17be14c0" kindref="member">clone</ref>(cls,<sp/>original):</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>an<sp/>exact<sp/>copy<sp/>of<sp/>an<sp/>object.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>original<sp/>object<sp/>must<sp/>have<sp/>an<sp/>empty<sp/>constructor.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cls.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Cloner_1a9a638f992cddc70511f18d09c1c9a93b" kindref="member">create</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Cloner_1ae23cbff713e4f2360fad2aa5b0131e95" kindref="member">create</ref>(original.__class__)</highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Cloner_1a9a638f992cddc70511f18d09c1c9a93b" kindref="member">create</ref>(cls,<sp/>type):</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Create<sp/>an<sp/>object<sp/>of<sp/>a<sp/>given<sp/>class.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clone<sp/>=<sp/>type.__new__(type)</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clone.__init__()</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>clone</highlight></codeline>
<codeline lineno="679"><highlight class="normal"></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/>clone<sp/>=<sp/>classmethod(clone)</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/>create<sp/>=<sp/>classmethod(create)</highlight></codeline>
<codeline lineno="682"><highlight class="normal"></highlight></codeline>
<codeline lineno="683"><highlight class="normal"></highlight></codeline>
<codeline lineno="684" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor" kindref="compound">ContainerExtractor</ref>:</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>class<sp/>to<sp/>extract<sp/>certain<sp/>containers.</highlight></codeline>
<codeline lineno="686"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="687"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>config<sp/>parameter<sp/>is<sp/>a<sp/>map<sp/>containing<sp/>three<sp/>lists:</highlight></codeline>
<codeline lineno="688"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>allowed,<sp/>copied<sp/>and<sp/>extracted.</highlight></codeline>
<codeline lineno="689"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Each<sp/>of<sp/>the<sp/>three<sp/>is<sp/>a<sp/>list<sp/>of<sp/>class<sp/>names<sp/>for<sp/>containers.</highlight></codeline>
<codeline lineno="690"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Allowed<sp/>containers<sp/>are<sp/>included<sp/>as<sp/>is<sp/>into<sp/>the<sp/>result.</highlight></codeline>
<codeline lineno="691"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Cloned<sp/>containers<sp/>are<sp/>cloned<sp/>and<sp/>placed<sp/>into<sp/>the<sp/>result.</highlight></codeline>
<codeline lineno="692"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Extracted<sp/>containers<sp/>are<sp/>looked<sp/>into.</highlight></codeline>
<codeline lineno="693"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>All<sp/>other<sp/>containers<sp/>are<sp/>silently<sp/>ignored.</highlight></codeline>
<codeline lineno="694"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"></highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1a751688ddf23e3f31f9d2962acab32773" kindref="member">__init__</ref>(self,<sp/>config):</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1ae34f300855e821935bb0e98170e5bc89" kindref="member">allowed</ref><sp/>=<sp/>config[</highlight><highlight class="stringliteral">&apos;allowed&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1a471fb1e06ebcef9520bbf3bc4696a6a4" kindref="member">extracted</ref><sp/>=<sp/>config[</highlight><highlight class="stringliteral">&apos;extracted&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1a1d5e99c48593691bd6e4234c739ddff1" kindref="member">extract</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Extract<sp/>a<sp/>group<sp/>of<sp/>selected<sp/>containers<sp/>from<sp/>a<sp/>container.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>list<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>locate<sp/>=<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>c:<sp/>c.__class__.__name__<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1ae34f300855e821935bb0e98170e5bc89" kindref="member">allowed</ref></highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>recursive<sp/>=<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>c:<sp/>c.__class__.__name__<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1a471fb1e06ebcef9520bbf3bc4696a6a4" kindref="member">extracted</ref></highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>process<sp/>=<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>c:<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1a47af76f5e20c2fb0328e7f7467c7a4c8" kindref="member">process</ref>(c,<sp/>list)</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>container.recursivesearch(locate,<sp/>recursive,<sp/>process)</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>list</highlight></codeline>
<codeline lineno="708"><highlight class="normal"></highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1a47af76f5e20c2fb0328e7f7467c7a4c8" kindref="member">process</ref>(self,<sp/>container,<sp/>list):</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Add<sp/>allowed<sp/>containers.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/>container.__class__.__name__</highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>name<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1ae34f300855e821935bb0e98170e5bc89" kindref="member">allowed</ref>:</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>list.append(container)</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unknown<sp/>container<sp/>class<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>name)</highlight></codeline>
<codeline lineno="716"><highlight class="normal"></highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1ad7869fd3896c48bc5c1573d7464d484c" kindref="member">safeclone</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>new<sp/>container<sp/>with<sp/>contents<sp/>only<sp/>in<sp/>a<sp/>safe<sp/>list,<sp/>recursively.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clone<sp/>=<sp/>Cloner.clone(container)</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clone.output<sp/>=<sp/>container.output</highlight></codeline>
<codeline lineno="721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clone.contents<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor_1a1d5e99c48593691bd6e4234c739ddff1" kindref="member">extract</ref>(container)</highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>clone</highlight></codeline>
<codeline lineno="723"><highlight class="normal"></highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight></codeline>
<codeline lineno="725" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser" kindref="compound">Parser</ref>:</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>generic<sp/>parser&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a67eed22afbe2580c2565677eef101209" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a6fa6ae29da8216c3efcd08d37c0c0a8e" kindref="member">begin</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a0c73e76a0f09e152654b79124ecd7ec5" kindref="member">parameters</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="731"><highlight class="normal"></highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a0695e800c33c49beff2a2064b4586b9e" kindref="member">parseheader</ref>(self,<sp/>reader):</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>header&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>header<sp/>=<sp/>reader.currentline().split()</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a6fa6ae29da8216c3efcd08d37c0c0a8e" kindref="member">begin</ref><sp/>=<sp/>reader.linenumber</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>header</highlight></codeline>
<codeline lineno="738"><highlight class="normal"></highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1af5ab11cf25d2977b00931cf6b3442c94" kindref="member">parseparameter</ref>(self,<sp/>reader):</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>parameter&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>split<sp/>=<sp/>reader.currentline().strip().split(</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">,<sp/>1)</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(split)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>key<sp/>=<sp/>split[0]</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(split)<sp/>==<sp/>1:</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a0c73e76a0f09e152654b79124ecd7ec5" kindref="member">parameters</ref>[key]<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&quot;&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>split[1]:</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a0c73e76a0f09e152654b79124ecd7ec5" kindref="member">parameters</ref>[key]<sp/>=<sp/>split[1].strip()</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>doublesplit<sp/>=<sp/>split[1].split(</highlight><highlight class="stringliteral">&apos;&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a0c73e76a0f09e152654b79124ecd7ec5" kindref="member">parameters</ref>[key]<sp/>=<sp/>doublesplit[1]</highlight></codeline>
<codeline lineno="754"><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a1bf58ef1fa3ded99dd76746a48104930" kindref="member">parseending</ref>(self,<sp/>reader,<sp/>process):</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>until<sp/>the<sp/>current<sp/>ending<sp/>is<sp/>found&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1aac23f721a37b4943c90efecf7fd8254d" kindref="member">ending</ref>:</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;No<sp/>ending<sp/>for<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(self))</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>reader.currentline().startswith(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1aac23f721a37b4943c90efecf7fd8254d" kindref="member">ending</ref>):</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>process()</highlight></codeline>
<codeline lineno="762"><highlight class="normal"></highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a1808ed88d8b1b5d77e44b6bf8fe2bfb7" kindref="member">parsecontainer</ref>(self,<sp/>reader,<sp/>contents):</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>container<sp/>=<sp/>self.factory.createcontainer(reader)</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>container:</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>container.parent<sp/>=<sp/>self.parent</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents.append(container)</highlight></codeline>
<codeline lineno="768"><highlight class="normal"></highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1ad98615553ff7ff990d6fec288b5aaee7" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>description&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.__class__.__name__<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>(&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a6fa6ae29da8216c3efcd08d37c0c0a8e" kindref="member">begin</ref>)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;)&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"></highlight></codeline>
<codeline lineno="773"><highlight class="normal"></highlight></codeline>
<codeline lineno="774" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LoneCommand" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LoneCommand" kindref="compound">LoneCommand</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser" kindref="compound">Parser</ref>):</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>parser<sp/>for<sp/>just<sp/>one<sp/>command<sp/>line&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">parse(self,<sp/>reader):</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>nothing&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[]</highlight></codeline>
<codeline lineno="780"><highlight class="normal"></highlight></codeline>
<codeline lineno="781"><highlight class="normal"></highlight></codeline>
<codeline lineno="782" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser" kindref="compound">TextParser</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser" kindref="compound">Parser</ref>):</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>parser<sp/>for<sp/>a<sp/>command<sp/>and<sp/>a<sp/>bit<sp/>of<sp/>text&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="784"><highlight class="normal"></highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/>stack<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="786"><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1ac91ab07cc09f6d5a26512a13a05bfa77" kindref="member">__init__</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Parser.__init__(self)</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1aac23f721a37b4943c90efecf7fd8254d" kindref="member">ending</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1a0b04eceb67321709cacdb35ba6799898" kindref="member">ending</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>container.__class__.__name__<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>ContainerConfig.endings:</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1aac23f721a37b4943c90efecf7fd8254d" kindref="member">ending</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1a0b04eceb67321709cacdb35ba6799898" kindref="member">ending</ref><sp/>=<sp/>ContainerConfig.endings[container.__class__.__name__]</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1a891dcea0fc556c5aba7071fdb4456a3b" kindref="member">endings</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="793"><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">parse(self,<sp/>reader):</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>lines<sp/>as<sp/>long<sp/>as<sp/>they<sp/>are<sp/>text&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TextParser.stack.append(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1aac23f721a37b4943c90efecf7fd8254d" kindref="member">ending</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1a0b04eceb67321709cacdb35ba6799898" kindref="member">ending</ref>)</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1a891dcea0fc556c5aba7071fdb4456a3b" kindref="member">endings</ref><sp/>=<sp/>TextParser.stack<sp/>+<sp/>[ContainerConfig.endings[</highlight><highlight class="stringliteral">&apos;Layout&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ContainerConfig.endings[</highlight><highlight class="stringliteral">&apos;Inset&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1aac23f721a37b4943c90efecf7fd8254d" kindref="member">ending</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1a0b04eceb67321709cacdb35ba6799898" kindref="member">ending</ref>]</highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1ad2fa3bb64b0795712729a574f5552294" kindref="member">isending</ref>(reader):</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a1808ed88d8b1b5d77e44b6bf8fe2bfb7" kindref="member">parsecontainer</ref>(reader,<sp/>contents)</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>contents</highlight></codeline>
<codeline lineno="804"><highlight class="normal"></highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1ad2fa3bb64b0795712729a574f5552294" kindref="member">isending</ref>(self,<sp/>reader):</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>if<sp/>text<sp/>is<sp/>ending&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current<sp/>=<sp/>reader.currentline().split()</highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(current)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>current[0]<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextParser_1a891dcea0fc556c5aba7071fdb4456a3b" kindref="member">endings</ref>:</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>current[0]<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>TextParser.stack:</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TextParser.stack.remove(current[0])</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>TextParser.stack<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"></highlight></codeline>
<codeline lineno="818"><highlight class="normal"></highlight></codeline>
<codeline lineno="819" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ExcludingParser" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ExcludingParser" kindref="compound">ExcludingParser</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser" kindref="compound">Parser</ref>):</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>parser<sp/>that<sp/>excludes<sp/>the<sp/>final<sp/>line&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="821"><highlight class="normal"></highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">parse(self,<sp/>reader):</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>everything<sp/>up<sp/>to<sp/>(and<sp/>excluding)<sp/>the<sp/>final<sp/>line&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a1bf58ef1fa3ded99dd76746a48104930" kindref="member">parseending</ref>(reader,<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a1808ed88d8b1b5d77e44b6bf8fe2bfb7" kindref="member">parsecontainer</ref>(reader,<sp/>contents))</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>contents</highlight></codeline>
<codeline lineno="827"><highlight class="normal"></highlight></codeline>
<codeline lineno="828"><highlight class="normal"></highlight></codeline>
<codeline lineno="829" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BoundedParser" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BoundedParser" kindref="compound">BoundedParser</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ExcludingParser" kindref="compound">ExcludingParser</ref>):</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>parser<sp/>bound<sp/>by<sp/>a<sp/>final<sp/>line&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"></highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">parse(self,<sp/>reader):</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>everything,<sp/>including<sp/>the<sp/>final<sp/>line&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents<sp/>=<sp/>ExcludingParser.parse(self,<sp/>reader)</highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>skip<sp/>last<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>contents</highlight></codeline>
<codeline lineno="838"><highlight class="normal"></highlight></codeline>
<codeline lineno="839"><highlight class="normal"></highlight></codeline>
<codeline lineno="840" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BoundedDummy" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BoundedDummy" kindref="compound">BoundedDummy</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser" kindref="compound">Parser</ref>):</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>bound<sp/>parser<sp/>that<sp/>ignores<sp/>everything&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="842"><highlight class="normal"></highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">parse(self,<sp/>reader):</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>contents<sp/>of<sp/>the<sp/>container&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a1bf58ef1fa3ded99dd76746a48104930" kindref="member">parseending</ref>(reader,<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal">:<sp/>reader.nextline())</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>skip<sp/>last<sp/>line</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[]</highlight></codeline>
<codeline lineno="849"><highlight class="normal"></highlight></codeline>
<codeline lineno="850"><highlight class="normal"></highlight></codeline>
<codeline lineno="851" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringParser" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringParser" kindref="compound">StringParser</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser" kindref="compound">Parser</ref>):</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parses<sp/>just<sp/>a<sp/>string&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="853"><highlight class="normal"></highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringParser_1a96626d46911e6b79e60a5202de36166d" kindref="member">parseheader</ref>(self,<sp/>reader):</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Do<sp/>nothing,<sp/>just<sp/>take<sp/>note&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a6fa6ae29da8216c3efcd08d37c0c0a8e" kindref="member">begin</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringParser_1acdc2b1a32b1b155b1938dadf61f7297e" kindref="member">begin</ref><sp/>=<sp/>reader.linenumber<sp/>+<sp/>1</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[]</highlight></codeline>
<codeline lineno="858"><highlight class="normal"></highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">parse(self,<sp/>reader):</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>single<sp/>line&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents<sp/>=<sp/>reader.currentline()</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>contents</highlight></codeline>
<codeline lineno="864"><highlight class="normal"></highlight></codeline>
<codeline lineno="865"><highlight class="normal"></highlight></codeline>
<codeline lineno="866" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerOutput" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerOutput" kindref="compound">ContainerOutput</ref>:</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>generic<sp/>HTML<sp/>output<sp/>for<sp/>a<sp/>container.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"></highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerOutput_1a8c6acaf46ed1e33e1ee55561c31be1d6" kindref="member">gethtml</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>an<sp/>error.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;gethtml()<sp/>not<sp/>implemented<sp/>for<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(self))</highlight></codeline>
<codeline lineno="872"><highlight class="normal"></highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerOutput_1a8f3a3d7c377a4d70df504d3e37f662b4" kindref="member">isempty</ref>(self):</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Decide<sp/>if<sp/>the<sp/>output<sp/>is<sp/>empty:<sp/>by<sp/>default,<sp/>not<sp/>empty.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="876"><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal"></highlight></codeline>
<codeline lineno="878" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyOutput" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyOutput" kindref="compound">EmptyOutput</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerOutput" kindref="compound">ContainerOutput</ref>):</highlight></codeline>
<codeline lineno="879"><highlight class="normal"></highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyOutput_1a9123bfb43b6a5fe6920d61c0a0c839de" kindref="member">gethtml</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>empty<sp/>HTML<sp/>code.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[]</highlight></codeline>
<codeline lineno="883"><highlight class="normal"></highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyOutput_1a06ff5756fc730615fa393104acebe910" kindref="member">isempty</ref>(self):</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;This<sp/>output<sp/>is<sp/>particularly<sp/>empty.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"></highlight></codeline>
<codeline lineno="888"><highlight class="normal"></highlight></codeline>
<codeline lineno="889" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FixedOutput" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FixedOutput" kindref="compound">FixedOutput</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerOutput" kindref="compound">ContainerOutput</ref>):</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Fixed<sp/>output&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="891"><highlight class="normal"></highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FixedOutput_1aebbb9479e0f01be8ce44916f8429cb01" kindref="member">gethtml</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>constant<sp/>HTML<sp/>code&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>container.html</highlight></codeline>
<codeline lineno="895"><highlight class="normal"></highlight></codeline>
<codeline lineno="896"><highlight class="normal"></highlight></codeline>
<codeline lineno="897" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput" kindref="compound">ContentsOutput</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerOutput" kindref="compound">ContainerOutput</ref>):</highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Outputs<sp/>the<sp/>contents<sp/>converted<sp/>to<sp/>HTML&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="899"><highlight class="normal"></highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput_1a14c010a762132238eb965be4a7599172" kindref="member">gethtml</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>HTML<sp/>code&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>html<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>container.contents<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>html</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>container.contents:</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>hasattr(element,<sp/></highlight><highlight class="stringliteral">&apos;gethtml&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;No<sp/>html<sp/>in<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>element.__class__.__name__<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(element))</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>html</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>html<sp/>+=<sp/>element.gethtml()</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>html</highlight></codeline>
<codeline lineno="911"><highlight class="normal"></highlight></codeline>
<codeline lineno="912"><highlight class="normal"></highlight></codeline>
<codeline lineno="913" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput" kindref="compound">ContentsOutput</ref>):</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Outputs<sp/>an<sp/>HTML<sp/>tag<sp/>surrounding<sp/>the<sp/>contents.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"></highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/>tag<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/>breaklines<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/>empty<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="919"><highlight class="normal"></highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1aff4e5e318df92e004b4bb21f814a148b" kindref="member">settag</ref>(self,<sp/>tag,<sp/>breaklines=False,<sp/>empty=False):</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>value<sp/>for<sp/>the<sp/>tag<sp/>and<sp/>other<sp/>attributes.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a526458b9df4b3a38a75dca8e67219e89" kindref="member">tag</ref><sp/>=<sp/>tag</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>breaklines:</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1aec1585fcb96cf4304cef7fd7417dfc29" kindref="member">breaklines</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1afab4895eec31f804cd8c7907c505e18f" kindref="member">breaklines</ref><sp/>=<sp/>breaklines</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>empty:</highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a975ce76550e3d48444e41a1e83468e54" kindref="member">empty</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a0588a7bcc4abad4cdac9f69bc664689a" kindref="member">empty</ref><sp/>=<sp/>empty</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="928"><highlight class="normal"></highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1ad6ec4b4573fe39e885a5cd4c11b24c8d" kindref="member">setbreaklines</ref>(self,<sp/>breaklines):</highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>value<sp/>for<sp/>breaklines.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1aec1585fcb96cf4304cef7fd7417dfc29" kindref="member">breaklines</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1afab4895eec31f804cd8c7907c505e18f" kindref="member">breaklines</ref><sp/>=<sp/>breaklines</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="933"><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a6c4c8c5db4eae774d720a8093245192e" kindref="member">gethtml</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>HTML<sp/>code.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a975ce76550e3d48444e41a1e83468e54" kindref="member">empty</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a0588a7bcc4abad4cdac9f69bc664689a" kindref="member">empty</ref>:</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1abf782e8688b557503bad6fc90861d7f7" kindref="member">selfclosing</ref>(container)]</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>html<sp/>=<sp/>[self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a8c5fd0107a4792db002f5295990d7577" kindref="member">open</ref>(container)]</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>html<sp/>+=<sp/>ContentsOutput.gethtml(self,<sp/>container)</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>html.append(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a6a7ce1f9d9f7bb702689035eb42de7b4" kindref="member">close</ref>(container))</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>html</highlight></codeline>
<codeline lineno="942"><highlight class="normal"></highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">open(self,<sp/>container):</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>opening<sp/>line.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a1aa62e0b081132e316ee7806bce042ab" kindref="member">checktag</ref>(container):</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>open<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a526458b9df4b3a38a75dca8e67219e89" kindref="member">tag</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&gt;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1aec1585fcb96cf4304cef7fd7417dfc29" kindref="member">breaklines</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1afab4895eec31f804cd8c7907c505e18f" kindref="member">breaklines</ref>:</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>open<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>open</highlight></codeline>
<codeline lineno="951"><highlight class="normal"></highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a6a7ce1f9d9f7bb702689035eb42de7b4" kindref="member">close</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>closing<sp/>line.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a1aa62e0b081132e316ee7806bce042ab" kindref="member">checktag</ref>(container):</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>close<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;/&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a526458b9df4b3a38a75dca8e67219e89" kindref="member">tag</ref>.split()[0]<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&gt;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1aec1585fcb96cf4304cef7fd7417dfc29" kindref="member">breaklines</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1afab4895eec31f804cd8c7907c505e18f" kindref="member">breaklines</ref>:</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal"><sp/>+<sp/>close<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>close</highlight></codeline>
<codeline lineno="960"><highlight class="normal"></highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1abf782e8688b557503bad6fc90861d7f7" kindref="member">selfclosing</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>self-closing<sp/>line.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a1aa62e0b081132e316ee7806bce042ab" kindref="member">checktag</ref>(container):</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selfclosing<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&lt;&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a526458b9df4b3a38a75dca8e67219e89" kindref="member">tag</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&apos;/&gt;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1aec1585fcb96cf4304cef7fd7417dfc29" kindref="member">breaklines</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1afab4895eec31f804cd8c7907c505e18f" kindref="member">breaklines</ref>:</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>selfclosing<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>selfclosing</highlight></codeline>
<codeline lineno="969"><highlight class="normal"></highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a1aa62e0b081132e316ee7806bce042ab" kindref="member">checktag</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>that<sp/>the<sp/>tag<sp/>is<sp/>valid.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a526458b9df4b3a38a75dca8e67219e89" kindref="member">tag</ref>:</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;No<sp/>tag<sp/>in<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(container))</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput_1a526458b9df4b3a38a75dca8e67219e89" kindref="member">tag</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="978"><highlight class="normal"></highlight></codeline>
<codeline lineno="979"><highlight class="normal"></highlight></codeline>
<codeline lineno="980" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput" kindref="compound">FilteredOutput</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput" kindref="compound">ContentsOutput</ref>):</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Returns<sp/>the<sp/>output<sp/>in<sp/>the<sp/>contents,<sp/>but<sp/>filtered:&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;some<sp/>strings<sp/>are<sp/>replaced<sp/>by<sp/>others.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="983"><highlight class="normal"></highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput_1a6733314e80a91e188def05580c5e764a" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Initialize<sp/>the<sp/>filters.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput_1af4412cae48885bb448f299f3a44dc08b" kindref="member">filters</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="987"><highlight class="normal"></highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput_1abc9b69bd942202ba216b3e824dbdb48c" kindref="member">addfilter</ref>(self,<sp/>original,<sp/>replacement):</highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Add<sp/>a<sp/>new<sp/>filter:<sp/>replace<sp/>the<sp/>original<sp/>by<sp/>the<sp/>replacement.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput_1af4412cae48885bb448f299f3a44dc08b" kindref="member">filters</ref>.append((original,<sp/>replacement))</highlight></codeline>
<codeline lineno="991"><highlight class="normal"></highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput_1a27c370dbed13974d7c4c80cfff2851bc" kindref="member">gethtml</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>HTML<sp/>code&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>html<sp/>=<sp/>ContentsOutput.gethtml(self,<sp/>container)</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>line<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>html:</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.append(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput_1a28e3dc48b521439f21fb645685620b5e" kindref="member">filter</ref>(line))</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result</highlight></codeline>
<codeline lineno="999"><highlight class="normal"></highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">filter(self,<sp/>line):</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Filter<sp/>a<sp/>single<sp/>line<sp/>with<sp/>all<sp/>available<sp/>filters.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>original,<sp/>replacement<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FilteredOutput_1af4412cae48885bb448f299f3a44dc08b" kindref="member">filters</ref>:</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>original<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>line:</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>line.replace(original,<sp/>replacement)</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>line</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"></highlight></codeline>
<codeline lineno="1007"><highlight class="normal"></highlight></codeline>
<codeline lineno="1008" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringOutput" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringOutput" kindref="compound">StringOutput</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerOutput" kindref="compound">ContainerOutput</ref>):</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Returns<sp/>a<sp/>bare<sp/>string<sp/>as<sp/>output&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1010"><highlight class="normal"></highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringOutput_1a5fa351716af16597c25950bf874c976a" kindref="member">gethtml</ref>(self,<sp/>container):</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>bare<sp/>string&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[container.string]</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"></highlight></codeline>
<codeline lineno="1015"><highlight class="normal"></highlight></codeline>
<codeline lineno="1016" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable" kindref="compound">Globable</ref>:</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>bit<sp/>of<sp/>text<sp/>which<sp/>can<sp/>be<sp/>globbed<sp/>(lumped<sp/>together<sp/>in<sp/>bits).</highlight></codeline>
<codeline lineno="1018"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Methods<sp/>current(),<sp/>skipcurrent(),<sp/>checkfor()<sp/>and<sp/>isout()<sp/>have<sp/>to<sp/>be</highlight></codeline>
<codeline lineno="1019"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>implemented<sp/>by<sp/>subclasses.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"></highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/>leavepending<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1022"><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a9633a07962ef68e667d2aa6f4ab769ad" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a0d5611bf83db61b7f7854d7643e3fefd" kindref="member">endinglist</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList" kindref="compound">EndingList</ref>()</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1af0e4c0bcd01c1f0a2b1f52891d868207" kindref="member">checkbytemark</ref>(self):</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>for<sp/>a<sp/>Unicode<sp/>byte<sp/>mark<sp/>and<sp/>skip<sp/>it.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a932dee23c022871133787cea12e9ed36" kindref="member">finished</ref>():</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ord(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>())<sp/>==<sp/>0xfeff:</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a6043af5f20355ef91ec720c5c65b09c7" kindref="member">skipcurrent</ref>()</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"></highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1ab710f94237b7e835c89d70eaba762aae" kindref="member">isout</ref>(self):</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>out<sp/>if<sp/>we<sp/>are<sp/>out<sp/>of<sp/>the<sp/>position<sp/>yet.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unimplemented<sp/>isout()&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1037"><highlight class="normal"></highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>(self):</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>current<sp/>character.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unimplemented<sp/>current()&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1042"><highlight class="normal"></highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a2af7eadd16b96506f68f6838765d0e8b" kindref="member">checkfor</ref>(self,<sp/>string):</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>for<sp/>the<sp/>given<sp/>string<sp/>in<sp/>the<sp/>current<sp/>position.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unimplemented<sp/>checkfor()&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"></highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a932dee23c022871133787cea12e9ed36" kindref="member">finished</ref>(self):</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>out<sp/>if<sp/>the<sp/>current<sp/>text<sp/>has<sp/>finished.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1ab710f94237b7e835c89d70eaba762aae" kindref="member">isout</ref>():</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1ac424bdf54effd0d45439077dc88179a8" kindref="member">leavepending</ref>:</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a0d5611bf83db61b7f7854d7643e3fefd" kindref="member">endinglist</ref>.checkpending()</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a0d5611bf83db61b7f7854d7643e3fefd" kindref="member">endinglist</ref>.checkin(self)</highlight></codeline>
<codeline lineno="1055"><highlight class="normal"></highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a6043af5f20355ef91ec720c5c65b09c7" kindref="member">skipcurrent</ref>(self):</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>current<sp/>character<sp/>and<sp/>skip<sp/>it.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unimplemented<sp/>skipcurrent()&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1060"><highlight class="normal"></highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">glob(self,<sp/>currentcheck):</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Glob<sp/>a<sp/>bit<sp/>of<sp/>text<sp/>that<sp/>satisfies<sp/>a<sp/>check<sp/>on<sp/>the<sp/>current<sp/>char.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>glob<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a932dee23c022871133787cea12e9ed36" kindref="member">finished</ref>()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>currentcheck():</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>glob<sp/>+=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a6043af5f20355ef91ec720c5c65b09c7" kindref="member">skipcurrent</ref>()</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>glob</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"></highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a887219ea972bee1bb05e2bbfa7950747" kindref="member">globalpha</ref>(self):</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Glob<sp/>a<sp/>bit<sp/>of<sp/>alpha<sp/>text&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a007bd009e001047865e0068adeb21aa9" kindref="member">glob</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>().isalpha())</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"></highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a22d2ee3833d969bc63ac809b1c1848a9" kindref="member">globnumber</ref>(self):</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Glob<sp/>a<sp/>row<sp/>of<sp/>digits.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a007bd009e001047865e0068adeb21aa9" kindref="member">glob</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>().isdigit())</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"></highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a7f044614fe5a69f6647e0a0e1bba2288" kindref="member">isidentifier</ref>(self):</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>if<sp/>the<sp/>current<sp/>character<sp/>is<sp/>alphanumeric<sp/>or<sp/>_.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>().isalnum()<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>()<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;_&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1081"><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1ac0b4049f9a49a0cd9233bb06f844aec5" kindref="member">globidentifier</ref>(self):</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Glob<sp/>alphanumeric<sp/>and<sp/>_<sp/>symbols.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a007bd009e001047865e0068adeb21aa9" kindref="member">glob</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a7f044614fe5a69f6647e0a0e1bba2288" kindref="member">isidentifier</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1af8e7984d73466037898e937436985aca" kindref="member">isidentifier</ref>)</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"></highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1aa5651e1f1d2603dda03f069edc7c0a1e" kindref="member">isvalue</ref>(self):</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>if<sp/>the<sp/>current<sp/>character<sp/>is<sp/>a<sp/>value<sp/>character:&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;not<sp/>a<sp/>bracket<sp/>or<sp/>a<sp/>space.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>().isspace():</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>()<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;{}()&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1094"><highlight class="normal"></highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1ab0231d3a08f648ae04443965fb99693f" kindref="member">globvalue</ref>(self):</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Glob<sp/>a<sp/>value:<sp/>any<sp/>symbols<sp/>but<sp/>brackets.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a007bd009e001047865e0068adeb21aa9" kindref="member">glob</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1aa5651e1f1d2603dda03f069edc7c0a1e" kindref="member">isvalue</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a7c0825a454d90ef491f3a62b6dc020fe" kindref="member">isvalue</ref>)</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"></highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a040be1ccd2efd00e0be36d2de3117070" kindref="member">skipspace</ref>(self):</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Skip<sp/>all<sp/>whitespace<sp/>at<sp/>current<sp/>position.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a007bd009e001047865e0068adeb21aa9" kindref="member">glob</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>().isspace())</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"></highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1aec457b464dec3dd7f4ebd8f259dfb9bf" kindref="member">globincluding</ref>(self,<sp/>magicchar):</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Glob<sp/>a<sp/>bit<sp/>of<sp/>text<sp/>up<sp/>to<sp/>(including)<sp/>the<sp/>magic<sp/>char.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>glob<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a007bd009e001047865e0068adeb21aa9" kindref="member">glob</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>()<sp/>!=<sp/>magicchar)<sp/>+<sp/>magicchar</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.skip(magicchar)</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>glob</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"></highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1aaa84b1cf1eb23fbe81c0b0374a3f19d2" kindref="member">globexcluding</ref>(self,<sp/>excluded):</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Glob<sp/>a<sp/>bit<sp/>of<sp/>text<sp/>up<sp/>until<sp/>(excluding)<sp/>any<sp/>excluded<sp/>character.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a007bd009e001047865e0068adeb21aa9" kindref="member">glob</ref>(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal">:<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>()<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>excluded)</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"></highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a8d593e66e8f19043a8d5ddc8ce26afd6" kindref="member">pushending</ref>(self,<sp/>ending,<sp/>optional=False):</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Push<sp/>a<sp/>new<sp/>ending<sp/>to<sp/>the<sp/>bottom&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a0d5611bf83db61b7f7854d7643e3fefd" kindref="member">endinglist</ref>.add(ending,<sp/>optional)</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"></highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1d560cc851216dd07feeb65fcdf64ca9" kindref="member">popending</ref>(self,<sp/>expected=None):</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Pop<sp/>the<sp/>ending<sp/>found<sp/>at<sp/>the<sp/>current<sp/>position&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1ab710f94237b7e835c89d70eaba762aae" kindref="member">isout</ref>()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1ac424bdf54effd0d45439077dc88179a8" kindref="member">leavepending</ref>:</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>expected</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ending<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a0d5611bf83db61b7f7854d7643e3fefd" kindref="member">endinglist</ref>.pop(self)</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>expected<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>expected<sp/>!=<sp/>ending:</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Expected<sp/>ending<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>expected<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>got<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>ending)</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.skip(ending)</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ending</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"></highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a3c9e80a0d2d1b287afb1198e441a6d3c" kindref="member">nextending</ref>(self):</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>next<sp/>ending<sp/>in<sp/>the<sp/>queue.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nextending<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a0d5611bf83db61b7f7854d7643e3fefd" kindref="member">endinglist</ref>.findending(self)</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>nextending:</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nextending.ending</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"></highlight></codeline>
<codeline lineno="1134"><highlight class="normal"></highlight></codeline>
<codeline lineno="1135" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList" kindref="compound">EndingList</ref>:</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>list<sp/>of<sp/>position<sp/>endings&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1137"><highlight class="normal"></highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1ad56fcfa462500d30edf4877bdc876bca" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"></highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a41b5558420b926c447926608c577496e" kindref="member">add</ref>(self,<sp/>ending,<sp/>optional=False):</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Add<sp/>a<sp/>new<sp/>ending<sp/>to<sp/>the<sp/>list&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref>.append(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding" kindref="compound">PositionEnding</ref>(ending,<sp/>optional))</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"></highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a7dee70b5c66fe221880b9d9b7eeff4f0" kindref="member">pickpending</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Pick<sp/>any<sp/>pending<sp/>endings<sp/>from<sp/>a<sp/>parse<sp/>position.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref><sp/>+=<sp/>pos.endinglist.endings</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"></highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1ae8f085de52542deb4a041327a2da4ff6" kindref="member">checkin</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Search<sp/>for<sp/>an<sp/>ending&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1ab2805438e6da5ac685e4cd37d6a6035d" kindref="member">findending</ref>(pos):</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1154"><highlight class="normal"></highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1aef0f9de0caba5a8820325f79fb3a4e7d" kindref="member">pop</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Remove<sp/>the<sp/>ending<sp/>at<sp/>the<sp/>current<sp/>position&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.isout():</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;No<sp/>ending<sp/>out<sp/>of<sp/>bounds&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ending<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1ab2805438e6da5ac685e4cd37d6a6035d" kindref="member">findending</ref>(pos)</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>ending:</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;No<sp/>ending<sp/>at<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.current())</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>each<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>reversed(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref>):</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref>.remove(each)</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>each<sp/>==<sp/>ending:</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>each.ending</highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>each.optional:</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Removed<sp/>non-optional<sp/>ending<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>each)</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;No<sp/>endings<sp/>left&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1172"><highlight class="normal"></highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1ab2805438e6da5ac685e4cd37d6a6035d" kindref="member">findending</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>the<sp/>ending<sp/>at<sp/>the<sp/>current<sp/>position&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref>)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>index,<sp/>ending<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(reversed(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref>)):</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ending.checkin(pos):</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ending</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>ending.optional:</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1183"><highlight class="normal"></highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a9c80f565dea484415d10f459c412fef2" kindref="member">checkpending</ref>(self):</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>if<sp/>there<sp/>are<sp/>any<sp/>pending<sp/>endings&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref>)<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Pending<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(self)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>left<sp/>open&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"></highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a3a359c04d15756851c86327b5539ef0a" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Printable<sp/>representation&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;endings<sp/>[&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>ending<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref>:</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>+=<sp/>str(ending)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;,&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EndingList_1a0fd1055d9e506f3310d0f02a4a97fe5b" kindref="member">endings</ref>)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>=<sp/>string[:-1]</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>string<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;]&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1197"><highlight class="normal"></highlight></codeline>
<codeline lineno="1198"><highlight class="normal"></highlight></codeline>
<codeline lineno="1199" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding" kindref="compound">PositionEnding</ref>:</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;An<sp/>ending<sp/>for<sp/>a<sp/>parsing<sp/>position&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1201"><highlight class="normal"></highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding_1ace18494be704f719b48d7e18e83cae22" kindref="member">__init__</ref>(self,<sp/>ending,<sp/>optional):</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding_1a1ef4fbae3e624c43b185a476a5a2c7e6" kindref="member">ending</ref><sp/>=<sp/>ending</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding_1af1afa2d430652c69b0861bf42a25f1c3" kindref="member">optional</ref><sp/>=<sp/>optional</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"></highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding_1a7490ea71a852e2a326c6b2cd96e67f11" kindref="member">checkin</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>for<sp/>the<sp/>ending&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pos.checkfor(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding_1a1ef4fbae3e624c43b185a476a5a2c7e6" kindref="member">ending</ref>)</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"></highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding_1a69622cd0e9578a79b1446aecdd4c4c5d" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Printable<sp/>representation&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Ending<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding_1a1ef4fbae3e624c43b185a476a5a2c7e6" kindref="member">ending</ref></highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1PositionEnding_1af1afa2d430652c69b0861bf42a25f1c3" kindref="member">optional</ref>:</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>string<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>(optional)&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>string</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"></highlight></codeline>
<codeline lineno="1217"><highlight class="normal"></highlight></codeline>
<codeline lineno="1218" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position" kindref="compound">Position</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable" kindref="compound">Globable</ref>):</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>position<sp/>in<sp/>a<sp/>text<sp/>to<sp/>parse.</highlight></codeline>
<codeline lineno="1220"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Including<sp/>those<sp/>in<sp/>Globable,<sp/>functions<sp/>to<sp/>implement<sp/>by<sp/>subclasses<sp/>are:</highlight></codeline>
<codeline lineno="1221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>skip(),<sp/>identifier(),<sp/>extract(),<sp/>isout()<sp/>and<sp/>current().&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1222"><highlight class="normal"></highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1aaf2c3f73dc11a16d20206bbefe22319f" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Globable.__init__(self)</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"></highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a3187dacc4093c1aa4ebf31f5e2ebb4f1" kindref="member">skip</ref>(self,<sp/>string):</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Skip<sp/>a<sp/>string&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unimplemented<sp/>skip()&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"></highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1af178ebac95464135b545ed57a45b826e" kindref="member">identifier</ref>(self):</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>an<sp/>identifier<sp/>for<sp/>the<sp/>current<sp/>position.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unimplemented<sp/>identifier()&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Error&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1234"><highlight class="normal"></highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a5cbe343db70374dc83ed8e46867301f7" kindref="member">extract</ref>(self,<sp/>length):</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Extract<sp/>the<sp/>next<sp/>string<sp/>of<sp/>the<sp/>given<sp/>length,<sp/>or<sp/>None<sp/>if<sp/>not<sp/>enough<sp/>text,&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;without<sp/>advancing<sp/>the<sp/>parse<sp/>position.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unimplemented<sp/>extract()&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1240"><highlight class="normal"></highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a01ef55bb9e22f8191d6dddf92094ff41" kindref="member">checkfor</ref>(self,<sp/>string):</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>for<sp/>a<sp/>string<sp/>at<sp/>the<sp/>given<sp/>position.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>string<sp/>==<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a5cbe343db70374dc83ed8e46867301f7" kindref="member">extract</ref>(len(string))</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"></highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a128a5ffe2e98d8047eac9cb9d0b1aca2" kindref="member">checkforlower</ref>(self,<sp/>string):</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>for<sp/>a<sp/>string<sp/>in<sp/>lower<sp/>case.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extracted<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a5cbe343db70374dc83ed8e46867301f7" kindref="member">extract</ref>(len(string))</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>extracted:</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>string.lower()<sp/>==<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a5cbe343db70374dc83ed8e46867301f7" kindref="member">extract</ref>(len(string)).lower()</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"></highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a89c6d5cc0686aff8d2614c5bc642b972" kindref="member">skipcurrent</ref>(self):</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>current<sp/>character<sp/>and<sp/>skip<sp/>it.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>()</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a3187dacc4093c1aa4ebf31f5e2ebb4f1" kindref="member">skip</ref>(current)</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>current</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"></highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1af55930e7cd8fc0df640fc529e14c918d" kindref="member">__next__</ref>(self):</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Advance<sp/>the<sp/>position<sp/>and<sp/>return<sp/>the<sp/>next<sp/>character.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a6043af5f20355ef91ec720c5c65b09c7" kindref="member">skipcurrent</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a89c6d5cc0686aff8d2614c5bc642b972" kindref="member">skipcurrent</ref>()</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a1185be5a51adc6eb12b36ec2fe072aa5" kindref="member">current</ref>()</highlight></codeline>
<codeline lineno="1262"><highlight class="normal"></highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a8d010cbd662f709541044823107c00a9" kindref="member">checkskip</ref>(self,<sp/>string):</highlight></codeline>
<codeline lineno="1264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>for<sp/>a<sp/>string<sp/>at<sp/>the<sp/>given<sp/>position;<sp/>if<sp/>there,<sp/>skip<sp/>it&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1a2af7eadd16b96506f68f6838765d0e8b" kindref="member">checkfor</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a01ef55bb9e22f8191d6dddf92094ff41" kindref="member">checkfor</ref>(string):</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1a3187dacc4093c1aa4ebf31f5e2ebb4f1" kindref="member">skip</ref>(string)</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"></highlight></codeline>
<codeline lineno="1270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">error(self,<sp/>message):</highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>an<sp/>error<sp/>message<sp/>and<sp/>the<sp/>position<sp/>identifier.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(message<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position_1af178ebac95464135b545ed57a45b826e" kindref="member">identifier</ref>())</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"></highlight></codeline>
<codeline lineno="1274"><highlight class="normal"></highlight></codeline>
<codeline lineno="1275" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition" kindref="compound">TextPosition</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Position" kindref="compound">Position</ref>):</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>parse<sp/>position<sp/>based<sp/>on<sp/>a<sp/>raw<sp/>text.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1277"><highlight class="normal"></highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1a9b2c325dcf55e0f3c5479743f0ae3e4f" kindref="member">__init__</ref>(self,<sp/>text):</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Create<sp/>the<sp/>position<sp/>from<sp/>some<sp/>text.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Position.__init__(self)</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref><sp/>=<sp/>0</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1aa01b01bc03841ce2d7542115f92de0cd" kindref="member">text</ref><sp/>=<sp/>text</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Globable_1af0e4c0bcd01c1f0a2b1f52891d868207" kindref="member">checkbytemark</ref>()</highlight></codeline>
<codeline lineno="1284"><highlight class="normal"></highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1a4815be547b043346f8c16979d54aef89" kindref="member">skip</ref>(self,<sp/>string):</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Skip<sp/>a<sp/>string<sp/>of<sp/>characters.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref><sp/>+=<sp/>len(string)</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"></highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1a0d1eb7b4c9868619dbfd7e49f58ef0d8" kindref="member">identifier</ref>(self):</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>sample<sp/>of<sp/>the<sp/>remaining<sp/>text.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>length<sp/>=<sp/>30</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref><sp/>+<sp/>length<sp/>&gt;<sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1aa01b01bc03841ce2d7542115f92de0cd" kindref="member">text</ref>):</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>length<sp/>=<sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1aa01b01bc03841ce2d7542115f92de0cd" kindref="member">text</ref>)<sp/>-<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref></highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1aa01b01bc03841ce2d7542115f92de0cd" kindref="member">text</ref>[self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref>:self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref><sp/>+<sp/>length]<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1295"><highlight class="normal"></highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1a7bfeedac934f3fc67f85a4c60e4e452b" kindref="member">isout</ref>(self):</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>out<sp/>if<sp/>we<sp/>are<sp/>out<sp/>of<sp/>the<sp/>text<sp/>yet.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref><sp/>&gt;=<sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1aa01b01bc03841ce2d7542115f92de0cd" kindref="member">text</ref>)</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"></highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1a253f483b23930519f03316ae14f408fb" kindref="member">current</ref>(self):</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>current<sp/>character,<sp/>assuming<sp/>we<sp/>are<sp/>not<sp/>out.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1aa01b01bc03841ce2d7542115f92de0cd" kindref="member">text</ref>[self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref>]</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"></highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1a406faaea5f60f6a9b29fe1c42de642f7" kindref="member">extract</ref>(self,<sp/>length):</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Extract<sp/>the<sp/>next<sp/>string<sp/>of<sp/>the<sp/>given<sp/>length,<sp/>or<sp/>None<sp/>if<sp/>not<sp/>enough<sp/>text.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref><sp/>+<sp/>length<sp/>&gt;<sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1aa01b01bc03841ce2d7542115f92de0cd" kindref="member">text</ref>):</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1aa01b01bc03841ce2d7542115f92de0cd" kindref="member">text</ref>[self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref><sp/>:<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition_1ac7bd9c9dc27b08ea0130056bcdded7ef" kindref="member">pos</ref><sp/>+<sp/>length]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>noqa:<sp/>E203</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1309"><highlight class="normal"></highlight></codeline>
<codeline lineno="1310"><highlight class="normal"></highlight></codeline>
<codeline lineno="1311" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container" kindref="compound">Container</ref>:</highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>container<sp/>for<sp/>text<sp/>and<sp/>objects<sp/>in<sp/>a<sp/>lyx<sp/>file&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1313"><highlight class="normal"></highlight></codeline>
<codeline lineno="1314"><highlight class="normal"><sp/><sp/><sp/><sp/>partkey<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/>parent<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/>begin<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1317"><highlight class="normal"></highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1ab01f78badd7c9177cdcd43b7830d0b1b" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><sp/>=<sp/>list()</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"></highlight></codeline>
<codeline lineno="1321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a2c0590f54bb156dd853be8fdc1bd3c48" kindref="member">process</ref>(self):</highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Process<sp/>contents&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">pass</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1324"><highlight class="normal"></highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a6edc2d2b803e89aa78b788cda4205222" kindref="member">gethtml</ref>(self):</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>resulting<sp/>HTML&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>html<sp/>=<sp/>self.output.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a6edc2d2b803e89aa78b788cda4205222" kindref="member">gethtml</ref>(self)</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(html,<sp/>str):</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Raw<sp/>string<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>html)</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>html<sp/>=<sp/>[html]</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>html</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"></highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">escape(self,<sp/>line,<sp/>replacements=EscapeConfig.entities):</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Escape<sp/>a<sp/>line<sp/>with<sp/>replacements<sp/>from<sp/>a<sp/>map&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pieces<sp/>=<sp/>sorted(replacements.keys())</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>do<sp/>them<sp/>in<sp/>order</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>piece<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>pieces:</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>piece<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>line:</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>line.replace(piece,<sp/>replacements[piece])</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>line</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"></highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a24d97a0bf5695b42e84973a03dde36a6" kindref="member">escapeentities</ref>(self,<sp/>line):</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Escape<sp/>all<sp/>Unicode<sp/>characters<sp/>to<sp/>HTML<sp/>entities.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos<sp/>=<sp/>TextPosition(line)</highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ord(pos.current())<sp/>&gt;<sp/>128:</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>codepoint<sp/>=<sp/>hex(ord(pos.current()))</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>codepoint<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;0xd835&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>codepoint<sp/>=<sp/>hex(ord(next(pos))<sp/>+<sp/>0xf800)</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&amp;#&apos;</highlight><highlight class="normal"><sp/>+<sp/>codepoint[1:]<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/>pos.current()</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.skipcurrent()</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"></highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a6a53cb9cb77fab93b95db1d4ae1897a3" kindref="member">searchall</ref>(self,<sp/>type):</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Search<sp/>for<sp/>all<sp/>embedded<sp/>containers<sp/>of<sp/>a<sp/>given<sp/>type&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>list<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.searchprocess(type,<sp/></highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>container:<sp/>list.append(container))</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>list</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"></highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1ab51939e27885a85e2086815c0fe33ed2" kindref="member">searchremove</ref>(self,<sp/>type):</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Search<sp/>for<sp/>all<sp/>containers<sp/>of<sp/>a<sp/>type<sp/>and<sp/>remove<sp/>them&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>list<sp/>=<sp/>self.searchall(type)</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>container<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>list:</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>container.parent.contents.remove(container)</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>list</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"></highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a9b177c66ba757e6ee140cb1705b22fb4" kindref="member">searchprocess</ref>(self,<sp/>type,<sp/>process):</highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Search<sp/>for<sp/>elements<sp/>of<sp/>a<sp/>given<sp/>type<sp/>and<sp/>process<sp/>them&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.locateprocess(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal"><sp/>container:<sp/>isinstance(container,<sp/>type),<sp/>process)</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"></highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a12fd5f0cfa3f20257b89b91dd76b9841" kindref="member">locateprocess</ref>(self,<sp/>locate,<sp/>process):</highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Search<sp/>for<sp/>all<sp/>embedded<sp/>containers<sp/>and<sp/>process<sp/>them&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>container<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.contents:</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>container.locateprocess(locate,<sp/>process)</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>locate(container):</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a2c0590f54bb156dd853be8fdc1bd3c48" kindref="member">process</ref>(container)</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"></highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a1ec3782072718d3d5aebcc0d735085d9" kindref="member">recursivesearch</ref>(self,<sp/>locate,<sp/>recursive,<sp/>process):</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Perform<sp/>a<sp/>recursive<sp/>search<sp/>in<sp/>the<sp/>container.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>container<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.contents:</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>recursive(container):</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>container.recursivesearch(locate,<sp/>recursive,<sp/>process)</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>locate(container):</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a2c0590f54bb156dd853be8fdc1bd3c48" kindref="member">process</ref>(container)</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"></highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1afc1e613f01bb95c12e985e76a5876a9e" kindref="member">extracttext</ref>(self):</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Extract<sp/>all<sp/>text<sp/>from<sp/>allowed<sp/>containers.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>constants<sp/>=<sp/>ContainerExtractor(ContainerConfig.extracttext).extract(self)</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">.join(constant.string<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>constant<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>constants)</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"></highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">group(self,<sp/>index,<sp/>group,<sp/>isingroup):</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Group<sp/>some<sp/>adjoining<sp/>elements<sp/>into<sp/>a<sp/>group&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>index<sp/>&gt;=<sp/>len(self.contents):</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(self.contents[index],<sp/></highlight><highlight class="stringliteral">&apos;grouped&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>index<sp/>&lt;<sp/>len(self.contents)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>isingroup(self.contents[index]):</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.contents[index].grouped<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>group.contents.append(self.contents[index])</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.contents.pop(index)</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.contents.insert(index,<sp/>group)</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"></highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a3ac50c707cda3c065df94ba7ee1121ae" kindref="member">remove</ref>(self,<sp/>index):</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Remove<sp/>a<sp/>container<sp/>but<sp/>leave<sp/>its<sp/>contents&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>container<sp/>=<sp/>self.contents[index]</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.contents.pop(index)</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>len(container.contents)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.contents.insert(index,<sp/>container.contents.pop())</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"></highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1aa7d0d232da200e5744adae7e65ebc612" kindref="member">tree</ref>(self,<sp/>level=0):</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Show<sp/>in<sp/>a<sp/>tree&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.debug(</highlight><highlight class="stringliteral">&quot;<sp/><sp/>&quot;</highlight><highlight class="normal"><sp/>*<sp/>level<sp/>+<sp/>str(self))</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>container<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.contents:</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>container.tree(level<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="1418"><highlight class="normal"></highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1af5552c4c28844e1fe61db6e967238f2c" kindref="member">getparameter</ref>(self,<sp/>name):</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>value<sp/>of<sp/>a<sp/>parameter,<sp/>if<sp/>present.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>name<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.parameters:</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.parameters[name]</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"></highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1ad42518108c287270a81feec33bdd740b" kindref="member">getparameterlist</ref>(self,<sp/>name):</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>value<sp/>of<sp/>a<sp/>comma-separated<sp/>parameter<sp/>as<sp/>a<sp/>list.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paramtext<sp/>=<sp/>self.getparameter(name)</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>paramtext:</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[]</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>paramtext.split(</highlight><highlight class="stringliteral">&apos;,&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"></highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a1f8d94ec0fe5af591d4871e89394604c" kindref="member">hasemptyoutput</ref>(self):</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>if<sp/>the<sp/>parent&apos;s<sp/>output<sp/>is<sp/>empty.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current<sp/>=<sp/>self.parent</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>current:</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>current.output.isempty():</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current<sp/>=<sp/>current.parent</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1440"><highlight class="normal"></highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a6e2dddddb738d6f3082028097407977d" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>a<sp/>description&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.begin:</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.__class__.__name__</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.__class__.__name__<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;@&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(self.begin)</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"></highlight></codeline>
<codeline lineno="1447"><highlight class="normal"></highlight></codeline>
<codeline lineno="1448" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BlackBox" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BlackBox" kindref="compound">BlackBox</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container" kindref="compound">Container</ref>):</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>container<sp/>that<sp/>does<sp/>not<sp/>output<sp/>anything&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1450"><highlight class="normal"></highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BlackBox_1a974eb69b2cb882102cd9e2554bbd6946" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BlackBox_1a8297866ab85831213d7d68103a4c2b24" kindref="member">parser</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LoneCommand" kindref="compound">LoneCommand</ref>()</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BlackBox_1a231ab42997725f3392f674e67b587cc8" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyOutput" kindref="compound">EmptyOutput</ref>()</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BlackBox_1ab4a2ef0597557eb0ed60746ac97bd004" kindref="member">contents</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"></highlight></codeline>
<codeline lineno="1456"><highlight class="normal"></highlight></codeline>
<codeline lineno="1457" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer" kindref="compound">StringContainer</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container" kindref="compound">Container</ref>):</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>container<sp/>for<sp/>a<sp/>single<sp/>string&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1459"><highlight class="normal"></highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/>parsed<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1461"><highlight class="normal"></highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1ad89d67fe35bdb3a64ea077b401ddb909" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a2b8a74f1defbda396e693c03c53fa447" kindref="member">parser</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringParser" kindref="compound">StringParser</ref>()</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1af49528f61dd30f7b8704d6ee8fb51c3d" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringOutput" kindref="compound">StringOutput</ref>()</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a1e682b4baf784632e3ae75beb8ffbb62" kindref="member">string</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1466"><highlight class="normal"></highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1aabc0cacfb35cdf5d6e916e7a736afa01" kindref="member">process</ref>(self):</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Replace<sp/>special<sp/>chars<sp/>from<sp/>the<sp/>contents.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a3cb075924d713918df7ec415ee5a2131" kindref="member">parsed</ref>:</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a1e682b4baf784632e3ae75beb8ffbb62" kindref="member">string</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a282c7cb60b309a926c73c025f5636af7" kindref="member">replacespecial</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a3cb075924d713918df7ec415ee5a2131" kindref="member">parsed</ref>)</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a3cb075924d713918df7ec415ee5a2131" kindref="member">parsed</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1472"><highlight class="normal"></highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a282c7cb60b309a926c73c025f5636af7" kindref="member">replacespecial</ref>(self,<sp/>line):</highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Replace<sp/>all<sp/>special<sp/>chars<sp/>from<sp/>a<sp/>line&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>replaced<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1afc37f99b78785506f1d6bc43875aa638" kindref="member">escape</ref>(line,<sp/>EscapeConfig.entities)</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>replaced<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1ad5f3f42914d58de3bed6dea6df3c8e00" kindref="member">changeline</ref>(replaced)</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ContainerConfig.string[</highlight><highlight class="stringliteral">&apos;startcommand&apos;</highlight><highlight class="normal">]<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>replaced<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>len(replaced)<sp/>&gt;<sp/>1:</highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>unprocessed<sp/>commands</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a697d146bd52b8079a3d0b15848af9699" kindref="member">begin</ref>:</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Unknown<sp/>command<sp/>at<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a697d146bd52b8079a3d0b15848af9699" kindref="member">begin</ref>)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;:<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>message<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Unknown<sp/>command:<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(message<sp/>+<sp/>replaced.strip())</highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>replaced</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"></highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1ad5f3f42914d58de3bed6dea6df3c8e00" kindref="member">changeline</ref>(self,<sp/>line):</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1afc37f99b78785506f1d6bc43875aa638" kindref="member">escape</ref>(line,<sp/>EscapeConfig.chars)</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"></highlight></codeline>
<codeline lineno="1489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1af1ffb154108a4df39d5af5ab69c8c62e" kindref="member">extracttext</ref>(self):</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>all<sp/>text.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a1e682b4baf784632e3ae75beb8ffbb62" kindref="member">string</ref></highlight></codeline>
<codeline lineno="1492"><highlight class="normal"></highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1ad064c9985b067ac114b630e52247a2f5" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="1494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>printable<sp/>representation.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;StringContainer&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a697d146bd52b8079a3d0b15848af9699" kindref="member">begin</ref>:</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;@&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a697d146bd52b8079a3d0b15848af9699" kindref="member">begin</ref>)</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ellipsis<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;...&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a1e682b4baf784632e3ae75beb8ffbb62" kindref="member">string</ref>.strip())<sp/>&lt;=<sp/>15:</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ellipsis<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>(&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a1e682b4baf784632e3ae75beb8ffbb62" kindref="member">string</ref>.strip()[:15]<sp/>+<sp/>ellipsis<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;)&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1502"><highlight class="normal"></highlight></codeline>
<codeline lineno="1503"><highlight class="normal"></highlight></codeline>
<codeline lineno="1504" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant" kindref="compound">Constant</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer" kindref="compound">StringContainer</ref>):</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>constant<sp/>string&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1506"><highlight class="normal"></highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant_1ae007aaf0f104a52ba7eeb2614b6b73a5" kindref="member">__init__</ref>(self,<sp/>text):</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant_1afb5e6157e6c045c5120442658acac4ae" kindref="member">contents</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a1e682b4baf784632e3ae75beb8ffbb62" kindref="member">string</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant_1a2860cd039d2fb3b8e89cd90c6bfe8981" kindref="member">string</ref><sp/>=<sp/>text</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1af49528f61dd30f7b8704d6ee8fb51c3d" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant_1a8ac7fa6c470e940c0edd11edce51ad42" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringOutput" kindref="compound">StringOutput</ref>()</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"></highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant_1a8fdec7af6d55e92ec5a03491bbfac83f" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Constant:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a1e682b4baf784632e3ae75beb8ffbb62" kindref="member">string</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant_1a2860cd039d2fb3b8e89cd90c6bfe8981" kindref="member">string</ref></highlight></codeline>
<codeline lineno="1514"><highlight class="normal"></highlight></codeline>
<codeline lineno="1515"><highlight class="normal"></highlight></codeline>
<codeline lineno="1516" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1DocumentParameters" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1DocumentParameters" kindref="compound">DocumentParameters</ref>:</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Global<sp/>parameters<sp/>for<sp/>the<sp/>document.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1518"><highlight class="normal"></highlight></codeline>
<codeline lineno="1519"><highlight class="normal"><sp/><sp/><sp/><sp/>displaymode<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1520"><highlight class="normal"></highlight></codeline>
<codeline lineno="1521"><highlight class="normal"></highlight></codeline>
<codeline lineno="1522" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser" kindref="compound">FormulaParser</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser" kindref="compound">Parser</ref>):</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parses<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1524"><highlight class="normal"></highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1a96ebc8a6f2700fd41de69f33a266f8b6" kindref="member">parseheader</ref>(self,<sp/>reader):</highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;See<sp/>if<sp/>the<sp/>formula<sp/>is<sp/>inlined&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1a6fa6ae29da8216c3efcd08d37c0c0a8e" kindref="member">begin</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1a6f6d1fbdd925783664bb02394c7993bb" kindref="member">begin</ref><sp/>=<sp/>reader.linenumber<sp/>+<sp/>1</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1ac06e402be90ddc7c05e85d049210e4c8" kindref="member">parsetype</ref>(reader)</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>type:</highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>type<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1ac06e402be90ddc7c05e85d049210e4c8" kindref="member">parsetype</ref>(reader)</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>type:</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unknown<sp/>formula<sp/>type<sp/>in<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>reader.currentline().strip())</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[</highlight><highlight class="stringliteral">&apos;unknown&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[type]</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"></highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1ac06e402be90ddc7c05e85d049210e4c8" kindref="member">parsetype</ref>(self,<sp/>reader):</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>formula<sp/>type<sp/>from<sp/>the<sp/>first<sp/>line.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>reader.currentline().find(FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;simple&apos;</highlight><highlight class="normal">])<sp/>&gt;=<sp/>0:</highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;inline&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>reader.currentline().find(FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;complex&apos;</highlight><highlight class="normal">])<sp/>&gt;=<sp/>0:</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;block&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>reader.currentline().find(FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;unnumbered&apos;</highlight><highlight class="normal">])<sp/>&gt;=<sp/>0:</highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;block&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>reader.currentline().find(FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;beginbefore&apos;</highlight><highlight class="normal">])<sp/>&gt;=<sp/>0:</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;numbered&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1548"><highlight class="normal"></highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">parse(self,<sp/>reader):</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>formula<sp/>until<sp/>the<sp/>end&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>formula<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1af42a233e33d9c911f3c5763ad90cb886" kindref="member">parseformula</ref>(reader)</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>reader.currentline().startswith(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Parser_1aac23f721a37b4943c90efecf7fd8254d" kindref="member">ending</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1ac52d75f70f11261001c8bda1bfc91df9" kindref="member">ending</ref>):</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stripped<sp/>=<sp/>reader.currentline().strip()</highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(stripped)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unparsed<sp/>formula<sp/>line<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>stripped)</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>formula</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"></highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1af42a233e33d9c911f3c5763ad90cb886" kindref="member">parseformula</ref>(self,<sp/>reader):</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>formula<sp/>contents&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>simple<sp/>=<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;simple&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>simple<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>reader.currentline():</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rest<sp/>=<sp/>reader.currentline().split(simple,<sp/>1)[1]</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>simple<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>rest:</highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>formula<sp/>is<sp/>$...$</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1a2db8f27d3a21d1102b7d781ef60f4035" kindref="member">parsesingleliner</ref>(reader,<sp/>simple,<sp/>simple)</highlight></codeline>
<codeline lineno="1568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>formula<sp/>is<sp/>multiline<sp/>$...$</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1a4dc9ca8265d95cff05b091f08db7e46b" kindref="member">parsemultiliner</ref>(reader,<sp/>simple,<sp/>simple)</highlight></codeline>
<codeline lineno="1570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;complex&apos;</highlight><highlight class="normal">]<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>reader.currentline():</highlight></codeline>
<codeline lineno="1571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>formula<sp/>of<sp/>the<sp/>form<sp/>\[...\]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1a4dc9ca8265d95cff05b091f08db7e46b" kindref="member">parsemultiliner</ref>(reader,<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;complex&apos;</highlight><highlight class="normal">],</highlight></codeline>
<codeline lineno="1573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FormulaConfig.endings[</highlight><highlight class="stringliteral">&apos;complex&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>beginbefore<sp/>=<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;beginbefore&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>beginafter<sp/>=<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;beginafter&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>beginbefore<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>reader.currentline():</highlight></codeline>
<codeline lineno="1577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>reader.currentline().strip().endswith(beginafter):</highlight></codeline>
<codeline lineno="1578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>current<sp/>=<sp/>reader.currentline().strip()</highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endsplit<sp/>=<sp/>current.split(beginbefore)[1].split(beginafter)</highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>startpiece<sp/>=<sp/>beginbefore<sp/>+<sp/>endsplit[0]<sp/>+<sp/>beginafter</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endbefore<sp/>=<sp/>FormulaConfig.endings[</highlight><highlight class="stringliteral">&apos;endbefore&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endafter<sp/>=<sp/>FormulaConfig.endings[</highlight><highlight class="stringliteral">&apos;endafter&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endpiece<sp/>=<sp/>endbefore<sp/>+<sp/>endsplit[0]<sp/>+<sp/>endafter</highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>startpiece<sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1a4dc9ca8265d95cff05b091f08db7e46b" kindref="member">parsemultiliner</ref>(reader,<sp/>startpiece,<sp/>endpiece)<sp/>+<sp/>endpiece</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Missing<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>beginafter<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>in<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>reader.currentline())</highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>begincommand<sp/>=<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;command&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>beginbracket<sp/>=<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;bracket&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>begincommand<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>reader.currentline()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>beginbracket<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>reader.currentline():</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>endbracket<sp/>=<sp/>FormulaConfig.endings[</highlight><highlight class="stringliteral">&apos;bracket&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1a4dc9ca8265d95cff05b091f08db7e46b" kindref="member">parsemultiliner</ref>(reader,<sp/>beginbracket,<sp/>endbracket)</highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Formula<sp/>beginning<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>reader.currentline()<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>is<sp/>unknown&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1594"><highlight class="normal"></highlight></codeline>
<codeline lineno="1595"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1a2db8f27d3a21d1102b7d781ef60f4035" kindref="member">parsesingleliner</ref>(self,<sp/>reader,<sp/>start,<sp/>ending):</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>formula<sp/>in<sp/>one<sp/>line&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>reader.currentline().strip()</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>start<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>line:</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Line<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>line<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>does<sp/>not<sp/>contain<sp/>formula<sp/>start<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>start)</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>line.endswith(ending):</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Formula<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>line<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>does<sp/>not<sp/>end<sp/>with<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>ending)</highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>=<sp/>line.index(start)</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rest<sp/>=<sp/>line[index<sp/>+<sp/>len(start):-len(ending)]</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rest</highlight></codeline>
<codeline lineno="1608"><highlight class="normal"></highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser_1a4dc9ca8265d95cff05b091f08db7e46b" kindref="member">parsemultiliner</ref>(self,<sp/>reader,<sp/>start,<sp/>ending):</highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>formula<sp/>in<sp/>multiple<sp/>lines&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>formula<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>reader.currentline()</highlight></codeline>
<codeline lineno="1613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>start<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>line:</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Line<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>line.strip()<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>does<sp/>not<sp/>contain<sp/>formula<sp/>start<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>start)</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>=<sp/>line.index(start)</highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>line[index<sp/>+<sp/>len(start):].strip()</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>line.endswith(ending):</highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>formula<sp/>+=<sp/>line<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line<sp/>=<sp/>reader.currentline()</highlight></codeline>
<codeline lineno="1622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>formula<sp/>+=<sp/>line[:-len(ending)]</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reader.nextline()</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>formula</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"></highlight></codeline>
<codeline lineno="1626"><highlight class="normal"></highlight></codeline>
<codeline lineno="1627" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container" kindref="compound">Container</ref>):</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>bit<sp/>of<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1629"><highlight class="normal"></highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/>type<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1631"><highlight class="normal"><sp/><sp/><sp/><sp/>size<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/>original<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1633"><highlight class="normal"></highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38a4875d3d1824c4e7d6d28dbc94238a" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>formula<sp/>bit<sp/>type<sp/>can<sp/>be<sp/>&apos;alpha&apos;,<sp/>&apos;number&apos;,<sp/>&apos;font&apos;.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput" kindref="compound">ContentsOutput</ref>()</highlight></codeline>
<codeline lineno="1638"><highlight class="normal"></highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1aaf6ab3998cf89b7dd91c4bafa020e784" kindref="member">setfactory</ref>(self,<sp/>factory):</highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>internal<sp/>formula<sp/>factory.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref><sp/>=<sp/>factory</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"></highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(self,<sp/>bit):</highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Add<sp/>any<sp/>kind<sp/>of<sp/>formula<sp/>bit<sp/>already<sp/>processed&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref>.append(bit)</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/>bit.original</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit.parent<sp/>=<sp/>self</highlight></codeline>
<codeline lineno="1649"><highlight class="normal"></highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a0617997fea897dc1b16e695ea0723a5c" kindref="member">skiporiginal</ref>(self,<sp/>string,<sp/>pos):</highlight></codeline>
<codeline lineno="1651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Skip<sp/>a<sp/>string<sp/>and<sp/>add<sp/>it<sp/>to<sp/>the<sp/>original<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/>string</highlight></codeline>
<codeline lineno="1653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.checkskip(string):</highlight></codeline>
<codeline lineno="1654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;String<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>string<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>not<sp/>at<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.identifier())</highlight></codeline>
<codeline lineno="1655"><highlight class="normal"></highlight></codeline>
<codeline lineno="1656"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8c49df3aff68981b4969da63fe0de83b" kindref="member">computesize</ref>(self):</highlight></codeline>
<codeline lineno="1657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Compute<sp/>the<sp/>size<sp/>of<sp/>the<sp/>bit<sp/>as<sp/>the<sp/>max<sp/>of<sp/>the<sp/>sizes<sp/>of<sp/>all<sp/>contents.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref>)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="1659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1</highlight></codeline>
<codeline lineno="1660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a1d508aa75109228e5964fc7d795bc202" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a17f4fb88387219a0115ef1e1d5e8beed" kindref="member">size</ref><sp/>=<sp/>max(element.size<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref>)</highlight></codeline>
<codeline lineno="1661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a1d508aa75109228e5964fc7d795bc202" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a17f4fb88387219a0115ef1e1d5e8beed" kindref="member">size</ref></highlight></codeline>
<codeline lineno="1662"><highlight class="normal"></highlight></codeline>
<codeline lineno="1663"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a15206817ec1e1d2365a8c5ba5b11bd91" kindref="member">clone</ref>(self):</highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>copy<sp/>of<sp/>itself.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.parseformula(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref>)</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"></highlight></codeline>
<codeline lineno="1667"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1aff40748f85500193e7d1e46c697b851a" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>a<sp/>string<sp/>representation&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.__class__.__name__<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>read<sp/>in<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref></highlight></codeline>
<codeline lineno="1670"><highlight class="normal"></highlight></codeline>
<codeline lineno="1671"><highlight class="normal"></highlight></codeline>
<codeline lineno="1672" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>):</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>tagged<sp/>string<sp/>in<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1674"><highlight class="normal"></highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit_1acca18c1f7c0cd7d662422bdc2da6d1cc" kindref="member">constant</ref>(self,<sp/>constant,<sp/>tag):</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>constant<sp/>and<sp/>the<sp/>tag&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit_1a543522aeb946ed8b77fbe1e629a4a2e2" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(tag)</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(constant))</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"></highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit_1a28f452eb2f936644c31f250bf5155d76" kindref="member">complete</ref>(self,<sp/>contents,<sp/>tag,<sp/>breaklines=False):</highlight></codeline>
<codeline lineno="1682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>constant<sp/>and<sp/>the<sp/>tag&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit_1a8dc5c8284eb6e6657a164f4ac1e36bde" kindref="member">contents</ref><sp/>=<sp/>contents</highlight></codeline>
<codeline lineno="1684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit_1a543522aeb946ed8b77fbe1e629a4a2e2" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(tag,<sp/>breaklines)</highlight></codeline>
<codeline lineno="1685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="1686"><highlight class="normal"></highlight></codeline>
<codeline lineno="1687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit_1aa263095cf7f30329f9ac1f74495c13b5" kindref="member">selfcomplete</ref>(self,<sp/>tag):</highlight></codeline>
<codeline lineno="1688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>self-closing<sp/>tag,<sp/>no<sp/>contents<sp/>(as<sp/>in<sp/>&lt;hr/&gt;).&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit_1a543522aeb946ed8b77fbe1e629a4a2e2" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(tag,<sp/>empty=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="1691"><highlight class="normal"></highlight></codeline>
<codeline lineno="1692"><highlight class="normal"></highlight></codeline>
<codeline lineno="1693" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant" kindref="compound">Constant</ref>):</highlight></codeline>
<codeline lineno="1694"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>constant<sp/>string<sp/>in<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1695"><highlight class="normal"></highlight></codeline>
<codeline lineno="1696"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant_1a484a9ebfe9901637150b51e9d11aef0e" kindref="member">__init__</ref>(self,<sp/>string):</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>constant<sp/>string&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Constant.__init__(self,<sp/>string)</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant_1a0455a973c054bdddc6b7b24f2d2857fa" kindref="member">original</ref><sp/>=<sp/>string</highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant_1a6dcc434a371eb650efc159f08b68f014" kindref="member">size</ref><sp/>=<sp/>1</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant_1adade1cd3a21a81d431bbcf98236e1b5c" kindref="member">type</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1702"><highlight class="normal"></highlight></codeline>
<codeline lineno="1703"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant_1a96c6270fb8be4ea60cdd5649fb2e4657" kindref="member">computesize</ref>(self):</highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Compute<sp/>the<sp/>size<sp/>of<sp/>the<sp/>constant:<sp/>always<sp/>1.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant_1a6dcc434a371eb650efc159f08b68f014" kindref="member">size</ref></highlight></codeline>
<codeline lineno="1706"><highlight class="normal"></highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant_1a4b93d4b258db0d4e29acceefcf51b17d" kindref="member">clone</ref>(self):</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>copy<sp/>of<sp/>itself.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant_1a0455a973c054bdddc6b7b24f2d2857fa" kindref="member">original</ref>)</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"></highlight></codeline>
<codeline lineno="1711"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant_1a2783e32a861d6f796256baaaade21c8e" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>printable<sp/>representation.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Formula<sp/>constant:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1StringContainer_1a1e682b4baf784632e3ae75beb8ffbb62" kindref="member">string</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Constant_1a2860cd039d2fb3b8e89cd90c6bfe8981" kindref="member">string</ref></highlight></codeline>
<codeline lineno="1714"><highlight class="normal"></highlight></codeline>
<codeline lineno="1715"><highlight class="normal"></highlight></codeline>
<codeline lineno="1716" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1RawText" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1RawText" kindref="compound">RawText</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>):</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>bit<sp/>of<sp/>text<sp/>inside<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1718"><highlight class="normal"></highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">detect(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Detect<sp/>a<sp/>bit<sp/>of<sp/>raw<sp/>text&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pos.current().isalpha()</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"></highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1RawText_1a1a9cb2f3cfe93a430b4eb3888323087f" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>alphabetic<sp/>text&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alpha<sp/>=<sp/>pos.globalpha()</highlight></codeline>
<codeline lineno="1726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(alpha))</highlight></codeline>
<codeline lineno="1727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a154e7a51f3cb5a3e49f54e59d18a2869" kindref="member">type</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1RawText_1a3ec6eb2a8cd7e66dfc0b79f106873ffa" kindref="member">type</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;alpha&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1728"><highlight class="normal"></highlight></codeline>
<codeline lineno="1729"><highlight class="normal"></highlight></codeline>
<codeline lineno="1730" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaSymbol" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaSymbol" kindref="compound">FormulaSymbol</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>):</highlight></codeline>
<codeline lineno="1731"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>symbol<sp/>inside<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1732"><highlight class="normal"></highlight></codeline>
<codeline lineno="1733"><highlight class="normal"><sp/><sp/><sp/><sp/>modified<sp/>=<sp/>FormulaConfig.modified</highlight></codeline>
<codeline lineno="1734"><highlight class="normal"><sp/><sp/><sp/><sp/>unmodified<sp/>=<sp/>FormulaConfig.unmodified[</highlight><highlight class="stringliteral">&apos;characters&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1735"><highlight class="normal"></highlight></codeline>
<codeline lineno="1736"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">detect(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Detect<sp/>a<sp/>symbol&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.current()<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>FormulaSymbol.unmodified:</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.current()<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>FormulaSymbol.modified:</highlight></codeline>
<codeline lineno="1741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1743"><highlight class="normal"></highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaSymbol_1a6157342ea8fab554dc1c287385f2b289" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>symbol&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.current()<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>FormulaSymbol.unmodified:</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaSymbol_1a64185aee9460f0b5bdfb27ac1d3de555" kindref="member">addsymbol</ref>(pos.current(),<sp/>pos)</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.current()<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>FormulaSymbol.modified:</highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaSymbol_1a64185aee9460f0b5bdfb27ac1d3de555" kindref="member">addsymbol</ref>(FormulaSymbol.modified[pos.current()],<sp/>pos)</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Symbol<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.current()<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>not<sp/>found&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"></highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaSymbol_1a64185aee9460f0b5bdfb27ac1d3de555" kindref="member">addsymbol</ref>(self,<sp/>symbol,<sp/>pos):</highlight></codeline>
<codeline lineno="1755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Add<sp/>a<sp/>symbol&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a0617997fea897dc1b16e695ea0723a5c" kindref="member">skiporiginal</ref>(pos.current(),<sp/>pos)</highlight></codeline>
<codeline lineno="1757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref>.append(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(symbol))</highlight></codeline>
<codeline lineno="1758"><highlight class="normal"></highlight></codeline>
<codeline lineno="1759"><highlight class="normal"></highlight></codeline>
<codeline lineno="1760" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaNumber" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaNumber" kindref="compound">FormulaNumber</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>):</highlight></codeline>
<codeline lineno="1761"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>string<sp/>of<sp/>digits<sp/>in<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1762"><highlight class="normal"></highlight></codeline>
<codeline lineno="1763"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">detect(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Detect<sp/>a<sp/>digit&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pos.current().isdigit()</highlight></codeline>
<codeline lineno="1766"><highlight class="normal"></highlight></codeline>
<codeline lineno="1767"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaNumber_1aca169839bbbfcf7676d4ef57726d6786" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>bunch<sp/>of<sp/>digits&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>digits<sp/>=<sp/>pos.glob(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal">:<sp/>pos.current().isdigit())</highlight></codeline>
<codeline lineno="1770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(digits))</highlight></codeline>
<codeline lineno="1771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a154e7a51f3cb5a3e49f54e59d18a2869" kindref="member">type</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaNumber_1a443afd01eb6e1904d90d370eb467860d" kindref="member">type</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1772"><highlight class="normal"></highlight></codeline>
<codeline lineno="1773"><highlight class="normal"></highlight></codeline>
<codeline lineno="1774" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Comment" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Comment" kindref="compound">Comment</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>):</highlight></codeline>
<codeline lineno="1775"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>LaTeX<sp/>comment:<sp/>%<sp/>to<sp/>the<sp/>end<sp/>of<sp/>the<sp/>line.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1776"><highlight class="normal"></highlight></codeline>
<codeline lineno="1777"><highlight class="normal"><sp/><sp/><sp/><sp/>start<sp/>=<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;comment&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1778"><highlight class="normal"></highlight></codeline>
<codeline lineno="1779"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">detect(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Detect<sp/>the<sp/>%.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pos.current()<sp/>==<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Comment_1a6a35a6aa8ac14cae129380c077433314" kindref="member">start</ref></highlight></codeline>
<codeline lineno="1782"><highlight class="normal"></highlight></codeline>
<codeline lineno="1783"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Comment_1a5c3c32169ace1df5a04b8b11e96ca74b" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>to<sp/>the<sp/>end<sp/>of<sp/>the<sp/>line.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/>pos.globincluding(</highlight><highlight class="stringliteral">&apos;\n&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1786"><highlight class="normal"></highlight></codeline>
<codeline lineno="1787"><highlight class="normal"></highlight></codeline>
<codeline lineno="1788" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1WhiteSpace" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1WhiteSpace" kindref="compound">WhiteSpace</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>):</highlight></codeline>
<codeline lineno="1789"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Some<sp/>white<sp/>space<sp/>inside<sp/>a<sp/>formula.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1790"><highlight class="normal"></highlight></codeline>
<codeline lineno="1791"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">detect(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Detect<sp/>the<sp/>white<sp/>space.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pos.current().isspace()</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"></highlight></codeline>
<codeline lineno="1795"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1WhiteSpace_1a673170b601c05a542243fdaec55f8991" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>all<sp/>whitespace.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/>pos.skipspace()</highlight></codeline>
<codeline lineno="1798"><highlight class="normal"></highlight></codeline>
<codeline lineno="1799"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1WhiteSpace_1ae351f39e36f54fcac52078a3daa54b9d" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="1800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>printable<sp/>representation.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Whitespace:<sp/>*&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1802"><highlight class="normal"></highlight></codeline>
<codeline lineno="1803"><highlight class="normal"></highlight></codeline>
<codeline lineno="1804" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket" kindref="compound">Bracket</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>):</highlight></codeline>
<codeline lineno="1805"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>{}<sp/>bracket<sp/>inside<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1806"><highlight class="normal"></highlight></codeline>
<codeline lineno="1807"><highlight class="normal"><sp/><sp/><sp/><sp/>start<sp/>=<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;bracket&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"><sp/><sp/><sp/><sp/>ending<sp/>=<sp/>FormulaConfig.endings[</highlight><highlight class="stringliteral">&apos;bracket&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1809"><highlight class="normal"></highlight></codeline>
<codeline lineno="1810"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1ad5be8e7e5b7d11bdfe4f527592471881" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Create<sp/>a<sp/>(possibly<sp/>literal)<sp/>new<sp/>bracket&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FormulaBit.__init__(self)</highlight></codeline>
<codeline lineno="1813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a258b25f77cf5c126f3a99db10e5be973" kindref="member">inner</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1814"><highlight class="normal"></highlight></codeline>
<codeline lineno="1815"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">detect(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Detect<sp/>the<sp/>start<sp/>of<sp/>a<sp/>bracket&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pos.checkfor(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a93322630cdba5172be7f135d095b3fef" kindref="member">start</ref>)</highlight></codeline>
<codeline lineno="1818"><highlight class="normal"></highlight></codeline>
<codeline lineno="1819"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a24f2b13a2c20aa38dd0b5d22b9b7d9eb" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>bracket&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1ab002cb51bbec60488e2917cf2a65a8d7" kindref="member">parsecomplete</ref>(pos,<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a106589d7c6a98fe3aa8aa339868ebcf2" kindref="member">innerformula</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a151d356b1bad835aa2be6aebedef5416" kindref="member">innerformula</ref>)</highlight></codeline>
<codeline lineno="1822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"></highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a6f066c64a9a8e50ad1232d93fe9575a6" kindref="member">parsetext</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>text<sp/>bracket&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1ab002cb51bbec60488e2917cf2a65a8d7" kindref="member">parsecomplete</ref>(pos,<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a7f424daace3fcc013eca6dd2bbce9f3b" kindref="member">innertext</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a45504faba98f33d7f860a59495daad68" kindref="member">innertext</ref>)</highlight></codeline>
<codeline lineno="1827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="1828"><highlight class="normal"></highlight></codeline>
<codeline lineno="1829"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a85c35a3b549d00eb6b5872d74553f04b" kindref="member">parseliteral</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>literal<sp/>bracket&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1ab002cb51bbec60488e2917cf2a65a8d7" kindref="member">parsecomplete</ref>(pos,<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a40c479a48fb59d5c8e76bd8625a85d0d" kindref="member">innerliteral</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a057829555b04bc0a00ef8eeffde02217" kindref="member">innerliteral</ref>)</highlight></codeline>
<codeline lineno="1832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="1833"><highlight class="normal"></highlight></codeline>
<codeline lineno="1834"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1ab002cb51bbec60488e2917cf2a65a8d7" kindref="member">parsecomplete</ref>(self,<sp/>pos,<sp/>innerparser):</highlight></codeline>
<codeline lineno="1835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>start<sp/>and<sp/>end<sp/>marks&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.checkfor(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a93322630cdba5172be7f135d095b3fef" kindref="member">start</ref>):</highlight></codeline>
<codeline lineno="1837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Bracket<sp/>should<sp/>start<sp/>with<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a93322630cdba5172be7f135d095b3fef" kindref="member">start</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>at<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.identifier())</highlight></codeline>
<codeline lineno="1838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a0617997fea897dc1b16e695ea0723a5c" kindref="member">skiporiginal</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a93322630cdba5172be7f135d095b3fef" kindref="member">start</ref>,<sp/>pos)</highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.pushending(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1abd03d46392611269460cb29b9fb6a498" kindref="member">ending</ref>)</highlight></codeline>
<codeline lineno="1841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>innerparser(pos)</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/>pos.popending(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1abd03d46392611269460cb29b9fb6a498" kindref="member">ending</ref>)</highlight></codeline>
<codeline lineno="1843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8c49df3aff68981b4969da63fe0de83b" kindref="member">computesize</ref>()</highlight></codeline>
<codeline lineno="1844"><highlight class="normal"></highlight></codeline>
<codeline lineno="1845"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a106589d7c6a98fe3aa8aa339868ebcf2" kindref="member">innerformula</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>whole<sp/>formula<sp/>inside<sp/>the<sp/>bracket&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.parseany(pos))</highlight></codeline>
<codeline lineno="1849"><highlight class="normal"></highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a7f424daace3fcc013eca6dd2bbce9f3b" kindref="member">innertext</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>some<sp/>text<sp/>inside<sp/>the<sp/>bracket,<sp/>following<sp/>textual<sp/>rules.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specialchars<sp/>=<sp/>list(FormulaConfig.symbolfunctions.keys())</highlight></codeline>
<codeline lineno="1853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specialchars.append(FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;command&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specialchars.append(FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;bracket&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="1855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specialchars.append(Comment.start)</highlight></codeline>
<codeline lineno="1856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="1857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.current()<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>specialchars:</highlight></codeline>
<codeline lineno="1858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.parseany(pos))</highlight></codeline>
<codeline lineno="1859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(pos.skipcurrent()))</highlight></codeline>
<codeline lineno="1863"><highlight class="normal"></highlight></codeline>
<codeline lineno="1864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a40c479a48fb59d5c8e76bd8625a85d0d" kindref="member">innerliteral</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>literal<sp/>inside<sp/>the<sp/>bracket,<sp/>which<sp/>does<sp/>not<sp/>generate<sp/>HTML.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a8385592de4827c0b6e765e37b00d5737" kindref="member">literal</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.current()<sp/>==<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1abd03d46392611269460cb29b9fb6a498" kindref="member">ending</ref>:</highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.current()<sp/>==<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a93322630cdba5172be7f135d095b3fef" kindref="member">start</ref>:</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a85c35a3b549d00eb6b5872d74553f04b" kindref="member">parseliteral</ref>(pos)</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a8385592de4827c0b6e765e37b00d5737" kindref="member">literal</ref><sp/>+=<sp/>pos.skipcurrent()</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket_1a8385592de4827c0b6e765e37b00d5737" kindref="member">literal</ref></highlight></codeline>
<codeline lineno="1873"><highlight class="normal"></highlight></codeline>
<codeline lineno="1874"><highlight class="normal"></highlight></codeline>
<codeline lineno="1875" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SquareBracket" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SquareBracket" kindref="compound">SquareBracket</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket" kindref="compound">Bracket</ref>):</highlight></codeline>
<codeline lineno="1876"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>[]<sp/>bracket<sp/>inside<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1877"><highlight class="normal"></highlight></codeline>
<codeline lineno="1878"><highlight class="normal"><sp/><sp/><sp/><sp/>start<sp/>=<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;squarebracket&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/><sp/><sp/>ending<sp/>=<sp/>FormulaConfig.endings[</highlight><highlight class="stringliteral">&apos;squarebracket&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"></highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SquareBracket_1a658ae7bf3fa07a2a7846a65efd6c7922" kindref="member">clone</ref>(self):</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>new<sp/>square<sp/>bracket<sp/>with<sp/>the<sp/>same<sp/>contents.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bracket<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SquareBracket" kindref="compound">SquareBracket</ref>()</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bracket.contents<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref></highlight></codeline>
<codeline lineno="1885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bracket</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"></highlight></codeline>
<codeline lineno="1887"><highlight class="normal"></highlight></codeline>
<codeline lineno="1888" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MathsProcessor" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MathsProcessor" kindref="compound">MathsProcessor</ref>:</highlight></codeline>
<codeline lineno="1889"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>processor<sp/>for<sp/>a<sp/>maths<sp/>construction<sp/>inside<sp/>the<sp/>FormulaProcessor.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1890"><highlight class="normal"></highlight></codeline>
<codeline lineno="1891"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MathsProcessor_1a21b6fa7d90d66450d77cdf56fd57c44b" kindref="member">process</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="1892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Process<sp/>an<sp/>element<sp/>inside<sp/>a<sp/>formula.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unimplemented<sp/>process()<sp/>in<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(self))</highlight></codeline>
<codeline lineno="1894"><highlight class="normal"></highlight></codeline>
<codeline lineno="1895"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MathsProcessor_1a94e007ae64f06fcceb009abce0692864" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="1896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>printable<sp/>description.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Maths<sp/>processor<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.__class__.__name__</highlight></codeline>
<codeline lineno="1898"><highlight class="normal"></highlight></codeline>
<codeline lineno="1899"><highlight class="normal"></highlight></codeline>
<codeline lineno="1900" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor" kindref="compound">FormulaProcessor</ref>:</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>processor<sp/>specifically<sp/>for<sp/>formulas.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1902"><highlight class="normal"></highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><sp/><sp/><sp/><sp/>processors<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"></highlight></codeline>
<codeline lineno="1905"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1ad2edd13710c184413313e043625b381b" kindref="member">process</ref>(self,<sp/>bit):</highlight></codeline>
<codeline lineno="1906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Process<sp/>the<sp/>contents<sp/>of<sp/>every<sp/>formula<sp/>bit,<sp/>recursively.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a8f9596502b48d8acc0a616bdaff3ad19" kindref="member">processcontents</ref>(bit)</highlight></codeline>
<codeline lineno="1908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a5aa53a2d721be1d28921d635d63dee7a" kindref="member">processinsides</ref>(bit)</highlight></codeline>
<codeline lineno="1909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a50def763624bb4f5aaffe286ebf949c3" kindref="member">traversewhole</ref>(bit)</highlight></codeline>
<codeline lineno="1910"><highlight class="normal"></highlight></codeline>
<codeline lineno="1911"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a8f9596502b48d8acc0a616bdaff3ad19" kindref="member">processcontents</ref>(self,<sp/>bit):</highlight></codeline>
<codeline lineno="1912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Process<sp/>the<sp/>contents<sp/>of<sp/>a<sp/>formula<sp/>bit.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(bit,<sp/>FormulaBit):</highlight></codeline>
<codeline lineno="1914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit.process()</highlight></codeline>
<codeline lineno="1916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>bit.contents:</highlight></codeline>
<codeline lineno="1917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a8f9596502b48d8acc0a616bdaff3ad19" kindref="member">processcontents</ref>(element)</highlight></codeline>
<codeline lineno="1918"><highlight class="normal"></highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a5aa53a2d721be1d28921d635d63dee7a" kindref="member">processinsides</ref>(self,<sp/>bit):</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Process<sp/>the<sp/>insides<sp/>(limits,<sp/>brackets)<sp/>in<sp/>a<sp/>formula<sp/>bit.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(bit,<sp/>FormulaBit):</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>index,<sp/>element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(bit.contents):</highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>processor<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1ac0b5d413993d98afeab10d192ccf7023" kindref="member">processors</ref>:</highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>processor.process(bit.contents,<sp/>index)</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>continue<sp/>with<sp/>recursive<sp/>processing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a5aa53a2d721be1d28921d635d63dee7a" kindref="member">processinsides</ref>(element)</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"></highlight></codeline>
<codeline lineno="1929"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a50def763624bb4f5aaffe286ebf949c3" kindref="member">traversewhole</ref>(self,<sp/>formula):</highlight></codeline>
<codeline lineno="1930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Traverse<sp/>over<sp/>the<sp/>contents<sp/>to<sp/>alter<sp/>variables<sp/>and<sp/>space<sp/>units.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>bit,<sp/>contents<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a086a1c10e1faa9cda71ef6fabf500819" kindref="member">traverse</ref>(formula):</highlight></codeline>
<codeline lineno="1933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>bit.type<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;alpha&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a814c7b4d792108e32b9a210b41d84a98" kindref="member">italicize</ref>(bit,<sp/>contents)</highlight></codeline>
<codeline lineno="1935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>bit.type<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;font&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>last<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>last.type<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;number&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit.contents.insert(0,<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(</highlight><highlight class="stringliteral">&apos;\u2009&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="1937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last<sp/>=<sp/>bit</highlight></codeline>
<codeline lineno="1938"><highlight class="normal"></highlight></codeline>
<codeline lineno="1939"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a086a1c10e1faa9cda71ef6fabf500819" kindref="member">traverse</ref>(self,<sp/>bit):</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Traverse<sp/>a<sp/>formula<sp/>and<sp/>yield<sp/>a<sp/>flattened<sp/>structure<sp/>of<sp/>(bit,<sp/>list)<sp/>pairs.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>bit.contents:</highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(element,<sp/></highlight><highlight class="stringliteral">&apos;type&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>element.type:</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>element,<sp/>bit.contents</highlight></codeline>
<codeline lineno="1944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>isinstance(element,<sp/>FormulaBit):</highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a086a1c10e1faa9cda71ef6fabf500819" kindref="member">traverse</ref>(element)</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"></highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor_1a814c7b4d792108e32b9a210b41d84a98" kindref="member">italicize</ref>(self,<sp/>bit,<sp/>contents):</highlight></codeline>
<codeline lineno="1948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Italicize<sp/>the<sp/>given<sp/>bit<sp/>of<sp/>text.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>=<sp/>contents.index(bit)</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents[index]<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().complete([bit],<sp/></highlight><highlight class="stringliteral">&apos;i&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1951"><highlight class="normal"></highlight></codeline>
<codeline lineno="1952"><highlight class="normal"></highlight></codeline>
<codeline lineno="1953" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula" kindref="compound">Formula</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container" kindref="compound">Container</ref>):</highlight></codeline>
<codeline lineno="1954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>LaTeX<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1955"><highlight class="normal"></highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a76621e4c2c96152a073737bbef3c11ec" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a34fefe1facdfbc8de8ade74a0b0486e0" kindref="member">parser</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaParser" kindref="compound">FormulaParser</ref>()</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a2eb30d36aa4fe5231a660d63457232b1" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;formula&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1959"><highlight class="normal"></highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1aaff5ac1cc3cccf3acbaab327fb68193d" kindref="member">process</ref>(self):</highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Convert<sp/>the<sp/>formula<sp/>to<sp/>tags&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1adda498be72ffa5da8d95ad08747e00ce" kindref="member">header</ref>[0]<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;inline&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DocumentParameters.displaymode<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DocumentParameters.displaymode<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a2eb30d36aa4fe5231a660d63457232b1" kindref="member">output</ref>.settag(</highlight><highlight class="stringliteral">&apos;div<sp/>class=&quot;formula&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1aa94317e35d48d102a2d404b20fc75d98" kindref="member">classic</ref>()</highlight></codeline>
<codeline lineno="1968"><highlight class="normal"></highlight></codeline>
<codeline lineno="1969"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1aa94317e35d48d102a2d404b20fc75d98" kindref="member">classic</ref>(self):</highlight></codeline>
<codeline lineno="1970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Make<sp/>the<sp/>contents<sp/>using<sp/>classic<sp/>output<sp/>generation<sp/>with<sp/>XHTML<sp/>and<sp/>CSS.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>whole<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory" kindref="compound">FormulaFactory</ref>().parseformula(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1acd8f8aacb1be5779b82af63b89320c40" kindref="member">parsed</ref>)</highlight></codeline>
<codeline lineno="1972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor" kindref="compound">FormulaProcessor</ref>().<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1aaff5ac1cc3cccf3acbaab327fb68193d" kindref="member">process</ref>(whole)</highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>whole.parent<sp/>=<sp/>self</highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a3a90e879ab937715d500e64fb729ffaf" kindref="member">contents</ref><sp/>=<sp/>[whole]</highlight></codeline>
<codeline lineno="1975"><highlight class="normal"></highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">parse(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>using<sp/>a<sp/>parse<sp/>position<sp/>instead<sp/>of<sp/>self.parser.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;$$&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a58bed6e6cff3b340b9763ee637c7338a" kindref="member">parsedollarblock</ref>(pos)</highlight></codeline>
<codeline lineno="1980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a3519072e132d84d9339c253e28416073" kindref="member">parsedollarinline</ref>(pos)</highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;\\(&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a7d232beb438e9fd07fe9621b80e04992" kindref="member">parseinlineto</ref>(pos,<sp/></highlight><highlight class="stringliteral">&apos;\\)&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;\\[&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1ad96a5f892e4bba8576591c30bde58bcd" kindref="member">parseblockto</ref>(pos,<sp/></highlight><highlight class="stringliteral">&apos;\\]&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.error(</highlight><highlight class="stringliteral">&apos;Unparseable<sp/>formula&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a2c0590f54bb156dd853be8fdc1bd3c48" kindref="member">process</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1aaff5ac1cc3cccf3acbaab327fb68193d" kindref="member">process</ref>()</highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="1990"><highlight class="normal"></highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a3519072e132d84d9339c253e28416073" kindref="member">parsedollarinline</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>$...$<sp/>formula.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1adda498be72ffa5da8d95ad08747e00ce" kindref="member">header</ref><sp/>=<sp/>[</highlight><highlight class="stringliteral">&apos;inline&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a98db381df83368c8c588ab234bee8bb8" kindref="member">parsedollar</ref>(pos)</highlight></codeline>
<codeline lineno="1995"><highlight class="normal"></highlight></codeline>
<codeline lineno="1996"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a58bed6e6cff3b340b9763ee637c7338a" kindref="member">parsedollarblock</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="1997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>$$...$$<sp/>formula.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1adda498be72ffa5da8d95ad08747e00ce" kindref="member">header</ref><sp/>=<sp/>[</highlight><highlight class="stringliteral">&apos;block&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a98db381df83368c8c588ab234bee8bb8" kindref="member">parsedollar</ref>(pos)</highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.error(</highlight><highlight class="stringliteral">&apos;Formula<sp/>should<sp/>be<sp/>$$...$$,<sp/>but<sp/>last<sp/>$<sp/>is<sp/>missing.&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2002"><highlight class="normal"></highlight></codeline>
<codeline lineno="2003"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a98db381df83368c8c588ab234bee8bb8" kindref="member">parsedollar</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>to<sp/>the<sp/>next<sp/>$.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.pushending(</highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1acd8f8aacb1be5779b82af63b89320c40" kindref="member">parsed</ref><sp/>=<sp/>pos.globexcluding(</highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.popending(</highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2008"><highlight class="normal"></highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a7d232beb438e9fd07fe9621b80e04992" kindref="member">parseinlineto</ref>(self,<sp/>pos,<sp/>limit):</highlight></codeline>
<codeline lineno="2010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>\\(...\\)<sp/>formula.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1adda498be72ffa5da8d95ad08747e00ce" kindref="member">header</ref><sp/>=<sp/>[</highlight><highlight class="stringliteral">&apos;inline&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a1fabfe1641595f82155b123945d55de0" kindref="member">parseupto</ref>(pos,<sp/>limit)</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"></highlight></codeline>
<codeline lineno="2014"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1ad96a5f892e4bba8576591c30bde58bcd" kindref="member">parseblockto</ref>(self,<sp/>pos,<sp/>limit):</highlight></codeline>
<codeline lineno="2015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>\\[...\\]<sp/>formula.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1adda498be72ffa5da8d95ad08747e00ce" kindref="member">header</ref><sp/>=<sp/>[</highlight><highlight class="stringliteral">&apos;block&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a1fabfe1641595f82155b123945d55de0" kindref="member">parseupto</ref>(pos,<sp/>limit)</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"></highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1a1fabfe1641595f82155b123945d55de0" kindref="member">parseupto</ref>(self,<sp/>pos,<sp/>limit):</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>formula<sp/>that<sp/>ends<sp/>with<sp/>the<sp/>given<sp/>command.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.pushending(limit)</highlight></codeline>
<codeline lineno="2022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1acd8f8aacb1be5779b82af63b89320c40" kindref="member">parsed</ref><sp/>=<sp/>pos.glob(</highlight><highlight class="keyword">lambda</highlight><highlight class="normal">:<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.popending(limit)</highlight></codeline>
<codeline lineno="2024"><highlight class="normal"></highlight></codeline>
<codeline lineno="2025"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Formula_1ab0143e961630b61164ad8bf42c87dcc6" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>printable<sp/>representation.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a32ee055d8b38c6357fa517709998d10a" kindref="member">partkey</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a32ee055d8b38c6357fa517709998d10a" kindref="member">partkey</ref>.number:</highlight></codeline>
<codeline lineno="2028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Formula<sp/>(&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a32ee055d8b38c6357fa517709998d10a" kindref="member">partkey</ref>.number<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;)&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Unnumbered<sp/>formula&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2030"><highlight class="normal"></highlight></codeline>
<codeline lineno="2031"><highlight class="normal"></highlight></codeline>
<codeline lineno="2032" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1WholeFormula" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1WholeFormula" kindref="compound">WholeFormula</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>):</highlight></codeline>
<codeline lineno="2033"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>whole<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2034"><highlight class="normal"></highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">detect(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Not<sp/>outside<sp/>the<sp/>formula<sp/>is<sp/>enough.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished()</highlight></codeline>
<codeline lineno="2038"><highlight class="normal"></highlight></codeline>
<codeline lineno="2039"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1WholeFormula_1a572575535cbd4ecd51c2b62ac5bbb795" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>with<sp/>any<sp/>formula<sp/>bit&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.parseany(pos))</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"></highlight></codeline>
<codeline lineno="2044"><highlight class="normal"></highlight></codeline>
<codeline lineno="2045" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory" kindref="compound">FormulaFactory</ref>:</highlight></codeline>
<codeline lineno="2046"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Construct<sp/>bits<sp/>of<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2047"><highlight class="normal"></highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>bit<sp/>types<sp/>will<sp/>be<sp/>appended<sp/>later</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2049"><highlight class="normal"><sp/><sp/><sp/><sp/>types<sp/>=<sp/>[FormulaSymbol,<sp/>RawText,<sp/>FormulaNumber,<sp/>Bracket,<sp/>Comment,<sp/>WhiteSpace]</highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><sp/><sp/>skippedtypes<sp/>=<sp/>[Comment,<sp/>WhiteSpace]</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><sp/><sp/>defining<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2052"><highlight class="normal"></highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a3db2717602d31a011b1fdd8fe6695397" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Initialize<sp/>the<sp/>map<sp/>of<sp/>instances.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a662589cced4fbaf43f2b9f404e1a0d70" kindref="member">instances</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="2056"><highlight class="normal"></highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a53808b08a364800ff86f97a1fec49099" kindref="member">detecttype</ref>(self,<sp/>type,<sp/>pos):</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Detect<sp/>a<sp/>bit<sp/>of<sp/>a<sp/>given<sp/>type.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a9f3ca2a282a03f455bdba18f8c609f97" kindref="member">instance</ref>(type).detect(pos)</highlight></codeline>
<codeline lineno="2062"><highlight class="normal"></highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a9f3ca2a282a03f455bdba18f8c609f97" kindref="member">instance</ref>(self,<sp/>type):</highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>an<sp/>instance<sp/>of<sp/>the<sp/>given<sp/>type.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>type<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a662589cced4fbaf43f2b9f404e1a0d70" kindref="member">instances</ref><sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a662589cced4fbaf43f2b9f404e1a0d70" kindref="member">instances</ref>[type]:</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a662589cced4fbaf43f2b9f404e1a0d70" kindref="member">instances</ref>[type]<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a477293d154b3504a2c9850b0d2aff64a" kindref="member">create</ref>(type)</highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a662589cced4fbaf43f2b9f404e1a0d70" kindref="member">instances</ref>[type]</highlight></codeline>
<codeline lineno="2068"><highlight class="normal"></highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a477293d154b3504a2c9850b0d2aff64a" kindref="member">create</ref>(self,<sp/>type):</highlight></codeline>
<codeline lineno="2070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Create<sp/>a<sp/>new<sp/>formula<sp/>bit<sp/>of<sp/>the<sp/>given<sp/>type.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Cloner.create(type).setfactory(self)</highlight></codeline>
<codeline lineno="2072"><highlight class="normal"></highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a5523b0040bd0ddc17f263a58ec765e5c" kindref="member">clearskipped</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Clear<sp/>any<sp/>skipped<sp/>types.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1ac2a29497283cb5649f046130ad116295" kindref="member">skipany</ref>(pos):</highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2079"><highlight class="normal"></highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1ac2a29497283cb5649f046130ad116295" kindref="member">skipany</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Skip<sp/>any<sp/>skipped<sp/>types.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>type<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a055682c6bae267c8e7d79d2852138c86" kindref="member">skippedtypes</ref>:</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a9f3ca2a282a03f455bdba18f8c609f97" kindref="member">instance</ref>(type).detect(pos):</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1ae802566f0a930c166e4b55dfc3256fdf" kindref="member">parsetype</ref>(type,<sp/>pos)</highlight></codeline>
<codeline lineno="2085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2086"><highlight class="normal"></highlight></codeline>
<codeline lineno="2087"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a05f51ff393bf56d1f51649fdf7b82ff5" kindref="member">parseany</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>any<sp/>formula<sp/>bit<sp/>at<sp/>the<sp/>current<sp/>location.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>type<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a047df401b20b691407d77879fedbc388" kindref="member">types</ref><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a055682c6bae267c8e7d79d2852138c86" kindref="member">skippedtypes</ref>:</highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a53808b08a364800ff86f97a1fec49099" kindref="member">detecttype</ref>(type,<sp/>pos):</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1ae802566f0a930c166e4b55dfc3256fdf" kindref="member">parsetype</ref>(type,<sp/>pos)</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unrecognized<sp/>formula<sp/>at<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.identifier())</highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(pos.skipcurrent())</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"></highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1ae802566f0a930c166e4b55dfc3256fdf" kindref="member">parsetype</ref>(self,<sp/>type,<sp/>pos):</highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>given<sp/>type<sp/>and<sp/>return<sp/>it.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a9f3ca2a282a03f455bdba18f8c609f97" kindref="member">instance</ref>(type)</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a662589cced4fbaf43f2b9f404e1a0d70" kindref="member">instances</ref>[type]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returnedbit<sp/>=<sp/>bit.parsebit(pos)</highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>returnedbit:</highlight></codeline>
<codeline lineno="2101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>returnedbit.setfactory(self)</highlight></codeline>
<codeline lineno="2102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bit</highlight></codeline>
<codeline lineno="2103"><highlight class="normal"></highlight></codeline>
<codeline lineno="2104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1afc245afa141eed451cca92daf1c2504e" kindref="member">parseformula</ref>(self,<sp/>formula):</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>string<sp/>of<sp/>text<sp/>that<sp/>contains<sp/>a<sp/>whole<sp/>formula.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition" kindref="compound">TextPosition</ref>(formula)</highlight></codeline>
<codeline lineno="2107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>whole<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory_1a477293d154b3504a2c9850b0d2aff64a" kindref="member">create</ref>(WholeFormula)</highlight></codeline>
<codeline lineno="2108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>whole.detect(pos):</highlight></codeline>
<codeline lineno="2109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>whole.parsebit(pos)</highlight></codeline>
<codeline lineno="2110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>whole</highlight></codeline>
<codeline lineno="2111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>no<sp/>formula<sp/>found</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unknown<sp/>formula<sp/>at:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.identifier())</highlight></codeline>
<codeline lineno="2114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>whole.add(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().constant(formula,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;unknown&quot;&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="2115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>whole</highlight></codeline>
<codeline lineno="2116"><highlight class="normal"></highlight></codeline>
<codeline lineno="2117"><highlight class="normal"></highlight></codeline>
<codeline lineno="2118" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand" kindref="compound">FormulaCommand</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit" kindref="compound">FormulaBit</ref>):</highlight></codeline>
<codeline lineno="2119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>LaTeX<sp/>command<sp/>inside<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2120"><highlight class="normal"></highlight></codeline>
<codeline lineno="2121"><highlight class="normal"><sp/><sp/><sp/><sp/>types<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="2122"><highlight class="normal"><sp/><sp/><sp/><sp/>start<sp/>=<sp/>FormulaConfig.starts[</highlight><highlight class="stringliteral">&apos;command&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2124"><highlight class="normal"></highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">detect(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>the<sp/>current<sp/>command.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pos.checkfor(FormulaCommand.start)</highlight></codeline>
<codeline lineno="2128"><highlight class="normal"></highlight></codeline>
<codeline lineno="2129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1ae0d2c24258e5f296f7e95c8d7765849a" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>command.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1a4e54bc8ab1652e1920bd69a666984556" kindref="member">extractcommand</ref>(pos)</highlight></codeline>
<codeline lineno="2132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1ab647433afe15499fe9a384deda901612" kindref="member">parsewithcommand</ref>(command,<sp/>pos)</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>bit:</highlight></codeline>
<codeline lineno="2134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bit</highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>command.startswith(</highlight><highlight class="stringliteral">&apos;\\up&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>command.startswith(</highlight><highlight class="stringliteral">&apos;\\Up&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upgreek<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1aee681c63d4f893503db8b6bd04182bd7" kindref="member">parseupgreek</ref>(command,<sp/>pos)</highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>upgreek:</highlight></codeline>
<codeline lineno="2138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>upgreek</highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.defining:</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unknown<sp/>command<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>command)</highlight></codeline>
<codeline lineno="2141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;unknown&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(command))</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2144"><highlight class="normal"></highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1ab647433afe15499fe9a384deda901612" kindref="member">parsewithcommand</ref>(self,<sp/>command,<sp/>pos):</highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>command<sp/>type<sp/>once<sp/>we<sp/>have<sp/>the<sp/>command.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>type<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>FormulaCommand.types:</highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>command<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>type.commandmap:</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1aab51da4da33f2226e1931dace0af8ce3" kindref="member">parsecommandtype</ref>(command,<sp/>type,<sp/>pos)</highlight></codeline>
<codeline lineno="2150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2151"><highlight class="normal"></highlight></codeline>
<codeline lineno="2152"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1aab51da4da33f2226e1931dace0af8ce3" kindref="member">parsecommandtype</ref>(self,<sp/>command,<sp/>type,<sp/>pos):</highlight></codeline>
<codeline lineno="2153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>given<sp/>command<sp/>type.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.create(type)</highlight></codeline>
<codeline lineno="2155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit.setcommand(command)</highlight></codeline>
<codeline lineno="2156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returned<sp/>=<sp/>bit.parsebit(pos)</highlight></codeline>
<codeline lineno="2157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>returned:</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>returned</highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bit</highlight></codeline>
<codeline lineno="2160"><highlight class="normal"></highlight></codeline>
<codeline lineno="2161"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1a4e54bc8ab1652e1920bd69a666984556" kindref="member">extractcommand</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Extract<sp/>the<sp/>command<sp/>from<sp/>the<sp/>current<sp/>position.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.checkskip(FormulaCommand.start):</highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.error(</highlight><highlight class="stringliteral">&apos;Missing<sp/>command<sp/>start<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>FormulaCommand.start)</highlight></codeline>
<codeline lineno="2165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1a7b7e5e223c93b2388eb947fb50094f6e" kindref="member">emptycommand</ref>(pos)</highlight></codeline>
<codeline lineno="2168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.current().isalpha():</highlight></codeline>
<codeline lineno="2169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>alpha<sp/>command</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>FormulaCommand.start<sp/>+<sp/>pos.globalpha()</highlight></codeline>
<codeline lineno="2171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>skip<sp/>mark<sp/>of<sp/>short<sp/>command</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>command</highlight></codeline>
<codeline lineno="2174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>symbol<sp/>command</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>FormulaCommand.start<sp/>+<sp/>pos.skipcurrent()</highlight></codeline>
<codeline lineno="2176"><highlight class="normal"></highlight></codeline>
<codeline lineno="2177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1a7b7e5e223c93b2388eb947fb50094f6e" kindref="member">emptycommand</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Check<sp/>for<sp/>an<sp/>empty<sp/>command:<sp/>look<sp/>for<sp/>command<sp/>disguised<sp/>as<sp/>ending.</highlight></codeline>
<codeline lineno="2179"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Special<sp/>case<sp/>against<sp/>&apos;{<sp/>\\{<sp/>\\}<sp/>}&apos;<sp/>situation.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.isout():</highlight></codeline>
<codeline lineno="2182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ending<sp/>=<sp/>pos.nextending()</highlight></codeline>
<codeline lineno="2183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>ending<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>pos.checkskip(ending):</highlight></codeline>
<codeline lineno="2184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>ending</highlight></codeline>
<codeline lineno="2185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>FormulaCommand.start<sp/>+<sp/>command</highlight></codeline>
<codeline lineno="2186"><highlight class="normal"></highlight></codeline>
<codeline lineno="2187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1aee681c63d4f893503db8b6bd04182bd7" kindref="member">parseupgreek</ref>(self,<sp/>command,<sp/>pos):</highlight></codeline>
<codeline lineno="2188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>Greek<sp/>\\up<sp/>command..&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(command)<sp/>&lt;<sp/>4:</highlight></codeline>
<codeline lineno="2190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>command.startswith(</highlight><highlight class="stringliteral">&apos;\\up&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upcommand<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal"><sp/>+<sp/>command[3:]</highlight></codeline>
<codeline lineno="2193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;\\Up&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upcommand<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal"><sp/>+<sp/>command[3:4].upper()<sp/>+<sp/>command[4:]</highlight></codeline>
<codeline lineno="2195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Impossible<sp/>upgreek<sp/>command:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>command)</highlight></codeline>
<codeline lineno="2197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upgreek<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1ab647433afe15499fe9a384deda901612" kindref="member">parsewithcommand</ref>(upcommand,<sp/>pos)</highlight></codeline>
<codeline lineno="2199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>upgreek:</highlight></codeline>
<codeline lineno="2200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upgreek.type<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;font&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>upgreek</highlight></codeline>
<codeline lineno="2202"><highlight class="normal"></highlight></codeline>
<codeline lineno="2203"><highlight class="normal"></highlight></codeline>
<codeline lineno="2204" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand" kindref="compound">FormulaCommand</ref>):</highlight></codeline>
<codeline lineno="2205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>formula<sp/>bit<sp/>that<sp/>includes<sp/>a<sp/>command&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2206"><highlight class="normal"></highlight></codeline>
<codeline lineno="2207"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a582d2046160f86f42b302386b14833b5" kindref="member">setcommand</ref>(self,<sp/>command):</highlight></codeline>
<codeline lineno="2208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>command<sp/>in<sp/>the<sp/>bit&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a95fbe3c58f2215a4ca4e82cd2221e46b" kindref="member">command</ref><sp/>=<sp/>command</highlight></codeline>
<codeline lineno="2210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1acb6f6cf2c6906152c2114904a808d677" kindref="member">commandmap</ref>:</highlight></codeline>
<codeline lineno="2211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/>command</highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1acb6f6cf2c6906152c2114904a808d677" kindref="member">commandmap</ref>[self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a95fbe3c58f2215a4ca4e82cd2221e46b" kindref="member">command</ref>]</highlight></codeline>
<codeline lineno="2213"><highlight class="normal"></highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1ac20ec3cc2ec2e037c3cbe8efb1a9603c" kindref="member">parseparameter</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>parameter<sp/>at<sp/>the<sp/>current<sp/>position&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.clearskipped(pos)</highlight></codeline>
<codeline lineno="2217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parameter<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.parseany(pos)</highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(parameter)</highlight></codeline>
<codeline lineno="2221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>parameter</highlight></codeline>
<codeline lineno="2222"><highlight class="normal"></highlight></codeline>
<codeline lineno="2223"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1ace5cab1f02f286afd9a0bf546b184295" kindref="member">parsesquare</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>square<sp/>bracket&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.clearskipped(pos)</highlight></codeline>
<codeline lineno="2226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.detecttype(SquareBracket,<sp/>pos):</highlight></codeline>
<codeline lineno="2227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bracket<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.parsetype(SquareBracket,<sp/>pos)</highlight></codeline>
<codeline lineno="2229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(bracket)</highlight></codeline>
<codeline lineno="2230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bracket</highlight></codeline>
<codeline lineno="2231"><highlight class="normal"></highlight></codeline>
<codeline lineno="2232"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af7b8fe9a66b4acdc9fa84b3b8eef60bb" kindref="member">parseliteral</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>literal<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.clearskipped(pos)</highlight></codeline>
<codeline lineno="2235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.detecttype(Bracket,<sp/>pos):</highlight></codeline>
<codeline lineno="2236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.isvalue():</highlight></codeline>
<codeline lineno="2237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;No<sp/>literal<sp/>parameter<sp/>found<sp/>at:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.identifier())</highlight></codeline>
<codeline lineno="2238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pos.globvalue()</highlight></codeline>
<codeline lineno="2240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bracket<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket" kindref="compound">Bracket</ref>().<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1aaf6ab3998cf89b7dd91c4bafa020e784" kindref="member">setfactory</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>)</highlight></codeline>
<codeline lineno="2241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(bracket.parseliteral(pos))</highlight></codeline>
<codeline lineno="2242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bracket.literal</highlight></codeline>
<codeline lineno="2243"><highlight class="normal"></highlight></codeline>
<codeline lineno="2244"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a23a419f24ccc06cbfdb8307b28eba347" kindref="member">parsesquareliteral</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>square<sp/>bracket<sp/>literally.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.clearskipped(pos)</highlight></codeline>
<codeline lineno="2247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.detecttype(SquareBracket,<sp/>pos):</highlight></codeline>
<codeline lineno="2248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bracket<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SquareBracket" kindref="compound">SquareBracket</ref>().<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1aaf6ab3998cf89b7dd91c4bafa020e784" kindref="member">setfactory</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>)</highlight></codeline>
<codeline lineno="2250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(bracket.parseliteral(pos))</highlight></codeline>
<codeline lineno="2251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bracket.literal</highlight></codeline>
<codeline lineno="2252"><highlight class="normal"></highlight></codeline>
<codeline lineno="2253"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a1e2e08561b471a30aa7617a77d2d78db" kindref="member">parsetext</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>text<sp/>parameter.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.clearskipped(pos)</highlight></codeline>
<codeline lineno="2256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.detecttype(Bracket,<sp/>pos):</highlight></codeline>
<codeline lineno="2257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;No<sp/>text<sp/>parameter<sp/>for<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a95fbe3c58f2215a4ca4e82cd2221e46b" kindref="member">command</ref>)</highlight></codeline>
<codeline lineno="2258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bracket<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Bracket" kindref="compound">Bracket</ref>().<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1aaf6ab3998cf89b7dd91c4bafa020e784" kindref="member">setfactory</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>).<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a1e2e08561b471a30aa7617a77d2d78db" kindref="member">parsetext</ref>(pos)</highlight></codeline>
<codeline lineno="2260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(bracket)</highlight></codeline>
<codeline lineno="2261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bracket</highlight></codeline>
<codeline lineno="2262"><highlight class="normal"></highlight></codeline>
<codeline lineno="2263"><highlight class="normal"></highlight></codeline>
<codeline lineno="2264" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyCommand" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyCommand" kindref="compound">EmptyCommand</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>):</highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;An<sp/>empty<sp/>command<sp/>(without<sp/>parameters)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2266"><highlight class="normal"></highlight></codeline>
<codeline lineno="2267"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.commands</highlight></codeline>
<codeline lineno="2268"><highlight class="normal"></highlight></codeline>
<codeline lineno="2269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyCommand_1aa6c88ae3ae468bee9c74c5c97a96616e" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>command<sp/>without<sp/>parameters&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyCommand_1ae5d00a09c88b43efce2ceba75267b754" kindref="member">contents</ref><sp/>=<sp/>[<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref>)]</highlight></codeline>
<codeline lineno="2272"><highlight class="normal"></highlight></codeline>
<codeline lineno="2273"><highlight class="normal"></highlight></codeline>
<codeline lineno="2274" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SpacedCommand" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SpacedCommand" kindref="compound">SpacedCommand</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>):</highlight></codeline>
<codeline lineno="2275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;An<sp/>empty<sp/>command<sp/>which<sp/>should<sp/>have<sp/>math<sp/>spacing<sp/>in<sp/>formulas.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2276"><highlight class="normal"></highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.spacedcommands</highlight></codeline>
<codeline lineno="2278"><highlight class="normal"></highlight></codeline>
<codeline lineno="2279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SpacedCommand_1a2b0ccc4d038d782b6b6dcfe492c1e10d" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Place<sp/>as<sp/>contents<sp/>the<sp/>command<sp/>translated<sp/>and<sp/>spaced.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pad<sp/>with<sp/>MEDIUM<sp/>MATHEMATICAL<sp/>SPACE<sp/>(4/18<sp/>em):<sp/>too<sp/>wide<sp/>in<sp/>STIX<sp/>fonts<sp/>:(</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>self.contents<sp/>=<sp/>[FormulaConstant(&apos;\u205f&apos;<sp/>+<sp/>self.translated<sp/>+<sp/>&apos;\u205f&apos;)]</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>pad<sp/>with<sp/>THIN<sp/>SPACE<sp/>(1/5<sp/>em)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SpacedCommand_1a51a5d043bfa1bc4997498f7455e43e2c" kindref="member">contents</ref><sp/>=<sp/>[<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(</highlight><highlight class="stringliteral">&apos;\u2009&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&apos;\u2009&apos;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="2285"><highlight class="normal"></highlight></codeline>
<codeline lineno="2286"><highlight class="normal"></highlight></codeline>
<codeline lineno="2287" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1AlphaCommand" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1AlphaCommand" kindref="compound">AlphaCommand</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyCommand" kindref="compound">EmptyCommand</ref>):</highlight></codeline>
<codeline lineno="2288"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>command<sp/>without<sp/>parameters<sp/>whose<sp/>result<sp/>is<sp/>alphabetical.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2289"><highlight class="normal"></highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.alphacommands</highlight></codeline>
<codeline lineno="2291"><highlight class="normal"><sp/><sp/><sp/><sp/>greek_capitals<sp/>=<sp/>(</highlight><highlight class="stringliteral">&apos;\\Xi&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\Theta&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\Pi&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\Sigma&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\Gamma&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Lambda&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\Phi&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\Psi&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\Delta&apos;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="2293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;\\Upsilon&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;\\Omega&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2294"><highlight class="normal"></highlight></codeline>
<codeline lineno="2295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1AlphaCommand_1a70258735b3d99d57d10c9fd43e97aeee" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>command<sp/>and<sp/>set<sp/>type<sp/>to<sp/>alpha&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>EmptyCommand.parsebit(self,<sp/>pos)</highlight></codeline>
<codeline lineno="2298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a95fbe3c58f2215a4ca4e82cd2221e46b" kindref="member">command</ref><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1AlphaCommand_1ab36bd5d0d1b014191dee54205f835ab0" kindref="member">greek_capitals</ref>:</highlight></codeline>
<codeline lineno="2299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Greek<sp/>Capital<sp/>letters<sp/>are<sp/>upright<sp/>in<sp/>LaTeX<sp/>default<sp/>math-style.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>use<sp/>italic,<sp/>like<sp/>in<sp/>MathML<sp/>and<sp/>&quot;iso&quot;<sp/>math-style?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a154e7a51f3cb5a3e49f54e59d18a2869" kindref="member">type</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1AlphaCommand_1ac6ec3b99cd9de8e5701cc763e350e838" kindref="member">type</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;alpha&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2302"><highlight class="normal"></highlight></codeline>
<codeline lineno="2303"><highlight class="normal"></highlight></codeline>
<codeline lineno="2304" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction" kindref="compound">OneParamFunction</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>):</highlight></codeline>
<codeline lineno="2305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>function<sp/>of<sp/>one<sp/>parameter&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2306"><highlight class="normal"></highlight></codeline>
<codeline lineno="2307"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.onefunctions</highlight></codeline>
<codeline lineno="2308"><highlight class="normal"><sp/><sp/><sp/><sp/>simplified<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2309"><highlight class="normal"></highlight></codeline>
<codeline lineno="2310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1a65c9cbd5497da6411cbbfe68cd5d7454" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>function<sp/>with<sp/>one<sp/>parameter&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1aae7a79e7563cf9fc921f981eb83564ae" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref>)</highlight></codeline>
<codeline lineno="2313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1ac20ec3cc2ec2e037c3cbe8efb1a9603c" kindref="member">parseparameter</ref>(pos)</highlight></codeline>
<codeline lineno="2314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1af786353fee341dabad6d550b9a48859d" kindref="member">simplifyifpossible</ref>()</highlight></codeline>
<codeline lineno="2315"><highlight class="normal"></highlight></codeline>
<codeline lineno="2316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1af786353fee341dabad6d550b9a48859d" kindref="member">simplifyifpossible</ref>(self):</highlight></codeline>
<codeline lineno="2317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Try<sp/>to<sp/>simplify<sp/>to<sp/>a<sp/>single<sp/>character.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1acb6f6cf2c6906152c2114904a808d677" kindref="member">commandmap</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1aa8f89f4fbb20f0e4087fccd6a40d0822" kindref="member">commandmap</ref>:</highlight></codeline>
<codeline lineno="2319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1aae7a79e7563cf9fc921f981eb83564ae" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FixedOutput" kindref="compound">FixedOutput</ref>()</highlight></codeline>
<codeline lineno="2320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1acc1df7c7ef43a92379f5d211ea1b09f0" kindref="member">html</ref><sp/>=<sp/>[self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1acb6f6cf2c6906152c2114904a808d677" kindref="member">commandmap</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1aa8f89f4fbb20f0e4087fccd6a40d0822" kindref="member">commandmap</ref>[self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref>]]</highlight></codeline>
<codeline lineno="2321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1a27b9ac3a5acca646a917f5af834f1ccf" kindref="member">simplified</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1a414d6f1f881d5551ae61e462720a5a7c" kindref="member">simplified</ref><sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2322"><highlight class="normal"></highlight></codeline>
<codeline lineno="2323"><highlight class="normal"></highlight></codeline>
<codeline lineno="2324" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SymbolFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SymbolFunction" kindref="compound">SymbolFunction</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>):</highlight></codeline>
<codeline lineno="2325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>a<sp/>function<sp/>which<sp/>is<sp/>represented<sp/>by<sp/>a<sp/>symbol<sp/>(like<sp/>_<sp/>or<sp/>^)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2326"><highlight class="normal"></highlight></codeline>
<codeline lineno="2327"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.symbolfunctions</highlight></codeline>
<codeline lineno="2328"><highlight class="normal"></highlight></codeline>
<codeline lineno="2329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">detect(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>the<sp/>symbol&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pos.current()<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>SymbolFunction.commandmap</highlight></codeline>
<codeline lineno="2332"><highlight class="normal"></highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SymbolFunction_1a332ef6b252a737220ac22c6d99cab0fe" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>symbol&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a582d2046160f86f42b302386b14833b5" kindref="member">setcommand</ref>(pos.current())</highlight></codeline>
<codeline lineno="2336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.skip(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a95fbe3c58f2215a4ca4e82cd2221e46b" kindref="member">command</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SymbolFunction_1a0f81778376e28ea28a880a36049f0ec6" kindref="member">command</ref>)</highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1SymbolFunction_1aaabc2bedb0bf275b6a597880cdb76c51" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref>)</highlight></codeline>
<codeline lineno="2338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1ac20ec3cc2ec2e037c3cbe8efb1a9603c" kindref="member">parseparameter</ref>(pos)</highlight></codeline>
<codeline lineno="2339"><highlight class="normal"></highlight></codeline>
<codeline lineno="2340"><highlight class="normal"></highlight></codeline>
<codeline lineno="2341" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextFunction" kindref="compound">TextFunction</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>):</highlight></codeline>
<codeline lineno="2342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>function<sp/>where<sp/>parameters<sp/>are<sp/>read<sp/>as<sp/>text.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2343"><highlight class="normal"></highlight></codeline>
<codeline lineno="2344"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.textfunctions</highlight></codeline>
<codeline lineno="2345"><highlight class="normal"></highlight></codeline>
<codeline lineno="2346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextFunction_1a617df95b1dd39a4b986610a4f370477a" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>text<sp/>parameter&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextFunction_1abc1d5a28255965fb590c1660692d057d" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref>)</highlight></codeline>
<codeline lineno="2349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a1e2e08561b471a30aa7617a77d2d78db" kindref="member">parsetext</ref>(pos)</highlight></codeline>
<codeline lineno="2350"><highlight class="normal"></highlight></codeline>
<codeline lineno="2351"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextFunction_1a21b3473e6c6da153e3dd46fc6a5e6ed2" kindref="member">process</ref>(self):</highlight></codeline>
<codeline lineno="2352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>type<sp/>to<sp/>font&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a154e7a51f3cb5a3e49f54e59d18a2869" kindref="member">type</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextFunction_1a6219fe01c1d1f6bef77f9c7c67997f2e" kindref="member">type</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;font&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2354"><highlight class="normal"></highlight></codeline>
<codeline lineno="2355"><highlight class="normal"></highlight></codeline>
<codeline lineno="2356" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FontFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FontFunction" kindref="compound">FontFunction</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction" kindref="compound">OneParamFunction</ref>):</highlight></codeline>
<codeline lineno="2357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>function<sp/>of<sp/>one<sp/>parameter<sp/>that<sp/>changes<sp/>the<sp/>font.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2358"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>keep<sp/>letters<sp/>italic<sp/>with<sp/>\boldsymbol.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2359"><highlight class="normal"></highlight></codeline>
<codeline lineno="2360"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.fontfunctions</highlight></codeline>
<codeline lineno="2361"><highlight class="normal"></highlight></codeline>
<codeline lineno="2362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FontFunction_1ad66d450f5a327015d8bbb8da1a879d0a" kindref="member">process</ref>(self):</highlight></codeline>
<codeline lineno="2363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Simplify<sp/>if<sp/>possible<sp/>using<sp/>a<sp/>single<sp/>character.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a154e7a51f3cb5a3e49f54e59d18a2869" kindref="member">type</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FontFunction_1a4158b177f1b002eaf8b144a2261454a8" kindref="member">type</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;font&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1af786353fee341dabad6d550b9a48859d" kindref="member">simplifyifpossible</ref>()</highlight></codeline>
<codeline lineno="2366"><highlight class="normal"></highlight></codeline>
<codeline lineno="2367"><highlight class="normal"></highlight></codeline>
<codeline lineno="2368"><highlight class="normal">FormulaFactory.types<sp/>+=<sp/>[FormulaCommand,<sp/>SymbolFunction]</highlight></codeline>
<codeline lineno="2369"><highlight class="normal">FormulaCommand.types<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/><sp/><sp/>AlphaCommand,<sp/>EmptyCommand,<sp/>OneParamFunction,<sp/>FontFunction,</highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/><sp/><sp/>TextFunction,<sp/>SpacedCommand]</highlight></codeline>
<codeline lineno="2372"><highlight class="normal"></highlight></codeline>
<codeline lineno="2373"><highlight class="normal"></highlight></codeline>
<codeline lineno="2374" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket" kindref="compound">BigBracket</ref>:</highlight></codeline>
<codeline lineno="2375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>big<sp/>bracket<sp/>generator.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2376"><highlight class="normal"></highlight></codeline>
<codeline lineno="2377"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a62cfb5cad941b15fc7212c0e66cfa333" kindref="member">__init__</ref>(self,<sp/>size,<sp/>bracket,<sp/>alignment=&apos;l&apos;):</highlight></codeline>
<codeline lineno="2378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Set<sp/>the<sp/>size<sp/>and<sp/>symbol<sp/>for<sp/>the<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a935644dd31c80ba94a26f856ad684d72" kindref="member">size</ref><sp/>=<sp/>size</highlight></codeline>
<codeline lineno="2380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a99bbfdc42848b9f93da5849228b436d1" kindref="member">original</ref><sp/>=<sp/>bracket</highlight></codeline>
<codeline lineno="2381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1ad6c0bb9c4b1ac4634126c158129b35cf" kindref="member">alignment</ref><sp/>=<sp/>alignment</highlight></codeline>
<codeline lineno="2382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>bracket<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>FormulaConfig.bigbrackets:</highlight></codeline>
<codeline lineno="2384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref><sp/>=<sp/>FormulaConfig.bigbrackets[bracket]</highlight></codeline>
<codeline lineno="2385"><highlight class="normal"></highlight></codeline>
<codeline lineno="2386"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a6acc0692d7b3724107ece5455fbc68ff" kindref="member">getpiece</ref>(self,<sp/>index):</highlight></codeline>
<codeline lineno="2387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>nth<sp/>piece<sp/>for<sp/>the<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>function<sp/>=<sp/>getattr(self,<sp/></highlight><highlight class="stringliteral">&apos;getpiece&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>)))</highlight></codeline>
<codeline lineno="2389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>function(index)</highlight></codeline>
<codeline lineno="2390"><highlight class="normal"></highlight></codeline>
<codeline lineno="2391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a3a1afc20f11cc1d161adf36fddf86abb" kindref="member">getpiece1</ref>(self,<sp/>index):</highlight></codeline>
<codeline lineno="2392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>only<sp/>piece<sp/>for<sp/>a<sp/>single-piece<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>[0]</highlight></codeline>
<codeline lineno="2394"><highlight class="normal"></highlight></codeline>
<codeline lineno="2395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa0ed3900676269e44549b5582fc414c0" kindref="member">getpiece3</ref>(self,<sp/>index):</highlight></codeline>
<codeline lineno="2396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>nth<sp/>piece<sp/>for<sp/>a<sp/>3-piece<sp/>bracket:<sp/>parenthesis<sp/>or<sp/>square<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>index<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="2398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>[0]</highlight></codeline>
<codeline lineno="2399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>index<sp/>==<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a935644dd31c80ba94a26f856ad684d72" kindref="member">size</ref><sp/>-<sp/>1:</highlight></codeline>
<codeline lineno="2400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>[-1]</highlight></codeline>
<codeline lineno="2401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>[1]</highlight></codeline>
<codeline lineno="2402"><highlight class="normal"></highlight></codeline>
<codeline lineno="2403"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1af80e1bdd1ab22ed45bcd7f3bd5d5f71c" kindref="member">getpiece4</ref>(self,<sp/>index):</highlight></codeline>
<codeline lineno="2404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>nth<sp/>piece<sp/>for<sp/>a<sp/>4-piece<sp/>bracket:<sp/>curly<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>index<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="2406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>[0]</highlight></codeline>
<codeline lineno="2407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>index<sp/>==<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a935644dd31c80ba94a26f856ad684d72" kindref="member">size</ref><sp/>-<sp/>1:</highlight></codeline>
<codeline lineno="2408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>[3]</highlight></codeline>
<codeline lineno="2409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>index<sp/>==<sp/>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a935644dd31c80ba94a26f856ad684d72" kindref="member">size</ref><sp/>-<sp/>1)/2:</highlight></codeline>
<codeline lineno="2410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>[2]</highlight></codeline>
<codeline lineno="2411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>[1]</highlight></codeline>
<codeline lineno="2412"><highlight class="normal"></highlight></codeline>
<codeline lineno="2413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1ada346e743a7efc41481a88796a04ed8e" kindref="member">getcell</ref>(self,<sp/>index):</highlight></codeline>
<codeline lineno="2414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>bracket<sp/>piece<sp/>as<sp/>an<sp/>array<sp/>cell.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>piece<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a6acc0692d7b3724107ece5455fbc68ff" kindref="member">getpiece</ref>(index)</highlight></codeline>
<codeline lineno="2416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>span<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bracket<sp/>align-&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1ad6c0bb9c4b1ac4634126c158129b35cf" kindref="member">alignment</ref><sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().constant(piece,<sp/>span)</highlight></codeline>
<codeline lineno="2418"><highlight class="normal"></highlight></codeline>
<codeline lineno="2419"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1af336eef66bebc7296b378f73ab96d470" kindref="member">getcontents</ref>(self):</highlight></codeline>
<codeline lineno="2420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>bracket<sp/>as<sp/>an<sp/>array<sp/>or<sp/>as<sp/>a<sp/>single<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a935644dd31c80ba94a26f856ad684d72" kindref="member">size</ref><sp/>==<sp/>1<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1aa5ab4b1bcde58297ab82dea5082aa711" kindref="member">pieces</ref>:</highlight></codeline>
<codeline lineno="2422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a707d3157f6fac7ff15a568ce5525e249" kindref="member">getsinglebracket</ref>()</highlight></codeline>
<codeline lineno="2423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rows<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="2424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>index<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a935644dd31c80ba94a26f856ad684d72" kindref="member">size</ref>):</highlight></codeline>
<codeline lineno="2425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1ada346e743a7efc41481a88796a04ed8e" kindref="member">getcell</ref>(index)</highlight></codeline>
<codeline lineno="2426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rows.append(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().complete([cell],<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;arrayrow&quot;&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="2427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().complete(rows,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;array&quot;&apos;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="2428"><highlight class="normal"></highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a707d3157f6fac7ff15a568ce5525e249" kindref="member">getsinglebracket</ref>(self):</highlight></codeline>
<codeline lineno="2430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>the<sp/>bracket<sp/>as<sp/>a<sp/>single<sp/>sign.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a99bbfdc42848b9f93da5849228b436d1" kindref="member">original</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&apos;.&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().constant(</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;emptydot&quot;&apos;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="2433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>[<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().constant(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket_1a99bbfdc42848b9f93da5849228b436d1" kindref="member">original</ref>,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;stretchy&quot;&apos;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="2434"><highlight class="normal"></highlight></codeline>
<codeline lineno="2435"><highlight class="normal"></highlight></codeline>
<codeline lineno="2436" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaEquation" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaEquation" kindref="compound">FormulaEquation</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>):</highlight></codeline>
<codeline lineno="2437"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>simple<sp/>numbered<sp/>equation.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2438"><highlight class="normal"></highlight></codeline>
<codeline lineno="2439"><highlight class="normal"><sp/><sp/><sp/><sp/>piece<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;equation&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2440"><highlight class="normal"></highlight></codeline>
<codeline lineno="2441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaEquation_1adef5df0fdf9a2ae5061ce6e293b31c65" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>array&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaEquation_1a61aae325f44338355935cfd60700e50d" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput" kindref="compound">ContentsOutput</ref>()</highlight></codeline>
<codeline lineno="2444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.parsetype(WholeFormula,<sp/>pos))</highlight></codeline>
<codeline lineno="2445"><highlight class="normal"></highlight></codeline>
<codeline lineno="2446"><highlight class="normal"></highlight></codeline>
<codeline lineno="2447" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCell" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCell" kindref="compound">FormulaCell</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand" kindref="compound">FormulaCommand</ref>):</highlight></codeline>
<codeline lineno="2448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;An<sp/>array<sp/>cell<sp/>inside<sp/>a<sp/>row&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2449"><highlight class="normal"></highlight></codeline>
<codeline lineno="2450"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCell_1a74fbe4db7993e047200ffa01c0af02d8" kindref="member">setalignment</ref>(self,<sp/>alignment):</highlight></codeline>
<codeline lineno="2451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCell_1ab9eaac6d14b9770b30c09f80526e5d49" kindref="member">alignment</ref><sp/>=<sp/>alignment</highlight></codeline>
<codeline lineno="2452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCell_1a51350fe8eded44bfe479e536a1a37428" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;arraycell<sp/>align-&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>alignment<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="2455"><highlight class="normal"></highlight></codeline>
<codeline lineno="2456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCell_1a4fc5bd1fdcde7cee29b872c96b584502" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.clearskipped(pos)</highlight></codeline>
<codeline lineno="2458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.parsetype(WholeFormula,<sp/>pos))</highlight></codeline>
<codeline lineno="2461"><highlight class="normal"></highlight></codeline>
<codeline lineno="2462"><highlight class="normal"></highlight></codeline>
<codeline lineno="2463" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow" kindref="compound">FormulaRow</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand" kindref="compound">FormulaCommand</ref>):</highlight></codeline>
<codeline lineno="2464"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;An<sp/>array<sp/>row<sp/>inside<sp/>an<sp/>array&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2465"><highlight class="normal"></highlight></codeline>
<codeline lineno="2466"><highlight class="normal"><sp/><sp/><sp/><sp/>cellseparator<sp/>=<sp/>FormulaConfig.array[</highlight><highlight class="stringliteral">&apos;cellseparator&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2467"><highlight class="normal"></highlight></codeline>
<codeline lineno="2468"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1a3cf4d2212777b6f81edaf9e5b96952e9" kindref="member">setalignments</ref>(self,<sp/>alignments):</highlight></codeline>
<codeline lineno="2469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1ad373992602e5c24f04e04689f6ff78d8" kindref="member">alignments</ref><sp/>=<sp/>alignments</highlight></codeline>
<codeline lineno="2470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1a7d3af0949a584db4503a27a8d2d031cc" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;arrayrow&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="2472"><highlight class="normal"></highlight></codeline>
<codeline lineno="2473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1a4f2cbdbd4a09c68d3bbfc8725bdd2e3e" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>whole<sp/>row&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="2476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.pushending(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1a5ffc01a756bf4d96d8f8f74bd6190cb0" kindref="member">cellseparator</ref>,<sp/>optional=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1af1dc968bce078943ce9fd98cdb934bef" kindref="member">createcell</ref>(index)</highlight></codeline>
<codeline lineno="2479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell.parsebit(pos)</highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(cell)</highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.checkskip(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1a5ffc01a756bf4d96d8f8f74bd6190cb0" kindref="member">cellseparator</ref>)</highlight></codeline>
<codeline lineno="2483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1af25ce271ee2f49d0b95b4d8082986c61" kindref="member">contents</ref>)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="2484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1a7d3af0949a584db4503a27a8d2d031cc" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyOutput" kindref="compound">EmptyOutput</ref>()</highlight></codeline>
<codeline lineno="2485"><highlight class="normal"></highlight></codeline>
<codeline lineno="2486"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1af1dc968bce078943ce9fd98cdb934bef" kindref="member">createcell</ref>(self,<sp/>index):</highlight></codeline>
<codeline lineno="2487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Create<sp/>the<sp/>cell<sp/>that<sp/>corresponds<sp/>to<sp/>the<sp/>given<sp/>index.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alignment<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1ad373992602e5c24f04e04689f6ff78d8" kindref="member">alignments</ref>[index<sp/>%<sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaRow_1ad373992602e5c24f04e04689f6ff78d8" kindref="member">alignments</ref>)]</highlight></codeline>
<codeline lineno="2489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.create(FormulaCell).setalignment(alignment)</highlight></codeline>
<codeline lineno="2490"><highlight class="normal"></highlight></codeline>
<codeline lineno="2491"><highlight class="normal"></highlight></codeline>
<codeline lineno="2492" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula" kindref="compound">MultiRowFormula</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>):</highlight></codeline>
<codeline lineno="2493"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>formula<sp/>with<sp/>multiple<sp/>rows.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2494"><highlight class="normal"></highlight></codeline>
<codeline lineno="2495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aa6c7126e0c85b3fc7f64129ab3af5170" kindref="member">parserows</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>all<sp/>rows,<sp/>finish<sp/>when<sp/>no<sp/>more<sp/>row<sp/>ends&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aaa09c6e4fe21f93bd2b68c751e734b32" kindref="member">rows</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="2498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>first<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aa19753a40dd5bcace68866cb193e6302" kindref="member">iteraterows</ref>(pos):</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>first:</highlight></codeline>
<codeline lineno="2501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>first<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>intersparse<sp/>empty<sp/>rows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1ab9598193fde3f94c271e95b0db9669ce" kindref="member">addempty</ref>()</highlight></codeline>
<codeline lineno="2505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row.parsebit(pos)</highlight></codeline>
<codeline lineno="2506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a2022ff548f819b656f1b4ed31a5da0dd" kindref="member">addrow</ref>(row)</highlight></codeline>
<codeline lineno="2507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a1d508aa75109228e5964fc7d795bc202" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a17f4fb88387219a0115ef1e1d5e8beed" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a754821bf1cbf9adcc2c5eac225b5eb00" kindref="member">size</ref><sp/>=<sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aaa09c6e4fe21f93bd2b68c751e734b32" kindref="member">rows</ref>)</highlight></codeline>
<codeline lineno="2508"><highlight class="normal"></highlight></codeline>
<codeline lineno="2509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aa19753a40dd5bcace68866cb193e6302" kindref="member">iteraterows</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Iterate<sp/>over<sp/>all<sp/>rows,<sp/>end<sp/>when<sp/>no<sp/>more<sp/>row<sp/>ends&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rowseparator<sp/>=<sp/>FormulaConfig.array[</highlight><highlight class="stringliteral">&apos;rowseparator&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.pushending(rowseparator,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.create(FormulaRow)</highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>row.setalignments(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a705c20370ecdd9ead2042ac44a44c00e" kindref="member">alignments</ref>)</highlight></codeline>
<codeline lineno="2516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.checkfor(rowseparator):</highlight></codeline>
<codeline lineno="2517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/>pos.popending(rowseparator)</highlight></codeline>
<codeline lineno="2518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2520"><highlight class="normal"></highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1ab9598193fde3f94c271e95b0db9669ce" kindref="member">addempty</ref>(self):</highlight></codeline>
<codeline lineno="2522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Add<sp/>an<sp/>empty<sp/>row.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.create(FormulaRow).setalignments(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a705c20370ecdd9ead2042ac44a44c00e" kindref="member">alignments</ref>)</highlight></codeline>
<codeline lineno="2524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>index,<sp/>originalcell<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aaa09c6e4fe21f93bd2b68c751e734b32" kindref="member">rows</ref>[-1].contents):</highlight></codeline>
<codeline lineno="2525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell<sp/>=<sp/>row.createcell(index)</highlight></codeline>
<codeline lineno="2526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell.add(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(</highlight><highlight class="stringliteral">&apos; &apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="2527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>row.add(cell)</highlight></codeline>
<codeline lineno="2528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a2022ff548f819b656f1b4ed31a5da0dd" kindref="member">addrow</ref>(row)</highlight></codeline>
<codeline lineno="2529"><highlight class="normal"></highlight></codeline>
<codeline lineno="2530"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a2022ff548f819b656f1b4ed31a5da0dd" kindref="member">addrow</ref>(self,<sp/>row):</highlight></codeline>
<codeline lineno="2531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Add<sp/>a<sp/>row<sp/>to<sp/>the<sp/>contents<sp/>and<sp/>to<sp/>the<sp/>list<sp/>of<sp/>rows.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aaa09c6e4fe21f93bd2b68c751e734b32" kindref="member">rows</ref>.append(row)</highlight></codeline>
<codeline lineno="2533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(row)</highlight></codeline>
<codeline lineno="2534"><highlight class="normal"></highlight></codeline>
<codeline lineno="2535"><highlight class="normal"></highlight></codeline>
<codeline lineno="2536" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray" kindref="compound">FormulaArray</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula" kindref="compound">MultiRowFormula</ref>):</highlight></codeline>
<codeline lineno="2537"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;An<sp/>array<sp/>within<sp/>a<sp/>formula&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2538"><highlight class="normal"></highlight></codeline>
<codeline lineno="2539"><highlight class="normal"><sp/><sp/><sp/><sp/>piece<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;array&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2540"><highlight class="normal"></highlight></codeline>
<codeline lineno="2541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray_1a1085dd7d00002d9795eacd7a7f5324b5" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>array&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray_1a7c9ada951d6a348b6737466993e7110a" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;array&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray_1a07ae7838e79f86da7d69a6bb4c5189bc" kindref="member">parsealignments</ref>(pos)</highlight></codeline>
<codeline lineno="2545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aa6c7126e0c85b3fc7f64129ab3af5170" kindref="member">parserows</ref>(pos)</highlight></codeline>
<codeline lineno="2546"><highlight class="normal"></highlight></codeline>
<codeline lineno="2547"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray_1a07ae7838e79f86da7d69a6bb4c5189bc" kindref="member">parsealignments</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>different<sp/>alignments&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>vertical</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray_1a86c4955bb369b4d0cf9b311007e4c2dc" kindref="member">valign</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;c&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>literal<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a23a419f24ccc06cbfdb8307b28eba347" kindref="member">parsesquareliteral</ref>(pos)</highlight></codeline>
<codeline lineno="2552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>literal:</highlight></codeline>
<codeline lineno="2553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray_1a86c4955bb369b4d0cf9b311007e4c2dc" kindref="member">valign</ref><sp/>=<sp/>literal</highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>horizontal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>literal<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af7b8fe9a66b4acdc9fa84b3b8eef60bb" kindref="member">parseliteral</ref>(pos)</highlight></codeline>
<codeline lineno="2556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a705c20370ecdd9ead2042ac44a44c00e" kindref="member">alignments</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray_1a8f99ff1b1a95df5f0c652aa888393ff1" kindref="member">alignments</ref><sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="2557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>s<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>literal:</highlight></codeline>
<codeline lineno="2558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a705c20370ecdd9ead2042ac44a44c00e" kindref="member">alignments</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaArray_1a8f99ff1b1a95df5f0c652aa888393ff1" kindref="member">alignments</ref>.append(s)</highlight></codeline>
<codeline lineno="2559"><highlight class="normal"></highlight></codeline>
<codeline lineno="2560"><highlight class="normal"></highlight></codeline>
<codeline lineno="2561" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaMatrix" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaMatrix" kindref="compound">FormulaMatrix</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula" kindref="compound">MultiRowFormula</ref>):</highlight></codeline>
<codeline lineno="2562"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>matrix<sp/>(array<sp/>with<sp/>center<sp/>alignment).&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2563"><highlight class="normal"></highlight></codeline>
<codeline lineno="2564"><highlight class="normal"><sp/><sp/><sp/><sp/>piece<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;matrix&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2565"><highlight class="normal"></highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaMatrix_1a61f2b7fc6255e55f99ff4b428db37574" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>matrix,<sp/>set<sp/>alignments<sp/>to<sp/>&apos;c&apos;.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaMatrix_1adce3f6512a3cc7f421ea2c798d5a4d66" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;array&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaMatrix_1a5d074d17e925162560d1c9f317820deb" kindref="member">valign</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;c&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a705c20370ecdd9ead2042ac44a44c00e" kindref="member">alignments</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaMatrix_1af0af67697c54b0db02469456fcf116e9" kindref="member">alignments</ref><sp/>=<sp/>[</highlight><highlight class="stringliteral">&apos;c&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aa6c7126e0c85b3fc7f64129ab3af5170" kindref="member">parserows</ref>(pos)</highlight></codeline>
<codeline lineno="2572"><highlight class="normal"></highlight></codeline>
<codeline lineno="2573"><highlight class="normal"></highlight></codeline>
<codeline lineno="2574" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases" kindref="compound">FormulaCases</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula" kindref="compound">MultiRowFormula</ref>):</highlight></codeline>
<codeline lineno="2575"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>cases<sp/>statement&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2576"><highlight class="normal"></highlight></codeline>
<codeline lineno="2577"><highlight class="normal"><sp/><sp/><sp/><sp/>piece<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;cases&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2578"><highlight class="normal"></highlight></codeline>
<codeline lineno="2579"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases_1a25906c454fba74d300a1735c57c3f6d7" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>cases&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases_1adb3259e0bb5fbc75490c6659839d651c" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput" kindref="compound">ContentsOutput</ref>()</highlight></codeline>
<codeline lineno="2582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a705c20370ecdd9ead2042ac44a44c00e" kindref="member">alignments</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases_1a1e3a8da3f3a98ef0fcc05c310a2a35ce" kindref="member">alignments</ref><sp/>=<sp/>[</highlight><highlight class="stringliteral">&apos;l&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;l&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aa6c7126e0c85b3fc7f64129ab3af5170" kindref="member">parserows</ref>(pos)</highlight></codeline>
<codeline lineno="2584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases_1a929313687d5514c2dddc88117394584c" kindref="member">contents</ref>:</highlight></codeline>
<codeline lineno="2585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>cell<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>row.contents:</highlight></codeline>
<codeline lineno="2586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell.output.settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;case<sp/>align-l&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cell.contents.append(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(</highlight><highlight class="stringliteral">&apos; &apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="2588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>array<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().complete(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases_1a929313687d5514c2dddc88117394584c" kindref="member">contents</ref>,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;bracketcases&quot;&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>brace<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket" kindref="compound">BigBracket</ref>(len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases_1a929313687d5514c2dddc88117394584c" kindref="member">contents</ref>),<sp/></highlight><highlight class="stringliteral">&apos;{&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;l&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCases_1a929313687d5514c2dddc88117394584c" kindref="member">contents</ref><sp/>=<sp/>brace.getcontents()<sp/>+<sp/>[array]</highlight></codeline>
<codeline lineno="2591"><highlight class="normal"></highlight></codeline>
<codeline lineno="2592"><highlight class="normal"></highlight></codeline>
<codeline lineno="2593" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment" kindref="compound">EquationEnvironment</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula" kindref="compound">MultiRowFormula</ref>):</highlight></codeline>
<codeline lineno="2594"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>\\begin{}...\\end<sp/>equation<sp/>environment<sp/>with<sp/>rows<sp/>and<sp/>cells.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2595"><highlight class="normal"></highlight></codeline>
<codeline lineno="2596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment_1a69a06462e87f579262e4b482f8911e27" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>whole<sp/>environment.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>environment<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment_1a66e666321a72e613d67160ed5590dea9" kindref="member">piece</ref>.replace(</highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment_1a82200ead6b52d0465e77a0d3e04b8395" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight></codeline>
<codeline lineno="2600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;environment<sp/>%s&quot;&apos;</highlight><highlight class="normal">%environment,<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>environment<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>FormulaConfig.environments:</highlight></codeline>
<codeline lineno="2602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a705c20370ecdd9ead2042ac44a44c00e" kindref="member">alignments</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment_1a450d8ea055f2c56e4a9fcf49dace7e46" kindref="member">alignments</ref><sp/>=<sp/>FormulaConfig.environments[environment]</highlight></codeline>
<codeline lineno="2603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unknown<sp/>equation<sp/>environment<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment_1a66e666321a72e613d67160ed5590dea9" kindref="member">piece</ref>)</highlight></codeline>
<codeline lineno="2605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>print<sp/>in<sp/>red</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment_1a82200ead6b52d0465e77a0d3e04b8395" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;unknown&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(</highlight><highlight class="stringliteral">&apos;\\begin{%s}<sp/>&apos;</highlight><highlight class="normal">%environment))</highlight></codeline>
<codeline lineno="2608"><highlight class="normal"></highlight></codeline>
<codeline lineno="2609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1a705c20370ecdd9ead2042ac44a44c00e" kindref="member">alignments</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EquationEnvironment_1a450d8ea055f2c56e4a9fcf49dace7e46" kindref="member">alignments</ref><sp/>=<sp/>[</highlight><highlight class="stringliteral">&apos;l&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="2610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MultiRowFormula_1aa6c7126e0c85b3fc7f64129ab3af5170" kindref="member">parserows</ref>(pos)</highlight></codeline>
<codeline lineno="2611"><highlight class="normal"></highlight></codeline>
<codeline lineno="2612"><highlight class="normal"></highlight></codeline>
<codeline lineno="2613" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BeginCommand" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BeginCommand" kindref="compound">BeginCommand</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>):</highlight></codeline>
<codeline lineno="2614"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>\\begin{}...\\end<sp/>command<sp/>and<sp/>what<sp/>it<sp/>entails<sp/>(array,<sp/>cases,<sp/>aligned)&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2615"><highlight class="normal"></highlight></codeline>
<codeline lineno="2616"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>{FormulaConfig.array[</highlight><highlight class="stringliteral">&apos;begin&apos;</highlight><highlight class="normal">]:<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">}</highlight></codeline>
<codeline lineno="2617"><highlight class="normal"></highlight></codeline>
<codeline lineno="2618"><highlight class="normal"><sp/><sp/><sp/><sp/>types<sp/>=<sp/>[FormulaEquation,<sp/>FormulaArray,<sp/>FormulaCases,<sp/>FormulaMatrix]</highlight></codeline>
<codeline lineno="2619"><highlight class="normal"></highlight></codeline>
<codeline lineno="2620"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BeginCommand_1a827e7b2c67c0dd78a8e49c36c67aff25" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>begin<sp/>command&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af7b8fe9a66b4acdc9fa84b3b8eef60bb" kindref="member">parseliteral</ref>(pos)</highlight></codeline>
<codeline lineno="2623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BeginCommand_1a97407c844c5464f1bdfa810919b17809" kindref="member">findbit</ref>(command)</highlight></codeline>
<codeline lineno="2624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ending<sp/>=<sp/>FormulaConfig.array[</highlight><highlight class="stringliteral">&apos;end&apos;</highlight><highlight class="normal">]<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;{&apos;</highlight><highlight class="normal"><sp/>+<sp/>command<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.pushending(ending)</highlight></codeline>
<codeline lineno="2626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit.parsebit(pos)</highlight></codeline>
<codeline lineno="2627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a4cf7de7d694f99b1a129c6b41fadc79a" kindref="member">add</ref>(bit)</highlight></codeline>
<codeline lineno="2628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><sp/>+=<sp/>pos.popending(ending)</highlight></codeline>
<codeline lineno="2629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a1d508aa75109228e5964fc7d795bc202" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a17f4fb88387219a0115ef1e1d5e8beed" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BeginCommand_1aa80dc4119873ee9077e55b370faaccd2" kindref="member">size</ref><sp/>=<sp/>bit.size</highlight></codeline>
<codeline lineno="2630"><highlight class="normal"></highlight></codeline>
<codeline lineno="2631"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BeginCommand_1a97407c844c5464f1bdfa810919b17809" kindref="member">findbit</ref>(self,<sp/>piece):</highlight></codeline>
<codeline lineno="2632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>the<sp/>command<sp/>bit<sp/>corresponding<sp/>to<sp/>the<sp/>\\begin{piece}&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>type<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>BeginCommand.types:</highlight></codeline>
<codeline lineno="2634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>piece.replace(</highlight><highlight class="stringliteral">&apos;*&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)<sp/>==<sp/>type.piece:</highlight></codeline>
<codeline lineno="2635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.create(type)</highlight></codeline>
<codeline lineno="2636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.create(EquationEnvironment)</highlight></codeline>
<codeline lineno="2637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit.piece<sp/>=<sp/>piece</highlight></codeline>
<codeline lineno="2638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bit</highlight></codeline>
<codeline lineno="2639"><highlight class="normal"></highlight></codeline>
<codeline lineno="2640"><highlight class="normal"></highlight></codeline>
<codeline lineno="2641"><highlight class="normal">FormulaCommand.types<sp/>+=<sp/>[BeginCommand]</highlight></codeline>
<codeline lineno="2642"><highlight class="normal"></highlight></codeline>
<codeline lineno="2643"><highlight class="normal"></highlight></codeline>
<codeline lineno="2644" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CombiningFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CombiningFunction" kindref="compound">CombiningFunction</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction" kindref="compound">OneParamFunction</ref>):</highlight></codeline>
<codeline lineno="2645"><highlight class="normal"></highlight></codeline>
<codeline lineno="2646"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.combiningfunctions</highlight></codeline>
<codeline lineno="2647"><highlight class="normal"></highlight></codeline>
<codeline lineno="2648"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CombiningFunction_1acad27956449e784c5c62e2aa589ab332" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>combining<sp/>function.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>combining<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref></highlight></codeline>
<codeline lineno="2651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parameter<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CombiningFunction_1a88204c09247c06d628e25f3fab7de6c4" kindref="member">parsesingleparameter</ref>(pos)</highlight></codeline>
<codeline lineno="2652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>parameter:</highlight></codeline>
<codeline lineno="2653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Missing<sp/>parameter<sp/>for<sp/>combining<sp/>function<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a95fbe3c58f2215a4ca4e82cd2221e46b" kindref="member">command</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CombiningFunction_1a6ae6ca34fb1eaebc8d85593c97dcbe66" kindref="member">command</ref>)</highlight></codeline>
<codeline lineno="2654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Trace.message(&apos;apply<sp/>%s<sp/>to<sp/>%r&apos;%(self.command,<sp/>parameter.extracttext()))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>parameter.tree()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(parameter,<sp/>FormulaConstant):</highlight></codeline>
<codeline lineno="2658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>extractor<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContainerExtractor" kindref="compound">ContainerExtractor</ref>(ContainerConfig.extracttext)</highlight></codeline>
<codeline lineno="2660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parameter<sp/>=<sp/>extractor.extract(parameter)[0]</highlight></codeline>
<codeline lineno="2661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>IndexError:</highlight></codeline>
<codeline lineno="2662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;No<sp/>base<sp/>character<sp/>found<sp/>for<sp/>&quot;%s&quot;.&apos;</highlight><highlight class="normal"><sp/>%<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a95fbe3c58f2215a4ca4e82cd2221e46b" kindref="member">command</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CombiningFunction_1a6ae6ca34fb1eaebc8d85593c97dcbe66" kindref="member">command</ref>)</highlight></codeline>
<codeline lineno="2663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Trace.message(&apos;<sp/><sp/>basechar:<sp/>%r&apos;<sp/>%<sp/>parameter.string)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Insert<sp/>combining<sp/>character<sp/>after<sp/>the<sp/>first<sp/>character:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>parameter.string.startswith(</highlight><highlight class="stringliteral">&apos;\u2009&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>2<sp/><sp/></highlight><highlight class="comment">#<sp/>skip<sp/>padding<sp/>by<sp/>SpacedCommand<sp/>and<sp/>FormulaConfig.modified</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="2670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parameter.string<sp/>=<sp/>parameter.string[:i]<sp/>+<sp/>combining<sp/>+<sp/>parameter.string[i:]</highlight></codeline>
<codeline lineno="2671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Use<sp/>pre-composed<sp/>characters<sp/>if<sp/>possible:<sp/>\not{=}<sp/>-&gt;<sp/>≠,<sp/>say.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parameter.string<sp/>=<sp/>unicodedata.normalize(</highlight><highlight class="stringliteral">&apos;NFC&apos;</highlight><highlight class="normal">,<sp/>parameter.string)</highlight></codeline>
<codeline lineno="2673"><highlight class="normal"></highlight></codeline>
<codeline lineno="2674"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CombiningFunction_1a88204c09247c06d628e25f3fab7de6c4" kindref="member">parsesingleparameter</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>parameter,<sp/>or<sp/>a<sp/>single<sp/>letter.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.clearskipped(pos)</highlight></codeline>
<codeline lineno="2677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1ac20ec3cc2ec2e037c3cbe8efb1a9603c" kindref="member">parseparameter</ref>(pos)</highlight></codeline>
<codeline lineno="2680"><highlight class="normal"></highlight></codeline>
<codeline lineno="2681"><highlight class="normal"></highlight></codeline>
<codeline lineno="2682" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OversetFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OversetFunction" kindref="compound">OversetFunction</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction" kindref="compound">OneParamFunction</ref>):</highlight></codeline>
<codeline lineno="2683"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>function<sp/>that<sp/>decorates<sp/>some<sp/>bit<sp/>of<sp/>text<sp/>with<sp/>an<sp/>overset.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2684"><highlight class="normal"></highlight></codeline>
<codeline lineno="2685"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.oversetfunctions</highlight></codeline>
<codeline lineno="2686"><highlight class="normal"></highlight></codeline>
<codeline lineno="2687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OversetFunction_1a95d4c766e616cd12cf3ba9b38dde6b3b" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>an<sp/>overset-function&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>symbol<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref></highlight></codeline>
<codeline lineno="2690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OversetFunction_1afd73a1be389782acb6470d527758c174" kindref="member">symbol</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().constant(symbol,<sp/></highlight><highlight class="stringliteral">&apos;sup&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OversetFunction_1a6572cf54ad842d102b5a78a28b225666" kindref="member">parameter</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1ac20ec3cc2ec2e037c3cbe8efb1a9603c" kindref="member">parseparameter</ref>(pos)</highlight></codeline>
<codeline lineno="2692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1aae7a79e7563cf9fc921f981eb83564ae" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OversetFunction_1a4e9647ac0b1f6dcbbb7422d8b7a70890" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;embellished&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref>.insert(0,<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OversetFunction_1afd73a1be389782acb6470d527758c174" kindref="member">symbol</ref>)</highlight></codeline>
<codeline lineno="2694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OversetFunction_1a6572cf54ad842d102b5a78a28b225666" kindref="member">parameter</ref>.output<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;base&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1af786353fee341dabad6d550b9a48859d" kindref="member">simplifyifpossible</ref>()</highlight></codeline>
<codeline lineno="2696"><highlight class="normal"></highlight></codeline>
<codeline lineno="2697"><highlight class="normal"></highlight></codeline>
<codeline lineno="2698" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1UndersetFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1UndersetFunction" kindref="compound">UndersetFunction</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction" kindref="compound">OneParamFunction</ref>):</highlight></codeline>
<codeline lineno="2699"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>function<sp/>that<sp/>decorates<sp/>some<sp/>bit<sp/>of<sp/>text<sp/>with<sp/>an<sp/>underset.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2700"><highlight class="normal"></highlight></codeline>
<codeline lineno="2701"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.undersetfunctions</highlight></codeline>
<codeline lineno="2702"><highlight class="normal"></highlight></codeline>
<codeline lineno="2703"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1UndersetFunction_1a81997d58f182860f47d75443c3c4fc66" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>an<sp/>underset-function&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>symbol<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref></highlight></codeline>
<codeline lineno="2706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1UndersetFunction_1a2925c618c2ee6587f92e921b91c2069a" kindref="member">symbol</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().constant(symbol,<sp/></highlight><highlight class="stringliteral">&apos;sub&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1UndersetFunction_1ae4455d5692ff952b092ab313b3c47a5e" kindref="member">parameter</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1ac20ec3cc2ec2e037c3cbe8efb1a9603c" kindref="member">parseparameter</ref>(pos)</highlight></codeline>
<codeline lineno="2708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1aae7a79e7563cf9fc921f981eb83564ae" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1UndersetFunction_1a79e1dbe4abf35f290b3085efa37f6d32" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;embellished&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref>.insert(0,<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1UndersetFunction_1a2925c618c2ee6587f92e921b91c2069a" kindref="member">symbol</ref>)</highlight></codeline>
<codeline lineno="2710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1UndersetFunction_1ae4455d5692ff952b092ab313b3c47a5e" kindref="member">parameter</ref>.output<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;base&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction_1af786353fee341dabad6d550b9a48859d" kindref="member">simplifyifpossible</ref>()</highlight></codeline>
<codeline lineno="2712"><highlight class="normal"></highlight></codeline>
<codeline lineno="2713"><highlight class="normal"></highlight></codeline>
<codeline lineno="2714" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitCommand" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitCommand" kindref="compound">LimitCommand</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyCommand" kindref="compound">EmptyCommand</ref>):</highlight></codeline>
<codeline lineno="2715"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>command<sp/>which<sp/>accepts<sp/>limits<sp/>above<sp/>and<sp/>below,<sp/>in<sp/>display<sp/>mode.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2716"><highlight class="normal"></highlight></codeline>
<codeline lineno="2717"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.limitcommands</highlight></codeline>
<codeline lineno="2718"><highlight class="normal"></highlight></codeline>
<codeline lineno="2719"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitCommand_1ae93d74b72ed39b6d733875bfd9b84561" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>limit<sp/>command.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2721"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitCommand_1a8d781c9ce2aab2d4852fa8a6a3f95689" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;limits&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>symbol<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref></highlight></codeline>
<codeline lineno="2723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyCommand_1ae5d00a09c88b43efce2ceba75267b754" kindref="member">contents</ref>.append(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().constant(symbol,<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;limit&quot;&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="2724"><highlight class="normal"></highlight></codeline>
<codeline lineno="2725"><highlight class="normal"></highlight></codeline>
<codeline lineno="2726" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitPreviousCommand" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitPreviousCommand" kindref="compound">LimitPreviousCommand</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitCommand" kindref="compound">LimitCommand</ref>):</highlight></codeline>
<codeline lineno="2727"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>command<sp/>to<sp/>limit<sp/>the<sp/>previous<sp/>command.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2728"><highlight class="normal"></highlight></codeline>
<codeline lineno="2729"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2730"><highlight class="normal"></highlight></codeline>
<codeline lineno="2731"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitPreviousCommand_1a5ae0d4a3eb381658a5d078129ac6dba9" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Do<sp/>nothing.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8b91a542419edff549b43a80cccc3536" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaCommand_1abf4ae670d4bbadb8bc46ffcee29de6ac" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitCommand_1a8d781c9ce2aab2d4852fa8a6a3f95689" kindref="member">output</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitPreviousCommand_1a6d9c5bb9d1702ca02d0c79292749eecc" kindref="member">output</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedOutput" kindref="compound">TaggedOutput</ref>().settag(</highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;limits&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.clearskipped(pos)</highlight></codeline>
<codeline lineno="2735"><highlight class="normal"></highlight></codeline>
<codeline lineno="2736"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitPreviousCommand_1a873d1087eefa788c66acd5c19c55ddf4" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="2737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>printable<sp/>representation.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;Limit<sp/>previous<sp/>command&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2739"><highlight class="normal"></highlight></codeline>
<codeline lineno="2740"><highlight class="normal"></highlight></codeline>
<codeline lineno="2741" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor" kindref="compound">LimitsProcessor</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MathsProcessor" kindref="compound">MathsProcessor</ref>):</highlight></codeline>
<codeline lineno="2742"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>processor<sp/>for<sp/>limits<sp/>inside<sp/>an<sp/>element.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2743"><highlight class="normal"></highlight></codeline>
<codeline lineno="2744"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a79b0c162fe65218d4e888fc65c8fb8c7" kindref="member">process</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Process<sp/>the<sp/>limits<sp/>for<sp/>an<sp/>element.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>Options.simplemath:</highlight></codeline>
<codeline lineno="2747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a0af9ea99d4264e4e13ee6e7e51f8ff31" kindref="member">checklimits</ref>(contents,<sp/>index):</highlight></codeline>
<codeline lineno="2749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a6fd89e92f13824b12676dca42247f2e2" kindref="member">modifylimits</ref>(contents,<sp/>index)</highlight></codeline>
<codeline lineno="2750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a2f0cd023be47947ea6d62bf851612d09" kindref="member">checkscript</ref>(contents,<sp/>index)<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a2f0cd023be47947ea6d62bf851612d09" kindref="member">checkscript</ref>(contents,<sp/>index<sp/>+<sp/>1):</highlight></codeline>
<codeline lineno="2751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a311b3d98478e67f8ea8f3b136d2fb25c" kindref="member">modifyscripts</ref>(contents,<sp/>index)</highlight></codeline>
<codeline lineno="2752"><highlight class="normal"></highlight></codeline>
<codeline lineno="2753"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a0af9ea99d4264e4e13ee6e7e51f8ff31" kindref="member">checklimits</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>if<sp/>the<sp/>current<sp/>position<sp/>has<sp/>a<sp/>limits<sp/>command.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>TODO:<sp/>check<sp/>for<sp/>\limits<sp/>macro</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>DocumentParameters.displaymode:</highlight></codeline>
<codeline lineno="2757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a595792debea43c27df3926656e656a56" kindref="member">checkcommand</ref>(contents,<sp/>index<sp/>+<sp/>1,<sp/>LimitPreviousCommand):</highlight></codeline>
<codeline lineno="2759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a887cb16f31c49177306e8a796245b221" kindref="member">limitsahead</ref>(contents,<sp/>index)</highlight></codeline>
<codeline lineno="2760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(contents[index],<sp/>LimitCommand):</highlight></codeline>
<codeline lineno="2762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a2f0cd023be47947ea6d62bf851612d09" kindref="member">checkscript</ref>(contents,<sp/>index<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="2764"><highlight class="normal"></highlight></codeline>
<codeline lineno="2765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a887cb16f31c49177306e8a796245b221" kindref="member">limitsahead</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Limit<sp/>the<sp/>current<sp/>element<sp/>based<sp/>on<sp/>the<sp/>next.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents[index<sp/>+<sp/>1].add(contents[index].clone())</highlight></codeline>
<codeline lineno="2768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents[index].output<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1EmptyOutput" kindref="compound">EmptyOutput</ref>()</highlight></codeline>
<codeline lineno="2769"><highlight class="normal"></highlight></codeline>
<codeline lineno="2770"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a6fd89e92f13824b12676dca42247f2e2" kindref="member">modifylimits</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Modify<sp/>a<sp/>limits<sp/>commands<sp/>so<sp/>that<sp/>the<sp/>limits<sp/>appear<sp/>above<sp/>and<sp/>below.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>limited<sp/>=<sp/>contents[index]</highlight></codeline>
<codeline lineno="2773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscript<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1acb04cec025c8da86f18447679f7615a6" kindref="member">getlimit</ref>(contents,<sp/>index<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="2774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a2f0cd023be47947ea6d62bf851612d09" kindref="member">checkscript</ref>(contents,<sp/>index<sp/>+<sp/>1):</highlight></codeline>
<codeline lineno="2775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>superscript<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1acb04cec025c8da86f18447679f7615a6" kindref="member">getlimit</ref>(contents,<sp/>index<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="2776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>superscript<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().constant(</highlight><highlight class="stringliteral">&apos;\u2009&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;sup<sp/>class=&quot;limit&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>fix<sp/>order<sp/>if<sp/>source<sp/>is<sp/>x^i</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>subscript.command<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;^&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>superscript,<sp/>subscript<sp/>=<sp/>subscript,<sp/>superscript</highlight></codeline>
<codeline lineno="2781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>limited.contents.append(subscript)</highlight></codeline>
<codeline lineno="2782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>limited.contents.insert(0,<sp/>superscript)</highlight></codeline>
<codeline lineno="2783"><highlight class="normal"></highlight></codeline>
<codeline lineno="2784"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1acb04cec025c8da86f18447679f7615a6" kindref="member">getlimit</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>limit<sp/>for<sp/>a<sp/>limits<sp/>command.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>limit<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a9321c7de54fe6aa216e3d2de000eddd2" kindref="member">getscript</ref>(contents,<sp/>index)</highlight></codeline>
<codeline lineno="2787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>limit.output.tag<sp/>=<sp/>limit.output.tag.replace(</highlight><highlight class="stringliteral">&apos;script&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;limit&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>limit</highlight></codeline>
<codeline lineno="2789"><highlight class="normal"></highlight></codeline>
<codeline lineno="2790"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a311b3d98478e67f8ea8f3b136d2fb25c" kindref="member">modifyscripts</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Modify<sp/>the<sp/>super-<sp/>and<sp/>subscript<sp/>to<sp/>appear<sp/>vertically<sp/>aligned.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subscript<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a9321c7de54fe6aa216e3d2de000eddd2" kindref="member">getscript</ref>(contents,<sp/>index)</highlight></codeline>
<codeline lineno="2793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>subscript<sp/>removed<sp/>so<sp/>instead<sp/>of<sp/>index<sp/>+<sp/>1<sp/>we<sp/>get<sp/>index<sp/>again</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>superscript<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a9321c7de54fe6aa216e3d2de000eddd2" kindref="member">getscript</ref>(contents,<sp/>index)</highlight></codeline>
<codeline lineno="2795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>super-/subscript<sp/>are<sp/>reversed<sp/>if<sp/>source<sp/>is<sp/>x^i_j</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>subscript.command<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;^&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>superscript,<sp/>subscript<sp/>=<sp/>subscript,<sp/>superscript</highlight></codeline>
<codeline lineno="2798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scripts<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().complete([superscript,<sp/>subscript],<sp/></highlight><highlight class="stringliteral">&apos;span<sp/>class=&quot;scripts&quot;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents.insert(index,<sp/>scripts)</highlight></codeline>
<codeline lineno="2800"><highlight class="normal"></highlight></codeline>
<codeline lineno="2801"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a2f0cd023be47947ea6d62bf851612d09" kindref="member">checkscript</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>if<sp/>the<sp/>current<sp/>element<sp/>is<sp/>a<sp/>sub-<sp/>or<sp/>superscript.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a595792debea43c27df3926656e656a56" kindref="member">checkcommand</ref>(contents,<sp/>index,<sp/>SymbolFunction)</highlight></codeline>
<codeline lineno="2804"><highlight class="normal"></highlight></codeline>
<codeline lineno="2805"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a595792debea43c27df3926656e656a56" kindref="member">checkcommand</ref>(self,<sp/>contents,<sp/>index,<sp/>type):</highlight></codeline>
<codeline lineno="2806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>for<sp/>the<sp/>given<sp/>type<sp/>as<sp/>the<sp/>current<sp/>element.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(contents)<sp/>&lt;=<sp/>index:</highlight></codeline>
<codeline lineno="2808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>isinstance(contents[index],<sp/>type)</highlight></codeline>
<codeline lineno="2810"><highlight class="normal"></highlight></codeline>
<codeline lineno="2811"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor_1a9321c7de54fe6aa216e3d2de000eddd2" kindref="member">getscript</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>sub-<sp/>or<sp/>superscript.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit<sp/>=<sp/>contents[index]</highlight></codeline>
<codeline lineno="2814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bit.output.tag<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>class=&quot;script&quot;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>del<sp/>contents[index]</highlight></codeline>
<codeline lineno="2816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bit</highlight></codeline>
<codeline lineno="2817"><highlight class="normal"></highlight></codeline>
<codeline lineno="2818"><highlight class="normal"></highlight></codeline>
<codeline lineno="2819" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketCommand" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketCommand" kindref="compound">BracketCommand</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1OneParamFunction" kindref="compound">OneParamFunction</ref>):</highlight></codeline>
<codeline lineno="2820"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>command<sp/>which<sp/>defines<sp/>a<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2821"><highlight class="normal"></highlight></codeline>
<codeline lineno="2822"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.bracketcommands</highlight></codeline>
<codeline lineno="2823"><highlight class="normal"></highlight></codeline>
<codeline lineno="2824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketCommand_1a1adce05ca2fa6154b3b939f8e608f5e4" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>the<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>OneParamFunction.parsebit(self,<sp/>pos)</highlight></codeline>
<codeline lineno="2827"><highlight class="normal"></highlight></codeline>
<codeline lineno="2828"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketCommand_1ae1a90b6ac5b5992ce6c120b86487029d" kindref="member">create</ref>(self,<sp/>direction,<sp/>character):</highlight></codeline>
<codeline lineno="2829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Create<sp/>the<sp/>bracket<sp/>for<sp/>the<sp/>given<sp/>character.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a38111edc225700d987d43aca658b54f7" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ac7b288c0f2a3ba541b74e5be92a86c66" kindref="member">original</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketCommand_1a1492da75894b80802ea4a13977f2c265" kindref="member">original</ref><sp/>=<sp/>character</highlight></codeline>
<codeline lineno="2831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a95fbe3c58f2215a4ca4e82cd2221e46b" kindref="member">command</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketCommand_1ad22e54e4a71828bf412ce11307422e72" kindref="member">command</ref><sp/>=<sp/></highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal"><sp/>+<sp/>direction</highlight></codeline>
<codeline lineno="2832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketCommand_1a060817eb59c213caf7755dea67e99ab4" kindref="member">contents</ref><sp/>=<sp/>[<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(character)]</highlight></codeline>
<codeline lineno="2833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="2834"><highlight class="normal"></highlight></codeline>
<codeline lineno="2835"><highlight class="normal"></highlight></codeline>
<codeline lineno="2836" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor" kindref="compound">BracketProcessor</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1MathsProcessor" kindref="compound">MathsProcessor</ref>):</highlight></codeline>
<codeline lineno="2837"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>processor<sp/>for<sp/>bracket<sp/>commands.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2838"><highlight class="normal"></highlight></codeline>
<codeline lineno="2839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a83550577517b0b21f9285fe11c235c3d" kindref="member">process</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Convert<sp/>the<sp/>bracket<sp/>using<sp/>Unicode<sp/>pieces,<sp/>if<sp/>possible.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>Options.simplemath:</highlight></codeline>
<codeline lineno="2842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a7f0248b6168cfd44f5e76da083706cf7" kindref="member">checkleft</ref>(contents,<sp/>index):</highlight></codeline>
<codeline lineno="2844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a2dea0bc207d20f942f50f5ca12f1412b" kindref="member">processleft</ref>(contents,<sp/>index)</highlight></codeline>
<codeline lineno="2845"><highlight class="normal"></highlight></codeline>
<codeline lineno="2846"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a2dea0bc207d20f942f50f5ca12f1412b" kindref="member">processleft</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Process<sp/>a<sp/>left<sp/>bracket.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rightindex<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1adf2f5272f3a9e7859b0f0b2cce504c65" kindref="member">findright</ref>(contents,<sp/>index<sp/>+<sp/>1)</highlight></codeline>
<codeline lineno="2849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>rightindex:</highlight></codeline>
<codeline lineno="2850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a19e50ab3a8a9ec82900d7e85a756d3a1" kindref="member">findmax</ref>(contents,<sp/>index,<sp/>rightindex)</highlight></codeline>
<codeline lineno="2852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a1d01fe0b00b2093c60ad9f0bbc25aa53" kindref="member">resize</ref>(contents[index],<sp/>size)</highlight></codeline>
<codeline lineno="2853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a1d01fe0b00b2093c60ad9f0bbc25aa53" kindref="member">resize</ref>(contents[rightindex],<sp/>size)</highlight></codeline>
<codeline lineno="2854"><highlight class="normal"></highlight></codeline>
<codeline lineno="2855"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a7f0248b6168cfd44f5e76da083706cf7" kindref="member">checkleft</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>if<sp/>the<sp/>command<sp/>at<sp/>the<sp/>given<sp/>index<sp/>is<sp/>left.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1aeede21bf2904c1a24ea9737563431ae7" kindref="member">checkdirection</ref>(contents[index],<sp/></highlight><highlight class="stringliteral">&apos;\\left&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2858"><highlight class="normal"></highlight></codeline>
<codeline lineno="2859"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a9874b9976b64db104885d9688b8ba72e" kindref="member">checkright</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>if<sp/>the<sp/>command<sp/>at<sp/>the<sp/>given<sp/>index<sp/>is<sp/>right.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1aeede21bf2904c1a24ea9737563431ae7" kindref="member">checkdirection</ref>(contents[index],<sp/></highlight><highlight class="stringliteral">&apos;\\right&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2862"><highlight class="normal"></highlight></codeline>
<codeline lineno="2863"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1aeede21bf2904c1a24ea9737563431ae7" kindref="member">checkdirection</ref>(self,<sp/>bit,<sp/>command):</highlight></codeline>
<codeline lineno="2864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Check<sp/>if<sp/>the<sp/>given<sp/>bit<sp/>is<sp/>the<sp/>desired<sp/>bracket<sp/>command.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(bit,<sp/>BracketCommand):</highlight></codeline>
<codeline lineno="2866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bit.command<sp/>==<sp/>command</highlight></codeline>
<codeline lineno="2868"><highlight class="normal"></highlight></codeline>
<codeline lineno="2869"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1adf2f5272f3a9e7859b0f0b2cce504c65" kindref="member">findright</ref>(self,<sp/>contents,<sp/>index):</highlight></codeline>
<codeline lineno="2870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>the<sp/>right<sp/>bracket<sp/>starting<sp/>at<sp/>the<sp/>given<sp/>index,<sp/>or<sp/>0.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>depth<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="2872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>index<sp/>&lt;<sp/>len(contents):</highlight></codeline>
<codeline lineno="2873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a7f0248b6168cfd44f5e76da083706cf7" kindref="member">checkleft</ref>(contents,<sp/>index):</highlight></codeline>
<codeline lineno="2874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>depth<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a9874b9976b64db104885d9688b8ba72e" kindref="member">checkright</ref>(contents,<sp/>index):</highlight></codeline>
<codeline lineno="2876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>depth<sp/>-=<sp/>1</highlight></codeline>
<codeline lineno="2877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>depth<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="2878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>index</highlight></codeline>
<codeline lineno="2879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="2880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2881"><highlight class="normal"></highlight></codeline>
<codeline lineno="2882"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a19e50ab3a8a9ec82900d7e85a756d3a1" kindref="member">findmax</ref>(self,<sp/>contents,<sp/>leftindex,<sp/>rightindex):</highlight></codeline>
<codeline lineno="2883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Find<sp/>the<sp/>max<sp/>size<sp/>of<sp/>the<sp/>contents<sp/>between<sp/>the<sp/>two<sp/>given<sp/>indices.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sliced<sp/>=<sp/>contents[leftindex:rightindex]</highlight></codeline>
<codeline lineno="2885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>max(element.size<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>sliced)</highlight></codeline>
<codeline lineno="2886"><highlight class="normal"></highlight></codeline>
<codeline lineno="2887"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor_1a1d01fe0b00b2093c60ad9f0bbc25aa53" kindref="member">resize</ref>(self,<sp/>command,<sp/>size):</highlight></codeline>
<codeline lineno="2888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Resize<sp/>a<sp/>bracket<sp/>command<sp/>to<sp/>the<sp/>given<sp/>size.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>character<sp/>=<sp/>command.extracttext()</highlight></codeline>
<codeline lineno="2890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>alignment<sp/>=<sp/>command.command.replace(</highlight><highlight class="stringliteral">&apos;\\&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bracket<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BigBracket" kindref="compound">BigBracket</ref>(size,<sp/>character,<sp/>alignment)</highlight></codeline>
<codeline lineno="2892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command.output<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ContentsOutput" kindref="compound">ContentsOutput</ref>()</highlight></codeline>
<codeline lineno="2893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>command.contents<sp/>=<sp/>bracket.getcontents()</highlight></codeline>
<codeline lineno="2894"><highlight class="normal"></highlight></codeline>
<codeline lineno="2895"><highlight class="normal"></highlight></codeline>
<codeline lineno="2896"><highlight class="normal">FormulaCommand.types<sp/>+=<sp/>[OversetFunction,<sp/>UndersetFunction,</highlight></codeline>
<codeline lineno="2897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CombiningFunction,<sp/>LimitCommand,<sp/>BracketCommand]</highlight></codeline>
<codeline lineno="2898"><highlight class="normal"></highlight></codeline>
<codeline lineno="2899"><highlight class="normal">FormulaProcessor.processors<sp/>+=<sp/>[</highlight></codeline>
<codeline lineno="2900"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1LimitsProcessor" kindref="compound">LimitsProcessor</ref>(),<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1BracketProcessor" kindref="compound">BracketProcessor</ref>(),</highlight></codeline>
<codeline lineno="2901"><highlight class="normal">]</highlight></codeline>
<codeline lineno="2902"><highlight class="normal"></highlight></codeline>
<codeline lineno="2903"><highlight class="normal"></highlight></codeline>
<codeline lineno="2904" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition" kindref="compound">ParameterDefinition</ref>:</highlight></codeline>
<codeline lineno="2905"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>definition<sp/>of<sp/>a<sp/>parameter<sp/>in<sp/>a<sp/>hybrid<sp/>function.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2906"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;[]<sp/>parameters<sp/>are<sp/>optional,<sp/>{}<sp/>parameters<sp/>are<sp/>mandatory.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2907"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Each<sp/>parameter<sp/>has<sp/>a<sp/>one-character<sp/>name,<sp/>like<sp/>{$1}<sp/>or<sp/>{$p}.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2908"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>parameter<sp/>that<sp/>ends<sp/>in<sp/>!<sp/>like<sp/>{$p!}<sp/>is<sp/>a<sp/>literal.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2909"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Example:<sp/>[$1]{$p!}<sp/>reads<sp/>an<sp/>optional<sp/>parameter<sp/>$1<sp/>and<sp/>a<sp/>literal<sp/>mandatory<sp/>parameter<sp/>p.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2910"><highlight class="normal"></highlight></codeline>
<codeline lineno="2911"><highlight class="normal"><sp/><sp/><sp/><sp/>parambrackets<sp/>=<sp/>[(</highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;]&apos;</highlight><highlight class="normal">),<sp/>(</highlight><highlight class="stringliteral">&apos;{&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;}&apos;</highlight><highlight class="normal">)]</highlight></codeline>
<codeline lineno="2912"><highlight class="normal"></highlight></codeline>
<codeline lineno="2913"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a7db090697e5d57044521aac5cea6b861" kindref="member">__init__</ref>(self):</highlight></codeline>
<codeline lineno="2914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a1fc6f835222884e20b32a9b478db5b48" kindref="member">name</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a15ea798c4ec60f022da58fed1a032bda" kindref="member">literal</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a0bbf65d743a8927f525ac7756eaa1d8c" kindref="member">optional</ref><sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1afeef076f649738ece75a799c223aaf96" kindref="member">value</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a33e9ca5bba803414472066767f42da01" kindref="member">literalvalue</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2919"><highlight class="normal"></highlight></codeline>
<codeline lineno="2920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">parse(self,<sp/>pos):</highlight></codeline>
<codeline lineno="2921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>parameter<sp/>definition:<sp/>[$0],<sp/>{$x},<sp/>{$1!}...&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(opening,<sp/>closing)<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>ParameterDefinition.parambrackets:</highlight></codeline>
<codeline lineno="2923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.checkskip(opening):</highlight></codeline>
<codeline lineno="2924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>opening<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;[&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a0bbf65d743a8927f525ac7756eaa1d8c" kindref="member">optional</ref><sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Wrong<sp/>parameter<sp/>name,<sp/>did<sp/>you<sp/>mean<sp/>$&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.current()<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;?&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a1fc6f835222884e20b32a9b478db5b48" kindref="member">name</ref><sp/>=<sp/>pos.skipcurrent()</highlight></codeline>
<codeline lineno="2930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;!&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="2931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a15ea798c4ec60f022da58fed1a032bda" kindref="member">literal</ref><sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.checkskip(closing):</highlight></codeline>
<codeline lineno="2933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Wrong<sp/>parameter<sp/>closing<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.skipcurrent())</highlight></codeline>
<codeline lineno="2934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self</highlight></codeline>
<codeline lineno="2936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Wrong<sp/>character<sp/>in<sp/>parameter<sp/>template:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.skipcurrent())</highlight></codeline>
<codeline lineno="2937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2938"><highlight class="normal"></highlight></codeline>
<codeline lineno="2939"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1aaf1bdb6752e3aa23b1381637f3be306e" kindref="member">read</ref>(self,<sp/>pos,<sp/>function):</highlight></codeline>
<codeline lineno="2940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>the<sp/>parameter<sp/>itself<sp/>using<sp/>the<sp/>definition.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a15ea798c4ec60f022da58fed1a032bda" kindref="member">literal</ref>:</highlight></codeline>
<codeline lineno="2942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a0bbf65d743a8927f525ac7756eaa1d8c" kindref="member">optional</ref>:</highlight></codeline>
<codeline lineno="2943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a33e9ca5bba803414472066767f42da01" kindref="member">literalvalue</ref><sp/>=<sp/>function.parsesquareliteral(pos)</highlight></codeline>
<codeline lineno="2944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a33e9ca5bba803414472066767f42da01" kindref="member">literalvalue</ref><sp/>=<sp/>function.parseliteral(pos)</highlight></codeline>
<codeline lineno="2946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a33e9ca5bba803414472066767f42da01" kindref="member">literalvalue</ref>:</highlight></codeline>
<codeline lineno="2947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1afeef076f649738ece75a799c223aaf96" kindref="member">value</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a33e9ca5bba803414472066767f42da01" kindref="member">literalvalue</ref>)</highlight></codeline>
<codeline lineno="2948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a0bbf65d743a8927f525ac7756eaa1d8c" kindref="member">optional</ref>:</highlight></codeline>
<codeline lineno="2949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1afeef076f649738ece75a799c223aaf96" kindref="member">value</ref><sp/>=<sp/>function.parsesquare(pos)</highlight></codeline>
<codeline lineno="2950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1afeef076f649738ece75a799c223aaf96" kindref="member">value</ref><sp/>=<sp/>function.parseparameter(pos)</highlight></codeline>
<codeline lineno="2952"><highlight class="normal"></highlight></codeline>
<codeline lineno="2953"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1adf8eac709a3fd454d381224e15d3c636" kindref="member">__str__</ref>(self):</highlight></codeline>
<codeline lineno="2954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>printable<sp/>representation.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;param<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1a1fc6f835222884e20b32a9b478db5b48" kindref="member">name</ref></highlight></codeline>
<codeline lineno="2956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1afeef076f649738ece75a799c223aaf96" kindref="member">value</ref>:</highlight></codeline>
<codeline lineno="2957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition_1afeef076f649738ece75a799c223aaf96" kindref="member">value</ref>)</highlight></codeline>
<codeline lineno="2958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="2959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;<sp/>(empty)&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result</highlight></codeline>
<codeline lineno="2961"><highlight class="normal"></highlight></codeline>
<codeline lineno="2962"><highlight class="normal"></highlight></codeline>
<codeline lineno="2963" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction" kindref="compound">ParameterFunction</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit" kindref="compound">CommandBit</ref>):</highlight></codeline>
<codeline lineno="2964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;A<sp/>function<sp/>with<sp/>a<sp/>variable<sp/>number<sp/>of<sp/>parameters<sp/>defined<sp/>in<sp/>a<sp/>template.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2965"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>parameters<sp/>are<sp/>defined<sp/>as<sp/>a<sp/>parameter<sp/>definition.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2966"><highlight class="normal"></highlight></codeline>
<codeline lineno="2967"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a2842c185a2457a0130d86eba0bf01e9d" kindref="member">readparams</ref>(self,<sp/>readtemplate,<sp/>pos):</highlight></codeline>
<codeline lineno="2968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>the<sp/>params<sp/>according<sp/>to<sp/>the<sp/>template.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref><sp/>=<sp/>{}</highlight></codeline>
<codeline lineno="2970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>paramdef<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a073e81c8d730004844f41b3b7a9e03b9" kindref="member">paramdefs</ref>(readtemplate):</highlight></codeline>
<codeline lineno="2971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paramdef.read(pos,<sp/>self)</highlight></codeline>
<codeline lineno="2972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref>[</highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal"><sp/>+<sp/>paramdef.name]<sp/>=<sp/>paramdef</highlight></codeline>
<codeline lineno="2973"><highlight class="normal"></highlight></codeline>
<codeline lineno="2974"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a073e81c8d730004844f41b3b7a9e03b9" kindref="member">paramdefs</ref>(self,<sp/>readtemplate):</highlight></codeline>
<codeline lineno="2975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>each<sp/>param<sp/>definition<sp/>in<sp/>the<sp/>template&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition" kindref="compound">TextPosition</ref>(readtemplate)</highlight></codeline>
<codeline lineno="2977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="2978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>paramdef<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterDefinition" kindref="compound">ParameterDefinition</ref>().parse(pos)</highlight></codeline>
<codeline lineno="2979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>paramdef:</highlight></codeline>
<codeline lineno="2980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>paramdef</highlight></codeline>
<codeline lineno="2981"><highlight class="normal"></highlight></codeline>
<codeline lineno="2982"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a0904d338e8f861913891896b04263ef0" kindref="member">getparam</ref>(self,<sp/>name):</highlight></codeline>
<codeline lineno="2983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>a<sp/>parameter<sp/>as<sp/>parsed.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>name<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref>:</highlight></codeline>
<codeline lineno="2985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref>[name]</highlight></codeline>
<codeline lineno="2987"><highlight class="normal"></highlight></codeline>
<codeline lineno="2988"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1af070ce4feb55352716c04f8c4febfb16" kindref="member">getvalue</ref>(self,<sp/>name):</highlight></codeline>
<codeline lineno="2989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>value<sp/>of<sp/>a<sp/>parameter.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a0904d338e8f861913891896b04263ef0" kindref="member">getparam</ref>(name).value</highlight></codeline>
<codeline lineno="2991"><highlight class="normal"></highlight></codeline>
<codeline lineno="2992"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a06268700ca1e0e5a857d97e4c4872ded" kindref="member">getliteralvalue</ref>(self,<sp/>name):</highlight></codeline>
<codeline lineno="2993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>literal<sp/>value<sp/>of<sp/>a<sp/>parameter.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>param<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a0904d338e8f861913891896b04263ef0" kindref="member">getparam</ref>(name)</highlight></codeline>
<codeline lineno="2995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>param<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>param.literalvalue:</highlight></codeline>
<codeline lineno="2996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>param.literalvalue</highlight></codeline>
<codeline lineno="2998"><highlight class="normal"></highlight></codeline>
<codeline lineno="2999"><highlight class="normal"></highlight></codeline>
<codeline lineno="3000" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction" kindref="compound">HybridFunction</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction" kindref="compound">ParameterFunction</ref>):</highlight></codeline>
<codeline lineno="3001"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3002"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>parameter<sp/>function<sp/>where<sp/>the<sp/>output<sp/>is<sp/>also<sp/>defined<sp/>using<sp/>a<sp/>template.</highlight></codeline>
<codeline lineno="3003"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>template<sp/>can<sp/>use<sp/>a<sp/>number<sp/>of<sp/>functions;<sp/>each<sp/>function<sp/>has<sp/>an<sp/>associated</highlight></codeline>
<codeline lineno="3004"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>tag.</highlight></codeline>
<codeline lineno="3005"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Example:<sp/>[f0{$1},span<sp/>class=&quot;fbox&quot;]<sp/>defines<sp/>a<sp/>function<sp/>f0<sp/>which<sp/>corresponds</highlight></codeline>
<codeline lineno="3006"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>to<sp/>a<sp/>span<sp/>of<sp/>class<sp/>fbox,<sp/>yielding<sp/>&lt;span<sp/>class=&quot;fbox&quot;&gt;$1&lt;/span&gt;.</highlight></codeline>
<codeline lineno="3007"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Literal<sp/>parameters<sp/>can<sp/>be<sp/>used<sp/>in<sp/>tags<sp/>definitions:</highlight></codeline>
<codeline lineno="3008"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>[f0{$1},span<sp/>style=&quot;color:<sp/>$p;&quot;]</highlight></codeline>
<codeline lineno="3009"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>yields<sp/>&lt;span<sp/>style=&quot;color:<sp/>$p;&quot;&gt;$1&lt;/span&gt;,<sp/>where<sp/>$p<sp/>is<sp/>a<sp/>literal<sp/>parameter.</highlight></codeline>
<codeline lineno="3010"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Sizes<sp/>can<sp/>be<sp/>specified<sp/>in<sp/>hybridsizes,<sp/>e.g.<sp/>adding<sp/>parameter<sp/>sizes.<sp/>By</highlight></codeline>
<codeline lineno="3011"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>default<sp/>the<sp/>resulting<sp/>size<sp/>is<sp/>the<sp/>max<sp/>of<sp/>all<sp/>arguments.<sp/>Sizes<sp/>are<sp/>used</highlight></codeline>
<codeline lineno="3012"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>to<sp/>generate<sp/>the<sp/>right<sp/>parameters.</highlight></codeline>
<codeline lineno="3013"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>A<sp/>function<sp/>followed<sp/>by<sp/>a<sp/>single<sp/>/<sp/>is<sp/>output<sp/>as<sp/>a<sp/>self-closing<sp/>XHTML<sp/>tag:</highlight></codeline>
<codeline lineno="3014"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/>[f0/,hr]</highlight></codeline>
<codeline lineno="3015"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>will<sp/>generate<sp/>&lt;hr/&gt;.</highlight></codeline>
<codeline lineno="3016"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3017"><highlight class="normal"></highlight></codeline>
<codeline lineno="3018"><highlight class="normal"><sp/><sp/><sp/><sp/>commandmap<sp/>=<sp/>FormulaConfig.hybridfunctions</highlight></codeline>
<codeline lineno="3019"><highlight class="normal"></highlight></codeline>
<codeline lineno="3020"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1aef2a67272dc24b36b9eaafb91e9b646f" kindref="member">parsebit</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="3021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Parse<sp/>a<sp/>function<sp/>with<sp/>[]<sp/>and<sp/>{}<sp/>parameters&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>readtemplate<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1af3d7bd2b3a75093e4ab875aa1a315aed" kindref="member">translated</ref>[0]</highlight></codeline>
<codeline lineno="3023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>writetemplate<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1af3d7bd2b3a75093e4ab875aa1a315aed" kindref="member">translated</ref>[1]</highlight></codeline>
<codeline lineno="3024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a2842c185a2457a0130d86eba0bf01e9d" kindref="member">readparams</ref>(readtemplate,<sp/>pos)</highlight></codeline>
<codeline lineno="3025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1ab40c826d8048fcb897c4b2016c356bdc" kindref="member">contents</ref><sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1ad47a1faddb83a8f48146b87fd7704068" kindref="member">writeparams</ref>(writetemplate)</highlight></codeline>
<codeline lineno="3026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1a9e82e1a60e4f50c6ff8eecc90982c5ae" kindref="member">computehybridsize</ref>()</highlight></codeline>
<codeline lineno="3027"><highlight class="normal"></highlight></codeline>
<codeline lineno="3028"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1ad47a1faddb83a8f48146b87fd7704068" kindref="member">writeparams</ref>(self,<sp/>writetemplate):</highlight></codeline>
<codeline lineno="3029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Write<sp/>all<sp/>params<sp/>according<sp/>to<sp/>the<sp/>template&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1af848a7e28cba96b461bb95d6c29fcde8" kindref="member">writepos</ref>(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TextPosition" kindref="compound">TextPosition</ref>(writetemplate))</highlight></codeline>
<codeline lineno="3031"><highlight class="normal"></highlight></codeline>
<codeline lineno="3032"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1af848a7e28cba96b461bb95d6c29fcde8" kindref="member">writepos</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="3033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Write<sp/>all<sp/>params<sp/>as<sp/>read<sp/>in<sp/>the<sp/>parse<sp/>position.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="3035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.finished():</highlight></codeline>
<codeline lineno="3036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="3037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>param<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1ad4fd4e29763d7d0bdff04e26dc29c16d" kindref="member">writeparam</ref>(pos)</highlight></codeline>
<codeline lineno="3038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>param:</highlight></codeline>
<codeline lineno="3039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.append(param)</highlight></codeline>
<codeline lineno="3040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;f&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="3041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>function<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1aa63ef3a6ee3342cb1d626f4574f12f37" kindref="member">writefunction</ref>(pos)</highlight></codeline>
<codeline lineno="3042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>function:</highlight></codeline>
<codeline lineno="3043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>function.type<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.append(function)</highlight></codeline>
<codeline lineno="3045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;(&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="3046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.append(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1a417d5c55aaa45759c99f0917a7a104c4" kindref="member">writebracket</ref>(</highlight><highlight class="stringliteral">&apos;left&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;(&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="3047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;)&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="3048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.append(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1a417d5c55aaa45759c99f0917a7a104c4" kindref="member">writebracket</ref>(</highlight><highlight class="stringliteral">&apos;right&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&apos;)&apos;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="3049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result.append(<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaConstant" kindref="compound">FormulaConstant</ref>(pos.skipcurrent()))</highlight></codeline>
<codeline lineno="3051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>result</highlight></codeline>
<codeline lineno="3052"><highlight class="normal"></highlight></codeline>
<codeline lineno="3053"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1ad4fd4e29763d7d0bdff04e26dc29c16d" kindref="member">writeparam</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="3054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Write<sp/>a<sp/>single<sp/>param<sp/>of<sp/>the<sp/>form<sp/>$0,<sp/>$x...&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.skipcurrent()</highlight></codeline>
<codeline lineno="3056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>name<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref>:</highlight></codeline>
<codeline lineno="3057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unknown<sp/>parameter<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>name)</highlight></codeline>
<codeline lineno="3058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref>[name]:</highlight></codeline>
<codeline lineno="3060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;.&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="3062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref>[name].value.type<sp/>=<sp/>pos.globalpha()</highlight></codeline>
<codeline lineno="3063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref>[name].value</highlight></codeline>
<codeline lineno="3064"><highlight class="normal"></highlight></codeline>
<codeline lineno="3065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1aa63ef3a6ee3342cb1d626f4574f12f37" kindref="member">writefunction</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="3066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Write<sp/>a<sp/>single<sp/>function<sp/>f0,...,fn.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tag<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1ac06f548b4f7ac22831fa2d52e54d82b6" kindref="member">readtag</ref>(pos)</highlight></codeline>
<codeline lineno="3068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>tag:</highlight></codeline>
<codeline lineno="3069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;/&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="3071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>self-closing<sp/>XHTML<sp/>tag,<sp/>such<sp/>as<sp/>&lt;hr/&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().selfcomplete(tag)</highlight></codeline>
<codeline lineno="3073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.checkskip(</highlight><highlight class="stringliteral">&apos;{&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="3074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Function<sp/>should<sp/>be<sp/>defined<sp/>in<sp/>{}&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.pushending(</highlight><highlight class="stringliteral">&apos;}&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>contents<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1af848a7e28cba96b461bb95d6c29fcde8" kindref="member">writepos</ref>(pos)</highlight></codeline>
<codeline lineno="3078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pos.popending()</highlight></codeline>
<codeline lineno="3079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(contents)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="3080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1TaggedBit" kindref="compound">TaggedBit</ref>().complete(contents,<sp/>tag)</highlight></codeline>
<codeline lineno="3082"><highlight class="normal"></highlight></codeline>
<codeline lineno="3083"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1ac06f548b4f7ac22831fa2d52e54d82b6" kindref="member">readtag</ref>(self,<sp/>pos):</highlight></codeline>
<codeline lineno="3084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Get<sp/>the<sp/>tag<sp/>corresponding<sp/>to<sp/>the<sp/>given<sp/>index.<sp/>Does<sp/>parameter<sp/>substitution.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>pos.current().isdigit():</highlight></codeline>
<codeline lineno="3086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Function<sp/>should<sp/>be<sp/>f0,...,f9:<sp/>f&apos;</highlight><highlight class="normal"><sp/>+<sp/>pos.current())</highlight></codeline>
<codeline lineno="3087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>=<sp/>int(pos.skipcurrent())</highlight></codeline>
<codeline lineno="3089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>2<sp/>+<sp/>index<sp/>&gt;<sp/>len(self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1af3d7bd2b3a75093e4ab875aa1a315aed" kindref="member">translated</ref>):</highlight></codeline>
<codeline lineno="3090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Function<sp/>f&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(index)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>is<sp/>not<sp/>defined&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tag<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1af53f1b05dd1dd0bb993bea6e955ad5e8" kindref="member">translated</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1af3d7bd2b3a75093e4ab875aa1a315aed" kindref="member">translated</ref>[2<sp/>+<sp/>index]</highlight></codeline>
<codeline lineno="3093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>tag:</highlight></codeline>
<codeline lineno="3094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tag</highlight></codeline>
<codeline lineno="3095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>variable<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref>:</highlight></codeline>
<codeline lineno="3096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>variable<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>tag:</highlight></codeline>
<codeline lineno="3097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>param<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1ParameterFunction_1a81ce54f397b9880fc64a0bbcc02bf6d1" kindref="member">params</ref>[variable]</highlight></codeline>
<codeline lineno="3098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>param.literal:</highlight></codeline>
<codeline lineno="3099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Parameters<sp/>in<sp/>tag<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>tag<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>should<sp/>be<sp/>literal:<sp/>{&apos;</highlight><highlight class="normal"><sp/>+<sp/>variable<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;!}&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">continue</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>param.literalvalue:</highlight></codeline>
<codeline lineno="3102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/>param.literalvalue</highlight></codeline>
<codeline lineno="3103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tag<sp/>=<sp/>tag.replace(variable,<sp/>value)</highlight></codeline>
<codeline lineno="3106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tag</highlight></codeline>
<codeline lineno="3107"><highlight class="normal"></highlight></codeline>
<codeline lineno="3108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1a417d5c55aaa45759c99f0917a7a104c4" kindref="member">writebracket</ref>(self,<sp/>direction,<sp/>character):</highlight></codeline>
<codeline lineno="3109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Return<sp/>a<sp/>new<sp/>bracket<sp/>looking<sp/>at<sp/>the<sp/>given<sp/>direction.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a425f881ca49adb870a228e1e36afe9a5" kindref="member">factory</ref>.create(BracketCommand).create(direction,<sp/>character)</highlight></codeline>
<codeline lineno="3111"><highlight class="normal"></highlight></codeline>
<codeline lineno="3112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1a9e82e1a60e4f50c6ff8eecc90982c5ae" kindref="member">computehybridsize</ref>(self):</highlight></codeline>
<codeline lineno="3113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Compute<sp/>the<sp/>size<sp/>of<sp/>the<sp/>hybrid<sp/>function.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1CommandBit_1a95fbe3c58f2215a4ca4e82cd2221e46b" kindref="member">command</ref><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>HybridSize.configsizes:</highlight></codeline>
<codeline lineno="3115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a8c49df3aff68981b4969da63fe0de83b" kindref="member">computesize</ref>()</highlight></codeline>
<codeline lineno="3116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a1d508aa75109228e5964fc7d795bc202" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a17f4fb88387219a0115ef1e1d5e8beed" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1a5187ed293231b292f9b78cc61edb8abf" kindref="member">size</ref><sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridSize" kindref="compound">HybridSize</ref>().getsize(self)</highlight></codeline>
<codeline lineno="3118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>set<sp/>the<sp/>size<sp/>in<sp/>all<sp/>elements<sp/>at<sp/>first<sp/>level</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>element<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Container_1a374384437ef42d13c04559cad1d4e409" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1ab88c350397c2680290fe59e19bbeb9a1" kindref="member">contents</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1ab40c826d8048fcb897c4b2016c356bdc" kindref="member">contents</ref>:</highlight></codeline>
<codeline lineno="3120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>element.size<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a1d508aa75109228e5964fc7d795bc202" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaBit_1a17f4fb88387219a0115ef1e1d5e8beed" kindref="member">size</ref><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridFunction_1a5187ed293231b292f9b78cc61edb8abf" kindref="member">size</ref></highlight></codeline>
<codeline lineno="3121"><highlight class="normal"></highlight></codeline>
<codeline lineno="3122"><highlight class="normal"></highlight></codeline>
<codeline lineno="3123" refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridSize" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridSize" kindref="compound">HybridSize</ref>:</highlight></codeline>
<codeline lineno="3124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;The<sp/>size<sp/>associated<sp/>with<sp/>a<sp/>hybrid<sp/>function.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3125"><highlight class="normal"></highlight></codeline>
<codeline lineno="3126"><highlight class="normal"><sp/><sp/><sp/><sp/>configsizes<sp/>=<sp/>FormulaConfig.hybridsizes</highlight></codeline>
<codeline lineno="3127"><highlight class="normal"></highlight></codeline>
<codeline lineno="3128"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridSize_1a9a9d670d1db875452b235801d48f175a" kindref="member">getsize</ref>(self,<sp/>function):</highlight></codeline>
<codeline lineno="3129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Read<sp/>the<sp/>size<sp/>for<sp/>a<sp/>function<sp/>and<sp/>parse<sp/>it.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sizestring<sp/>=<sp/>self.<ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1HybridSize_1ab070e7c1dd07356906e850623509d40d" kindref="member">configsizes</ref>[function.command]</highlight></codeline>
<codeline lineno="3131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>name<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>function.params:</highlight></codeline>
<codeline lineno="3132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>name<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>sizestring:</highlight></codeline>
<codeline lineno="3133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>=<sp/>function.params[name].value.computesize()</highlight></codeline>
<codeline lineno="3134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sizestring<sp/>=<sp/>sizestring.replace(name,<sp/>str(size))</highlight></codeline>
<codeline lineno="3135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;$&apos;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>sizestring:</highlight></codeline>
<codeline lineno="3136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Unconverted<sp/>variable<sp/>in<sp/>hybrid<sp/>size:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>sizestring)</highlight></codeline>
<codeline lineno="3137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1</highlight></codeline>
<codeline lineno="3138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>eval(sizestring)</highlight></codeline>
<codeline lineno="3139"><highlight class="normal"></highlight></codeline>
<codeline lineno="3140"><highlight class="normal"></highlight></codeline>
<codeline lineno="3141"><highlight class="normal">FormulaCommand.types<sp/>+=<sp/>[HybridFunction]</highlight></codeline>
<codeline lineno="3142"><highlight class="normal"></highlight></codeline>
<codeline lineno="3143"><highlight class="normal"></highlight></codeline>
<codeline lineno="3144"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">math2html(formula):</highlight></codeline>
<codeline lineno="3145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Convert<sp/>some<sp/>TeX<sp/>math<sp/>to<sp/>HTML.&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3146"><highlight class="normal"><sp/><sp/><sp/><sp/>factory<sp/>=<sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaFactory" kindref="compound">FormulaFactory</ref>()</highlight></codeline>
<codeline lineno="3147"><highlight class="normal"><sp/><sp/><sp/><sp/>whole<sp/>=<sp/>factory.parseformula(formula)</highlight></codeline>
<codeline lineno="3148"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1FormulaProcessor" kindref="compound">FormulaProcessor</ref>().process(whole)</highlight></codeline>
<codeline lineno="3149"><highlight class="normal"><sp/><sp/><sp/><sp/>whole.process()</highlight></codeline>
<codeline lineno="3150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">.join(whole.gethtml())</highlight></codeline>
<codeline lineno="3151"><highlight class="normal"></highlight></codeline>
<codeline lineno="3152"><highlight class="normal"></highlight></codeline>
<codeline lineno="3153"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacedocutils_1_1utils_1_1math_1_1math2html_1a3fea142332f44db393894335e29fdf45" kindref="member">main</ref>():</highlight></codeline>
<codeline lineno="3154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Main<sp/>function,<sp/>called<sp/>if<sp/>invoked<sp/>from<sp/>the<sp/>command<sp/>line&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3155"><highlight class="normal"><sp/><sp/><sp/><sp/>args<sp/>=<sp/>sys.argv</highlight></codeline>
<codeline lineno="3156"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classdocutils_1_1utils_1_1math_1_1math2html_1_1Options" kindref="compound">Options</ref>().parseoptions(args)</highlight></codeline>
<codeline lineno="3157"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(args)<sp/>!=<sp/>1:</highlight></codeline>
<codeline lineno="3158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Trace.error(</highlight><highlight class="stringliteral">&apos;Usage:<sp/>math2html.py<sp/>escaped_string&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exit()</highlight></codeline>
<codeline lineno="3160"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/>math2html(args[0])</highlight></codeline>
<codeline lineno="3161"><highlight class="normal"><sp/><sp/><sp/><sp/>Trace.message(result)</highlight></codeline>
<codeline lineno="3162"><highlight class="normal"></highlight></codeline>
<codeline lineno="3163"><highlight class="normal"></highlight></codeline>
<codeline lineno="3164"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>__name__<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;__main__&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="3165"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="namespacedocutils_1_1utils_1_1math_1_1math2html_1a3fea142332f44db393894335e29fdf45" kindref="member">main</ref>()</highlight></codeline>
    </programlisting>
    <location file="docs/venv/lib/python3.12/site-packages/docutils/utils/math/math2html.py"/>
  </compounddef>
</doxygen>
