<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="link_8py" kind="file" language="Python">
    <compoundname>link.py</compoundname>
    <innerclass refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash" prot="public">pip::_internal::models::link::LinkHash</innerclass>
    <innerclass refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile" prot="public">pip::_internal::models::link::MetadataFile</innerclass>
    <innerclass refid="classpip_1_1__internal_1_1models_1_1link_1_1Link" prot="public">pip::_internal::models::link::Link</innerclass>
    <innerclass refid="classpip_1_1__internal_1_1models_1_1link_1_1__CleanResult" prot="protected">pip::_internal::models::link::_CleanResult</innerclass>
    <innernamespace refid="namespacepip">pip</innernamespace>
    <innernamespace refid="namespacepip_1_1__internal">pip::_internal</innernamespace>
    <innernamespace refid="namespacepip_1_1__internal_1_1models">pip::_internal::models</innernamespace>
    <innernamespace refid="namespacepip_1_1__internal_1_1models_1_1link">pip::_internal::models::link</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacepip_1_1__internal_1_1models_1_1link" refkind="compound"><highlight class="keyword">import</highlight><highlight class="normal"><sp/>functools</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>itertools</highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>logging</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>os</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>posixpath</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>re</highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>urllib.parse</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>dataclasses<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>dataclass</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>typing<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="10"><highlight class="normal"><sp/><sp/><sp/><sp/>TYPE_CHECKING,</highlight></codeline>
<codeline lineno="11"><highlight class="normal"><sp/><sp/><sp/><sp/>Any,</highlight></codeline>
<codeline lineno="12"><highlight class="normal"><sp/><sp/><sp/><sp/>Dict,</highlight></codeline>
<codeline lineno="13"><highlight class="normal"><sp/><sp/><sp/><sp/>List,</highlight></codeline>
<codeline lineno="14"><highlight class="normal"><sp/><sp/><sp/><sp/>Mapping,</highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/><sp/><sp/><sp/>NamedTuple,</highlight></codeline>
<codeline lineno="16"><highlight class="normal"><sp/><sp/><sp/><sp/>Optional,</highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/>Tuple,</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/>Union,</highlight></codeline>
<codeline lineno="19"><highlight class="normal">)</highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacepip_1_1__internal_1_1utils_1_1deprecation" kindref="compound">pip._internal.utils.deprecation</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>deprecated</highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacepip_1_1__internal_1_1utils_1_1filetypes" kindref="compound">pip._internal.utils.filetypes</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>WHEEL_EXTENSION</highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacepip_1_1__internal_1_1utils_1_1hashes" kindref="compound">pip._internal.utils.hashes</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Hashes</highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacepip_1_1__internal_1_1utils_1_1misc" kindref="compound">pip._internal.utils.misc</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>(</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/>pairwise,</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/>redact_auth_from_url,</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/>split_auth_from_netloc,</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/>splitext,</highlight></codeline>
<codeline lineno="29"><highlight class="normal">)</highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacepip_1_1__internal_1_1utils_1_1models" kindref="compound">pip._internal.utils.models</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>KeyBasedCompareMixin</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacepip_1_1__internal_1_1utils_1_1urls" kindref="compound">pip._internal.utils.urls</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>path_to_url,<sp/>url_to_path</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>TYPE_CHECKING:</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacepip_1_1__internal_1_1index_1_1collector" kindref="compound">pip._internal.index.collector</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>IndexContent</highlight></codeline>
<codeline lineno="35"><highlight class="normal"></highlight></codeline>
<codeline lineno="36"><highlight class="normal">logger<sp/>=<sp/>logging.getLogger(__name__)</highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Order<sp/>matters,<sp/>earlier<sp/>hashes<sp/>have<sp/>a<sp/>precedence<sp/>over<sp/>later<sp/>hashes<sp/>for<sp/>what</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="comment">#<sp/>we<sp/>will<sp/>pick<sp/>to<sp/>use.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal">_SUPPORTED_HASHES<sp/>=<sp/>(</highlight><highlight class="stringliteral">&quot;sha512&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;sha384&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;sha256&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;sha224&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;sha1&quot;</highlight><highlight class="normal">,<sp/></highlight><highlight class="stringliteral">&quot;md5&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">@dataclass(frozen=True)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45" refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash" kindref="compound">LinkHash</ref>:</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Links<sp/>to<sp/>content<sp/>may<sp/>have<sp/>embedded<sp/>hash<sp/>values.<sp/>This<sp/>class<sp/>parses<sp/>those.</highlight></codeline>
<codeline lineno="47"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="48"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>`name`<sp/>must<sp/>be<sp/>any<sp/>member<sp/>of<sp/>`_SUPPORTED_HASHES`.</highlight></codeline>
<codeline lineno="49"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="50"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>class<sp/>can<sp/>be<sp/>converted<sp/>to<sp/>and<sp/>from<sp/>`ArchiveInfo`.<sp/>While<sp/>ArchiveInfo<sp/>intends<sp/>to</highlight></codeline>
<codeline lineno="51"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>be<sp/>JSON-serializable<sp/>to<sp/>conform<sp/>to<sp/>PEP<sp/>610,<sp/>this<sp/>class<sp/>contains<sp/>the<sp/>logic<sp/>for</highlight></codeline>
<codeline lineno="52"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>parsing<sp/>a<sp/>hash<sp/>name<sp/>and<sp/>value<sp/>for<sp/>correctness,<sp/>and<sp/>then<sp/>checking<sp/>whether<sp/>that<sp/>hash</highlight></codeline>
<codeline lineno="53"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>conforms<sp/>to<sp/>a<sp/>schema<sp/>with<sp/>`.is_hash_allowed()`.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/>name:<sp/>str</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/>value:<sp/>str</highlight></codeline>
<codeline lineno="57"><highlight class="normal"></highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/>_hash_url_fragment_re<sp/>=<sp/>re.compile(</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>NB:<sp/>we<sp/>do<sp/>not<sp/>validate<sp/>that<sp/>the<sp/>second<sp/>group<sp/>(.*)<sp/>is<sp/>a<sp/>valid<sp/>hex</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>digest.<sp/>Instead,<sp/>we<sp/>simply<sp/>keep<sp/>that<sp/>string<sp/>in<sp/>this<sp/>class,<sp/>and<sp/>then<sp/>check<sp/>it</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>against<sp/>Hashes<sp/>when<sp/>hash-checking<sp/>is<sp/>needed.<sp/>This<sp/>is<sp/>easier<sp/>to<sp/>debug<sp/>than</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>proactively<sp/>discarding<sp/>an<sp/>invalid<sp/>hex<sp/>digest,<sp/>as<sp/>we<sp/>handle<sp/>incorrect<sp/>hashes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>and<sp/>malformed<sp/>hashes<sp/>in<sp/>the<sp/>same<sp/>place.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;[#&amp;]({choices})=([^&amp;]*)&quot;</highlight><highlight class="normal">.format(</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>choices=</highlight><highlight class="stringliteral">&quot;|&quot;</highlight><highlight class="normal">.join(re.escape(hash_name)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>hash_name<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>_SUPPORTED_HASHES)</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>),</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1ab5f65bc8f56bb0c7792cd375989032bc" kindref="member">__post_init__</ref>(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a89d973000707c1fd036c7e7f113d5eb3" kindref="member">name</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a248d0825354df4795b6bc84aa697316e" kindref="member">name</ref><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>_SUPPORTED_HASHES</highlight></codeline>
<codeline lineno="71"><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@classmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@functools.lru_cache(maxsize=None)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1aa6000508e7283fcebb9d5c6598f4f54f" kindref="member">find_hash_url_fragment</ref>(cls,<sp/>url:<sp/>str)<sp/>-&gt;<sp/>Optional[</highlight><highlight class="stringliteral">&quot;LinkHash&quot;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Search<sp/>a<sp/>string<sp/>for<sp/>a<sp/>checksum<sp/>algorithm<sp/>name<sp/>and<sp/>encoded<sp/>output<sp/>value.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>match<sp/>=<sp/>cls.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a497fedf6a44a206d343081bd97ca9a83" kindref="member">_hash_url_fragment_re</ref>.search(url)</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>match<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name,<sp/>value<sp/>=<sp/>match.groups()</highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cls(name=name,<sp/>value=value)</highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a7fc07b51732dfa238d0cfb9e6180e2b9" kindref="member">as_dict</ref>(self)<sp/>-&gt;<sp/>Dict[str,<sp/>str]:</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>{self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a89d973000707c1fd036c7e7f113d5eb3" kindref="member">name</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a248d0825354df4795b6bc84aa697316e" kindref="member">name</ref>:<sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a66810525adac1c665dae6403c5e9a9ec" kindref="member">value</ref>}</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a7ad4ea270534955d3a4e031076e8d3c7" kindref="member">as_hashes</ref>(self)<sp/>-&gt;<sp/>Hashes:</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>a<sp/>Hashes<sp/>instance<sp/>which<sp/>checks<sp/>only<sp/>for<sp/>the<sp/>current<sp/>hash.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpip_1_1__internal_1_1utils_1_1hashes_1_1Hashes" kindref="compound">Hashes</ref>({self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a89d973000707c1fd036c7e7f113d5eb3" kindref="member">name</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a248d0825354df4795b6bc84aa697316e" kindref="member">name</ref>:<sp/>[self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a66810525adac1c665dae6403c5e9a9ec" kindref="member">value</ref>]})</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a95bfc303b2f9bd554e89861fde71d819" kindref="member">is_hash_allowed</ref>(self,<sp/>hashes:<sp/>Optional[Hashes])<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="91"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>True<sp/>if<sp/>the<sp/>current<sp/>hash<sp/>is<sp/>allowed<sp/>by<sp/>`hashes`.</highlight></codeline>
<codeline lineno="92"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hashes<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>hashes.is_hash_allowed(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a89d973000707c1fd036c7e7f113d5eb3" kindref="member">name</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a248d0825354df4795b6bc84aa697316e" kindref="member">name</ref>,<sp/>hex_digest=self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1LinkHash_1a66810525adac1c665dae6403c5e9a9ec" kindref="member">value</ref>)</highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight><highlight class="preprocessor">@dataclass(frozen=True)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="99" refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile" kindref="compound">MetadataFile</ref>:</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Information<sp/>about<sp/>a<sp/>core<sp/>metadata<sp/>file<sp/>associated<sp/>with<sp/>a<sp/>distribution.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/>hashes:<sp/>Optional[Dict[str,<sp/>str]]</highlight></codeline>
<codeline lineno="103"><highlight class="normal"></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile_1a333d77e50eebbeaecb3de74832c93acb" kindref="member">__post_init__</ref>(self)<sp/>-&gt;<sp/>None:</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile_1a3c4b397f9aa3247504fabec18458f7f6" kindref="member">hashes</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile_1a707293d845bb3f041386d8d98d0b7dce" kindref="member">hashes</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>all(name<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>_SUPPORTED_HASHES<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>name<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile_1a3c4b397f9aa3247504fabec18458f7f6" kindref="member">hashes</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile_1a707293d845bb3f041386d8d98d0b7dce" kindref="member">hashes</ref>)</highlight></codeline>
<codeline lineno="107"><highlight class="normal"></highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1a95dbd2f26684fe069e0056cefce51e8c" kindref="member">supported_hashes</ref>(hashes:<sp/>Optional[Dict[str,<sp/>str]])<sp/>-&gt;<sp/>Optional[Dict[str,<sp/>str]]:</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Remove<sp/>any<sp/>unsupported<sp/>hash<sp/>types<sp/>from<sp/>the<sp/>mapping.<sp/>If<sp/>this<sp/>leaves<sp/>no</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>supported<sp/>hashes,<sp/>return<sp/>None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hashes<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/>hashes<sp/>=<sp/>{n:<sp/>v<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>n,<sp/>v<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>hashes.items()<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>_SUPPORTED_HASHES}</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>hashes:</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>hashes</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1aeb32ba6be9858d9263cd47bec1170d0a" kindref="member">_clean_url_path_part</ref>(part:<sp/>str)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="122"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Clean<sp/>a<sp/>&quot;part&quot;<sp/>of<sp/>a<sp/>URL<sp/>path<sp/>(i.e.<sp/>after<sp/>splitting<sp/>on<sp/>&quot;@&quot;<sp/>characters).</highlight></codeline>
<codeline lineno="123"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>unquote<sp/>prior<sp/>to<sp/>quoting<sp/>to<sp/>make<sp/>sure<sp/>nothing<sp/>is<sp/>double<sp/>quoted.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>urllib.parse.quote(urllib.parse.unquote(part))</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="127"><highlight class="normal"></highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1acdb254c172d1ea3fcbfac3d5b226181a" kindref="member">_clean_file_url_path</ref>(part:<sp/>str)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="130"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Clean<sp/>the<sp/>first<sp/>part<sp/>of<sp/>a<sp/>URL<sp/>path<sp/>that<sp/>corresponds<sp/>to<sp/>a<sp/>local</highlight></codeline>
<codeline lineno="131"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>filesystem<sp/>path<sp/>(i.e.<sp/>the<sp/>first<sp/>part<sp/>after<sp/>splitting<sp/>on<sp/>&quot;@&quot;<sp/>characters).</highlight></codeline>
<codeline lineno="132"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>We<sp/>unquote<sp/>prior<sp/>to<sp/>quoting<sp/>to<sp/>make<sp/>sure<sp/>nothing<sp/>is<sp/>double<sp/>quoted.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Also,<sp/>on<sp/>Windows<sp/>the<sp/>path<sp/>part<sp/>might<sp/>contain<sp/>a<sp/>drive<sp/>letter<sp/>which</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>should<sp/>not<sp/>be<sp/>quoted.<sp/>On<sp/>Linux<sp/>where<sp/>drive<sp/>letters<sp/>do<sp/>not</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>exist,<sp/>the<sp/>colon<sp/>should<sp/>be<sp/>quoted.<sp/>We<sp/>rely<sp/>on<sp/>urllib.request</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>to<sp/>do<sp/>the<sp/>right<sp/>thing<sp/>here.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>urllib.request.pathname2url(urllib.request.url2pathname(part))</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight><highlight class="comment">#<sp/>percent-encoded:<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal">_reserved_chars_re<sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">&quot;(@|%2F)&quot;</highlight><highlight class="normal">,<sp/>re.IGNORECASE)</highlight></codeline>
<codeline lineno="143"><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"></highlight></codeline>
<codeline lineno="145"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1a6f9dedf4481baa466267b78aab3151eb" kindref="member">_clean_url_path</ref>(path:<sp/>str,<sp/>is_local_path:<sp/>bool)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="147"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Clean<sp/>the<sp/>path<sp/>portion<sp/>of<sp/>a<sp/>URL.</highlight></codeline>
<codeline lineno="148"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>is_local_path:</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_func<sp/>=<sp/>_clean_file_url_path</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clean_func<sp/>=<sp/>_clean_url_path_part</highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Split<sp/>on<sp/>the<sp/>reserved<sp/>characters<sp/>prior<sp/>to<sp/>cleaning<sp/>so<sp/>that</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>revision<sp/>strings<sp/>in<sp/>VCS<sp/>URLs<sp/>are<sp/>properly<sp/>preserved.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/>parts<sp/>=<sp/>_reserved_chars_re.split(path)</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/>cleaned_parts<sp/>=<sp/>[]</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>to_clean,<sp/>reserved<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>pairwise(itertools.chain(parts,<sp/>[</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">])):</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cleaned_parts.append(clean_func(to_clean))</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Normalize<sp/>%xx<sp/>escapes<sp/>(e.g.<sp/>%2f<sp/>-&gt;<sp/>%2F)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cleaned_parts.append(reserved.upper())</highlight></codeline>
<codeline lineno="163"><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">.join(cleaned_parts)</highlight></codeline>
<codeline lineno="165"><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1af0b1df16dc5dad28788b3e499ec150b8" kindref="member">_ensure_quoted_url</ref>(url:<sp/>str)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="169"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Make<sp/>sure<sp/>a<sp/>link<sp/>is<sp/>fully<sp/>quoted.</highlight></codeline>
<codeline lineno="170"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>For<sp/>example,<sp/>if<sp/>&apos;<sp/>&apos;<sp/>occurs<sp/>in<sp/>the<sp/>URL,<sp/>it<sp/>will<sp/>be<sp/>replaced<sp/>with<sp/>&quot;%20&quot;,</highlight></codeline>
<codeline lineno="171"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and<sp/>without<sp/>double-quoting<sp/>other<sp/>characters.</highlight></codeline>
<codeline lineno="172"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Split<sp/>the<sp/>URL<sp/>into<sp/>parts<sp/>according<sp/>to<sp/>the<sp/>general<sp/>structure</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>`scheme://netloc/path;parameters?query#fragment`.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/>result<sp/>=<sp/>urllib.parse.urlparse(url)</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>the<sp/>netloc<sp/>is<sp/>empty,<sp/>then<sp/>the<sp/>URL<sp/>refers<sp/>to<sp/>a<sp/>local<sp/>filesystem<sp/>path.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/>is_local_path<sp/>=<sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>result.netloc</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>path<sp/>=<sp/><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1a6f9dedf4481baa466267b78aab3151eb" kindref="member">_clean_url_path</ref>(result.path,<sp/>is_local_path=is_local_path)</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>urllib.parse.urlunparse(result._replace(path=path))</highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight></codeline>
<codeline lineno="182" refid="classpip_1_1__internal_1_1models_1_1link_1_1Link" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link" kindref="compound">Link</ref>(<ref refid="classpip_1_1__internal_1_1utils_1_1models_1_1KeyBasedCompareMixin" kindref="compound">KeyBasedCompareMixin</ref>):</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Represents<sp/>a<sp/>parsed<sp/>link<sp/>from<sp/>a<sp/>Package<sp/>Index&apos;s<sp/>simple<sp/>URL&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>__slots__<sp/>=<sp/>[</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;_parsed_url&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;_url&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;_hashes&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;comes_from&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;requires_python&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;yanked_reason&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;metadata_file_data&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;cache_link_parsing&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;egg_fragment&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/>]</highlight></codeline>
<codeline lineno="196"><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a6aba3315fe8ca6a3d7326281ee97e499" kindref="member">__init__</ref>(</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self,</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>url:<sp/>str,</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>comes_from:<sp/>Optional[Union[str,<sp/></highlight><highlight class="stringliteral">&quot;IndexContent&quot;</highlight><highlight class="normal">]]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requires_python:<sp/>Optional[str]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yanked_reason:<sp/>Optional[str]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data:<sp/>Optional[MetadataFile]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cache_link_parsing:<sp/>bool<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hashes:<sp/>Optional[Mapping[str,<sp/>str]]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="208"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>url:<sp/>url<sp/>of<sp/>the<sp/>resource<sp/>pointed<sp/>to<sp/>(href<sp/>of<sp/>the<sp/>link)</highlight></codeline>
<codeline lineno="209"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>comes_from:<sp/>instance<sp/>of<sp/>IndexContent<sp/>where<sp/>the<sp/>link<sp/>was<sp/>found,</highlight></codeline>
<codeline lineno="210"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>or<sp/>string.</highlight></codeline>
<codeline lineno="211"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>requires_python:<sp/>String<sp/>containing<sp/>the<sp/>`Requires-Python`</highlight></codeline>
<codeline lineno="212"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata<sp/>field,<sp/>specified<sp/>in<sp/>PEP<sp/>345.<sp/>This<sp/>may<sp/>be<sp/>specified<sp/>by</highlight></codeline>
<codeline lineno="213"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>data-requires-python<sp/>attribute<sp/>in<sp/>the<sp/>HTML<sp/>link<sp/>tag,<sp/>as</highlight></codeline>
<codeline lineno="214"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>described<sp/>in<sp/>PEP<sp/>503.</highlight></codeline>
<codeline lineno="215"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>yanked_reason:<sp/>the<sp/>reason<sp/>the<sp/>file<sp/>has<sp/>been<sp/>yanked,<sp/>if<sp/>the</highlight></codeline>
<codeline lineno="216"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file<sp/>has<sp/>been<sp/>yanked,<sp/>or<sp/>None<sp/>if<sp/>the<sp/>file<sp/>hasn&apos;t<sp/>been<sp/>yanked.</highlight></codeline>
<codeline lineno="217"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>is<sp/>the<sp/>value<sp/>of<sp/>the<sp/>&quot;data-yanked&quot;<sp/>attribute,<sp/>if<sp/>present,<sp/>in</highlight></codeline>
<codeline lineno="218"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>simple<sp/>repository<sp/>HTML<sp/>link.<sp/>If<sp/>the<sp/>file<sp/>has<sp/>been<sp/>yanked<sp/>but</highlight></codeline>
<codeline lineno="219"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>no<sp/>reason<sp/>was<sp/>provided,<sp/>this<sp/>should<sp/>be<sp/>the<sp/>empty<sp/>string.<sp/>See</highlight></codeline>
<codeline lineno="220"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PEP<sp/>592<sp/>for<sp/>more<sp/>information<sp/>and<sp/>the<sp/>specification.</highlight></codeline>
<codeline lineno="221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>metadata_file_data:<sp/>the<sp/>metadata<sp/>attached<sp/>to<sp/>the<sp/>file,<sp/>or<sp/>None<sp/>if</highlight></codeline>
<codeline lineno="222"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>no<sp/>such<sp/>metadata<sp/>is<sp/>provided.<sp/>This<sp/>argument,<sp/>if<sp/>not<sp/>None,<sp/>indicates</highlight></codeline>
<codeline lineno="223"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>that<sp/>a<sp/>separate<sp/>metadata<sp/>file<sp/>exists,<sp/>and<sp/>also<sp/>optionally<sp/>supplies</highlight></codeline>
<codeline lineno="224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hashes<sp/>for<sp/>that<sp/>file.</highlight></codeline>
<codeline lineno="225"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>cache_link_parsing:<sp/>A<sp/>flag<sp/>that<sp/>is<sp/>used<sp/>elsewhere<sp/>to<sp/>determine</highlight></codeline>
<codeline lineno="226"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>whether<sp/>resources<sp/>retrieved<sp/>from<sp/>this<sp/>link<sp/>should<sp/>be<sp/>cached.<sp/>PyPI</highlight></codeline>
<codeline lineno="227"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>URLs<sp/>should<sp/>generally<sp/>have<sp/>this<sp/>set<sp/>to<sp/>False,<sp/>for<sp/>example.</highlight></codeline>
<codeline lineno="228"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:param<sp/>hashes:<sp/>A<sp/>mapping<sp/>of<sp/>hash<sp/>names<sp/>to<sp/>digests<sp/>to<sp/>allow<sp/>us<sp/>to</highlight></codeline>
<codeline lineno="229"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>determine<sp/>the<sp/>validity<sp/>of<sp/>a<sp/>download.</highlight></codeline>
<codeline lineno="230"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>comes_from,<sp/>requires_python,<sp/>and<sp/>metadata_file_data<sp/>arguments<sp/>are</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>only<sp/>used<sp/>by<sp/>classmethods<sp/>of<sp/>this<sp/>class,<sp/>and<sp/>are<sp/>not<sp/>used<sp/>in<sp/>client</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>code<sp/>directly.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>url<sp/>can<sp/>be<sp/>a<sp/>UNC<sp/>windows<sp/>share</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>url.startswith(</highlight><highlight class="stringliteral">&quot;\\\\&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>url<sp/>=<sp/>path_to_url(url)</highlight></codeline>
<codeline lineno="239"><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a2bc6f4e878cb4031b3e1a0da05f7c982" kindref="member">_parsed_url</ref><sp/>=<sp/>urllib.parse.urlsplit(url)</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Store<sp/>the<sp/>url<sp/>as<sp/>a<sp/>private<sp/>attribute<sp/>to<sp/>prevent<sp/>accidentally</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>trying<sp/>to<sp/>set<sp/>a<sp/>new<sp/>value.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aec0519677d734b7e5c29ba9218da689d" kindref="member">_url</ref><sp/>=<sp/>url</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>link_hash<sp/>=<sp/>LinkHash.find_hash_url_fragment(url)</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hashes_from_link<sp/>=<sp/>{}<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>link_hash<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>link_hash.as_dict()</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hashes<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a48c0d230c340a21fd28050d07c3dcc5c" kindref="member">_hashes</ref><sp/>=<sp/>hashes_from_link</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a48c0d230c340a21fd28050d07c3dcc5c" kindref="member">_hashes</ref><sp/>=<sp/>{**hashes,<sp/>**hashes_from_link}</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aed0fb4d4320bf51a309c719ef452ec7f" kindref="member">comes_from</ref><sp/>=<sp/>comes_from</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1afbf7631c356c23c439f39b35407161dd" kindref="member">requires_python</ref><sp/>=<sp/>requires_python<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>requires_python<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1af68edcd6a5a6f4c22ea34802fbd83e9c" kindref="member">yanked_reason</ref><sp/>=<sp/>yanked_reason</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1abac655fca8b079dae2a59e2c721bdd48" kindref="member">metadata_file_data</ref><sp/>=<sp/>metadata_file_data</highlight></codeline>
<codeline lineno="256"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>super().<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a6aba3315fe8ca6a3d7326281ee97e499" kindref="member">__init__</ref>(key=url,<sp/>defining_class=Link)</highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a67c7b7d876a4d8531d504aca2238202e" kindref="member">cache_link_parsing</ref><sp/>=<sp/>cache_link_parsing</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a769d8eec219cd78b2717dc057699d74a" kindref="member">egg_fragment</ref><sp/>=<sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1ac92716c3f3ae7898cd2b9c8879c40875" kindref="member">_egg_fragment</ref>()</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@classmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a176cf9f2364e023e9135d8fe51e95c49" kindref="member">from_json</ref>(</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cls,</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file_data:<sp/>Dict[str,<sp/>Any],</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>page_url:<sp/>str,</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Optional[</highlight><highlight class="stringliteral">&quot;Link&quot;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="269"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Convert<sp/>an<sp/>pypi<sp/>json<sp/>document<sp/>from<sp/>a<sp/>simple<sp/>repository<sp/>page<sp/>into<sp/>a<sp/>Link.</highlight></codeline>
<codeline lineno="270"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>file_url<sp/>=<sp/>file_data.get(</highlight><highlight class="stringliteral">&quot;url&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>file_url<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>url<sp/>=<sp/><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1af0b1df16dc5dad28788b3e499ec150b8" kindref="member">_ensure_quoted_url</ref>(urllib.parse.urljoin(page_url,<sp/>file_url))</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pyrequire<sp/>=<sp/>file_data.get(</highlight><highlight class="stringliteral">&quot;requires-python&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yanked_reason<sp/>=<sp/>file_data.get(</highlight><highlight class="stringliteral">&quot;yanked&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hashes<sp/>=<sp/>file_data.get(</highlight><highlight class="stringliteral">&quot;hashes&quot;</highlight><highlight class="normal">,<sp/>{})</highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>PEP<sp/>714:<sp/>Indexes<sp/>must<sp/>use<sp/>the<sp/>name<sp/>core-metadata,<sp/>but</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>clients<sp/>should<sp/>support<sp/>the<sp/>old<sp/>name<sp/>as<sp/>a<sp/>fallback<sp/>for<sp/>compatibility.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_info<sp/>=<sp/>file_data.get(</highlight><highlight class="stringliteral">&quot;core-metadata&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>metadata_info<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_info<sp/>=<sp/>file_data.get(</highlight><highlight class="stringliteral">&quot;dist-info-metadata&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="285"><highlight class="normal"></highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>metadata<sp/>info<sp/>value<sp/>may<sp/>be<sp/>a<sp/>boolean,<sp/>or<sp/>a<sp/>dict<sp/>of<sp/>hashes.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>isinstance(metadata_info,<sp/>dict):</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>file<sp/>exists,<sp/>and<sp/>hashes<sp/>have<sp/>been<sp/>supplied</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data<sp/>=<sp/><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile" kindref="compound">MetadataFile</ref>(<ref refid="namespacepip_1_1__internal_1_1models_1_1link_1a95dbd2f26684fe069e0056cefce51e8c" kindref="member">supported_hashes</ref>(metadata_info))</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>metadata_info:</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>file<sp/>exists,<sp/>but<sp/>there<sp/>are<sp/>no<sp/>hashes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data<sp/>=<sp/><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile" kindref="compound">MetadataFile</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>False<sp/>or<sp/>not<sp/>present:<sp/>the<sp/>file<sp/>does<sp/>not<sp/>exist</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="296"><highlight class="normal"></highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>Link.yanked_reason<sp/>expects<sp/>an<sp/>empty<sp/>string<sp/>instead<sp/>of<sp/>a<sp/>boolean.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>yanked_reason<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>isinstance(yanked_reason,<sp/>str):</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yanked_reason<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>Link.yanked_reason<sp/>expects<sp/>None<sp/>instead<sp/>of<sp/>False.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>yanked_reason:</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yanked_reason<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"></highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cls(</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>url,</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>comes_from=page_url,</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requires_python=pyrequire,</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yanked_reason=yanked_reason,</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hashes=hashes,</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data=metadata_file_data,</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="312"><highlight class="normal"></highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@classmethod</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a1fc31c4f621feeb80e2e54ba874131fd" kindref="member">from_element</ref>(</highlight></codeline>
<codeline lineno="315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cls,</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>anchor_attribs:<sp/>Dict[str,<sp/>Optional[str]],</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>page_url:<sp/>str,</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>base_url:<sp/>str,</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Optional[</highlight><highlight class="stringliteral">&quot;Link&quot;</highlight><highlight class="normal">]:</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="321"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Convert<sp/>an<sp/>anchor<sp/>element&apos;s<sp/>attributes<sp/>in<sp/>a<sp/>simple<sp/>repository<sp/>page<sp/>to<sp/>a<sp/>Link.</highlight></codeline>
<codeline lineno="322"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>href<sp/>=<sp/>anchor_attribs.get(</highlight><highlight class="stringliteral">&quot;href&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>href:</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>url<sp/>=<sp/><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1af0b1df16dc5dad28788b3e499ec150b8" kindref="member">_ensure_quoted_url</ref>(urllib.parse.urljoin(base_url,<sp/>href))</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pyrequire<sp/>=<sp/>anchor_attribs.get(</highlight><highlight class="stringliteral">&quot;data-requires-python&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yanked_reason<sp/>=<sp/>anchor_attribs.get(</highlight><highlight class="stringliteral">&quot;data-yanked&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>PEP<sp/>714:<sp/>Indexes<sp/>must<sp/>use<sp/>the<sp/>name<sp/>data-core-metadata,<sp/>but</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>clients<sp/>should<sp/>support<sp/>the<sp/>old<sp/>name<sp/>as<sp/>a<sp/>fallback<sp/>for<sp/>compatibility.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_info<sp/>=<sp/>anchor_attribs.get(</highlight><highlight class="stringliteral">&quot;data-core-metadata&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>metadata_info<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_info<sp/>=<sp/>anchor_attribs.get(</highlight><highlight class="stringliteral">&quot;data-dist-info-metadata&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>metadata<sp/>info<sp/>value<sp/>may<sp/>be<sp/>the<sp/>string<sp/>&quot;true&quot;,<sp/>or<sp/>a<sp/>string<sp/>of</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>the<sp/>form<sp/>&quot;hashname=hashval&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>metadata_info<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;true&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>file<sp/>exists,<sp/>but<sp/>there<sp/>are<sp/>no<sp/>hashes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data<sp/>=<sp/><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile" kindref="compound">MetadataFile</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>metadata_info<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>file<sp/>does<sp/>not<sp/>exist</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>The<sp/>file<sp/>exists,<sp/>and<sp/>hashes<sp/>have<sp/>been<sp/>supplied</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hashname,<sp/>sep,<sp/>hashval<sp/>=<sp/>metadata_info.partition(</highlight><highlight class="stringliteral">&quot;=&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>sep<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;=&quot;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data<sp/>=<sp/><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile" kindref="compound">MetadataFile</ref>(<ref refid="namespacepip_1_1__internal_1_1models_1_1link_1a95dbd2f26684fe069e0056cefce51e8c" kindref="member">supported_hashes</ref>({hashname:<sp/>hashval}))</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Error<sp/>-<sp/>data<sp/>is<sp/>wrong.<sp/>Treat<sp/>as<sp/>no<sp/>hashes<sp/>supplied.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logger.debug(</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;Index<sp/>returned<sp/>invalid<sp/>data-dist-info-metadata<sp/>value:<sp/>%s&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_info,</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data<sp/>=<sp/><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1MetadataFile" kindref="compound">MetadataFile</ref>(</highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>cls(</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>url,</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>comes_from=page_url,</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>requires_python=pyrequire,</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yanked_reason=yanked_reason,</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_file_data=metadata_file_data,</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="364"><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aea9fc235d37d639ac167cdeac53ba308" kindref="member">__str__</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1afbf7631c356c23c439f39b35407161dd" kindref="member">requires_python</ref>:</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rp<sp/>=<sp/>f</highlight><highlight class="stringliteral">&quot;<sp/>(requires-python:{self.requires_python})&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rp<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aed0fb4d4320bf51a309c719ef452ec7f" kindref="member">comes_from</ref>:</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight><highlight class="stringliteral">&quot;{redact_auth_from_url(self._url)}<sp/>(from<sp/>{self.comes_from}){rp}&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>redact_auth_from_url(str(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aec0519677d734b7e5c29ba9218da689d" kindref="member">_url</ref>))</highlight></codeline>
<codeline lineno="374"><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a851368df15250db2c52515f1e46a1f5f" kindref="member">__repr__</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight><highlight class="stringliteral">&quot;&lt;Link<sp/>{self}&gt;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1af67004cdb29d12b7420984c694262af3" kindref="member">url</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aec0519677d734b7e5c29ba9218da689d" kindref="member">_url</ref></highlight></codeline>
<codeline lineno="381"><highlight class="normal"></highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a5fb02f5a5a42909c89a18745b74cf998" kindref="member">filename</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>path<sp/>=<sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a30f454216dcb615e3ed986238490f180" kindref="member">path</ref>.rstrip(</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/>posixpath.basename(path)</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>name:</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Make<sp/>sure<sp/>we<sp/>don&apos;t<sp/>leak<sp/>auth<sp/>information<sp/>if<sp/>the<sp/>netloc</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>includes<sp/>a<sp/>username<sp/>and<sp/>password.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>netloc,<sp/>user_pass<sp/>=<sp/>split_auth_from_netloc(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a3b75bb1dffe191f8f61239e8af2135cc" kindref="member">netloc</ref>)</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>netloc</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>=<sp/>urllib.parse.unquote(name)</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">assert</highlight><highlight class="normal"><sp/>name,<sp/>f</highlight><highlight class="stringliteral">&quot;URL<sp/>{self._url!r}<sp/>produced<sp/>no<sp/>filename&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>name</highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a6542bec4aeec14279b094156837dedea" kindref="member">file_path</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>url_to_path(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1af67004cdb29d12b7420984c694262af3" kindref="member">url</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a6a4e9c09f8076390a11cc9b3fe51aede" kindref="member">url</ref>)</highlight></codeline>
<codeline lineno="399"><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1afdca198c0e56ff076b7d7eaef8be922e" kindref="member">scheme</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a2bc6f4e878cb4031b3e1a0da05f7c982" kindref="member">_parsed_url</ref>.scheme</highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a3b75bb1dffe191f8f61239e8af2135cc" kindref="member">netloc</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="407"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>can<sp/>contain<sp/>auth<sp/>information.</highlight></codeline>
<codeline lineno="408"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a2bc6f4e878cb4031b3e1a0da05f7c982" kindref="member">_parsed_url</ref>.netloc</highlight></codeline>
<codeline lineno="410"><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">path(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>urllib.parse.unquote(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a2bc6f4e878cb4031b3e1a0da05f7c982" kindref="member">_parsed_url</ref>.path)</highlight></codeline>
<codeline lineno="414"><highlight class="normal"></highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">splitext(self)<sp/>-&gt;<sp/>Tuple[str,<sp/>str]:</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>splitext(posixpath.basename(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a30f454216dcb615e3ed986238490f180" kindref="member">path</ref>.rstrip(</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">)))</highlight></codeline>
<codeline lineno="417"><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a638d7375efa13338c3579494c34ed159" kindref="member">ext</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a3da1e2b2ae97e76a77b134b6024b2aa9" kindref="member">splitext</ref>()[1]</highlight></codeline>
<codeline lineno="421"><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a1453871423228f04baaa00bb3ecc2594" kindref="member">url_without_fragment</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>scheme,<sp/>netloc,<sp/>path,<sp/>query,<sp/>fragment<sp/>=<sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a2bc6f4e878cb4031b3e1a0da05f7c982" kindref="member">_parsed_url</ref></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>urllib.parse.urlunsplit((scheme,<sp/>netloc,<sp/>path,<sp/>query,<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">))</highlight></codeline>
<codeline lineno="426"><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/>_egg_fragment_re<sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">r&quot;[#&amp;]egg=([^&amp;]*)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="428"><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Per<sp/>PEP<sp/>508.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/>_project_name_re<sp/>=<sp/>re.compile(</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">r&quot;^([A-Z0-9]|[A-Z0-9][A-Z0-9._-]*[A-Z0-9])$&quot;</highlight><highlight class="normal">,<sp/>re.IGNORECASE</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1ac92716c3f3ae7898cd2b9c8879c40875" kindref="member">_egg_fragment</ref>(self)<sp/>-&gt;<sp/>Optional[str]:</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>match<sp/>=<sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a95651e61aa9f23805824835c9d4c086e" kindref="member">_egg_fragment_re</ref>.search(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aec0519677d734b7e5c29ba9218da689d" kindref="member">_url</ref>)</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>match:</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>An<sp/>egg<sp/>fragment<sp/>looks<sp/>like<sp/>a<sp/>PEP<sp/>508<sp/>project<sp/>name,<sp/>along<sp/>with</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>an<sp/>optional<sp/>extras<sp/>specifier.<sp/>Anything<sp/>else<sp/>is<sp/>invalid.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>project_name<sp/>=<sp/>match.group(1)</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a28a8618d3d7451a8becd34ec8fead66d" kindref="member">_project_name_re</ref>.match(project_name):</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>deprecated(</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reason=f</highlight><highlight class="stringliteral">&quot;{self}<sp/>contains<sp/>an<sp/>egg<sp/>fragment<sp/>with<sp/>a<sp/>non-PEP<sp/>508<sp/>name&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>replacement=</highlight><highlight class="stringliteral">&quot;to<sp/>use<sp/>the<sp/>req<sp/>@<sp/>url<sp/>syntax,<sp/>and<sp/>remove<sp/>the<sp/>egg<sp/>fragment&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>gone_in=</highlight><highlight class="stringliteral">&quot;25.0&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>issue=11617,</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="449"><highlight class="normal"></highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>project_name</highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>_subdirectory_fragment_re<sp/>=<sp/>re.compile(</highlight><highlight class="stringliteral">r&quot;[#&amp;]subdirectory=([^&amp;]*)&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="453"><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a5fe3059afe6ce0a3328abab5624a0d4a" kindref="member">subdirectory_fragment</ref>(self)<sp/>-&gt;<sp/>Optional[str]:</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>match<sp/>=<sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1ab54813b8c61bc78b931e0df07be306da" kindref="member">_subdirectory_fragment_re</ref>.search(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aec0519677d734b7e5c29ba9218da689d" kindref="member">_url</ref>)</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>match:</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>match.group(1)</highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1afb36c84135153eb76dddf326ab95e783" kindref="member">metadata_link</ref>(self)<sp/>-&gt;<sp/>Optional[&quot;Link&quot;]:</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Return<sp/>a<sp/>link<sp/>to<sp/>the<sp/>associated<sp/>core<sp/>metadata<sp/>file<sp/>(if<sp/>any).&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1abac655fca8b079dae2a59e2c721bdd48" kindref="member">metadata_file_data</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>metadata_url<sp/>=<sp/>f</highlight><highlight class="stringliteral">&quot;{self.url_without_fragment}.metadata&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1abac655fca8b079dae2a59e2c721bdd48" kindref="member">metadata_file_data</ref>.hashes<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link" kindref="compound">Link</ref>(metadata_url)</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link" kindref="compound">Link</ref>(metadata_url,<sp/>hashes=self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1abac655fca8b079dae2a59e2c721bdd48" kindref="member">metadata_file_data</ref>.hashes)</highlight></codeline>
<codeline lineno="469"><highlight class="normal"></highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1adc3aa52207f953fd0e556419536aab35" kindref="member">as_hashes</ref>(self)<sp/>-&gt;<sp/>Hashes:</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpip_1_1__internal_1_1utils_1_1hashes_1_1Hashes" kindref="compound">Hashes</ref>({k:<sp/>[v]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,<sp/>v<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a48c0d230c340a21fd28050d07c3dcc5c" kindref="member">_hashes</ref>.items()})</highlight></codeline>
<codeline lineno="472"><highlight class="normal"></highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a9d79621efd16f7c320ee3fdd6d8585b5" kindref="member">hash</ref>(self)<sp/>-&gt;<sp/>Optional[str]:</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>next(iter(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a48c0d230c340a21fd28050d07c3dcc5c" kindref="member">_hashes</ref>.values()),<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="476"><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a5dc7a1b7027fc46fd6ed6b697233ce1a" kindref="member">hash_name</ref>(self)<sp/>-&gt;<sp/>Optional[str]:</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>next(iter(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a48c0d230c340a21fd28050d07c3dcc5c" kindref="member">_hashes</ref>),<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="480"><highlight class="normal"></highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a18ca3abeab4eb436d6cfab79d7e54da9" kindref="member">show_url</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>posixpath.basename(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aec0519677d734b7e5c29ba9218da689d" kindref="member">_url</ref>.split(</highlight><highlight class="stringliteral">&quot;#&quot;</highlight><highlight class="normal">,<sp/>1)[0].split(</highlight><highlight class="stringliteral">&quot;?&quot;</highlight><highlight class="normal">,<sp/>1)[0])</highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a78868a5dc936bd6f4ddc425ccbc11c99" kindref="member">is_file</ref>(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1afdca198c0e56ff076b7d7eaef8be922e" kindref="member">scheme</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a0086cb599d01ffeffa03c0c35ab85a42" kindref="member">scheme</ref><sp/>==<sp/></highlight><highlight class="stringliteral">&quot;file&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="488"><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a5cffdd4be3ce3949a92df10e51976841" kindref="member">is_existing_dir</ref>(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a78868a5dc936bd6f4ddc425ccbc11c99" kindref="member">is_file</ref><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>os.path.isdir(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a6542bec4aeec14279b094156837dedea" kindref="member">file_path</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a72e9faf9a2a5f838cfdce89db07e3150" kindref="member">file_path</ref>)</highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a5dd1bbaac3ddd31fcbd9581c2be36a69" kindref="member">is_wheel</ref>(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a638d7375efa13338c3579494c34ed159" kindref="member">ext</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a800ca5662fff90f5fbc245e1218a5528" kindref="member">ext</ref><sp/>==<sp/>WHEEL_EXTENSION</highlight></codeline>
<codeline lineno="495"><highlight class="normal"></highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a476ab6666a9c80e29394f429d4e9eb77" kindref="member">is_vcs</ref>(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacepip_1_1__internal_1_1vcs" kindref="compound">pip._internal.vcs</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>vcs</highlight></codeline>
<codeline lineno="499"><highlight class="normal"></highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1afdca198c0e56ff076b7d7eaef8be922e" kindref="member">scheme</ref><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a0086cb599d01ffeffa03c0c35ab85a42" kindref="member">scheme</ref><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>vcs.all_schemes</highlight></codeline>
<codeline lineno="501"><highlight class="normal"></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1ad5a9983dc2842d8b51f43f26345ea672" kindref="member">is_yanked</ref>(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1af68edcd6a5a6f4c22ea34802fbd83e9c" kindref="member">yanked_reason</ref><sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="preprocessor">@property</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1aa12e1776af173c655789509d5e8cfb43" kindref="member">has_hash</ref>(self)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bool(self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a48c0d230c340a21fd28050d07c3dcc5c" kindref="member">_hashes</ref>)</highlight></codeline>
<codeline lineno="509"><highlight class="normal"></highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a64e9674633663980e1fd39dc35994d16" kindref="member">is_hash_allowed</ref>(self,<sp/>hashes:<sp/>Optional[Hashes])<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="512"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Return<sp/>True<sp/>if<sp/>the<sp/>link<sp/>has<sp/>a<sp/>hash<sp/>and<sp/>it<sp/>is<sp/>allowed<sp/>by<sp/>`hashes`.</highlight></codeline>
<codeline lineno="513"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hashes<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>any(hashes.is_hash_allowed(k,<sp/>v)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,<sp/>v<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classpip_1_1__internal_1_1models_1_1link_1_1Link_1a48c0d230c340a21fd28050d07c3dcc5c" kindref="member">_hashes</ref>.items())</highlight></codeline>
<codeline lineno="517"><highlight class="normal"></highlight></codeline>
<codeline lineno="518"><highlight class="normal"></highlight></codeline>
<codeline lineno="519" refid="classpip_1_1__internal_1_1models_1_1link_1_1__CleanResult" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1__CleanResult" kindref="compound">_CleanResult</ref>(NamedTuple):</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Convert<sp/>link<sp/>for<sp/>equivalency<sp/>check.</highlight></codeline>
<codeline lineno="521"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="522"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>is<sp/>used<sp/>in<sp/>the<sp/>resolver<sp/>to<sp/>check<sp/>whether<sp/>two<sp/>URL-specified<sp/>requirements</highlight></codeline>
<codeline lineno="523"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>likely<sp/>point<sp/>to<sp/>the<sp/>same<sp/>distribution<sp/>and<sp/>can<sp/>be<sp/>considered<sp/>equivalent.<sp/>This</highlight></codeline>
<codeline lineno="524"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>equivalency<sp/>logic<sp/>avoids<sp/>comparing<sp/>URLs<sp/>literally,<sp/>which<sp/>can<sp/>be<sp/>too<sp/>strict</highlight></codeline>
<codeline lineno="525"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>(e.g.<sp/>&quot;a=1&amp;b=2&quot;<sp/>vs<sp/>&quot;b=2&amp;a=1&quot;)<sp/>and<sp/>produce<sp/>conflicts<sp/>unexpecting<sp/>to<sp/>users.</highlight></codeline>
<codeline lineno="526"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="527"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Currently<sp/>this<sp/>does<sp/>three<sp/>things:</highlight></codeline>
<codeline lineno="528"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="529"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>1.<sp/>Drop<sp/>the<sp/>basic<sp/>auth<sp/>part.<sp/>This<sp/>is<sp/>technically<sp/>wrong<sp/>since<sp/>a<sp/>server<sp/>can</highlight></codeline>
<codeline lineno="530"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>serve<sp/>different<sp/>content<sp/>based<sp/>on<sp/>auth,<sp/>but<sp/>if<sp/>it<sp/>does<sp/>that,<sp/>it<sp/>is<sp/>even</highlight></codeline>
<codeline lineno="531"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>impossible<sp/>to<sp/>guarantee<sp/>two<sp/>URLs<sp/>without<sp/>auth<sp/>are<sp/>equivalent,<sp/>since</highlight></codeline>
<codeline lineno="532"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>user<sp/>can<sp/>input<sp/>different<sp/>auth<sp/>information<sp/>when<sp/>prompted.<sp/>So<sp/>the</highlight></codeline>
<codeline lineno="533"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>practical<sp/>solution<sp/>is<sp/>to<sp/>assume<sp/>the<sp/>auth<sp/>doesn&apos;t<sp/>affect<sp/>the<sp/>response.</highlight></codeline>
<codeline lineno="534"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>2.<sp/>Parse<sp/>the<sp/>query<sp/>to<sp/>avoid<sp/>the<sp/>ordering<sp/>issue.<sp/>Note<sp/>that<sp/>ordering<sp/>under<sp/>the</highlight></codeline>
<codeline lineno="535"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>same<sp/>key<sp/>in<sp/>the<sp/>query<sp/>are<sp/>NOT<sp/>cleaned;<sp/>i.e.<sp/>&quot;a=1&amp;a=2&quot;<sp/>and<sp/>&quot;a=2&amp;a=1&quot;<sp/>are</highlight></codeline>
<codeline lineno="536"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>still<sp/>considered<sp/>different.</highlight></codeline>
<codeline lineno="537"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>3.<sp/>Explicitly<sp/>drop<sp/>most<sp/>of<sp/>the<sp/>fragment<sp/>part,<sp/>except<sp/>``subdirectory=``<sp/>and</highlight></codeline>
<codeline lineno="538"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hash<sp/>values,<sp/>since<sp/>it<sp/>should<sp/>have<sp/>no<sp/>impact<sp/>the<sp/>downloaded<sp/>content.<sp/>Note</highlight></codeline>
<codeline lineno="539"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>that<sp/>this<sp/>drops<sp/>the<sp/>&quot;egg=&quot;<sp/>part<sp/>historically<sp/>used<sp/>to<sp/>denote<sp/>the<sp/>requested</highlight></codeline>
<codeline lineno="540"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>project<sp/>(and<sp/>extras),<sp/>which<sp/>is<sp/>wrong<sp/>in<sp/>the<sp/>strictest<sp/>sense,<sp/>but<sp/>too<sp/>many</highlight></codeline>
<codeline lineno="541"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>people<sp/>are<sp/>supplying<sp/>it<sp/>inconsistently<sp/>to<sp/>cause<sp/>superfluous<sp/>resolution</highlight></codeline>
<codeline lineno="542"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>conflicts,<sp/>so<sp/>we<sp/>choose<sp/>to<sp/>also<sp/>ignore<sp/>them.</highlight></codeline>
<codeline lineno="543"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"></highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/>parsed:<sp/>urllib.parse.SplitResult</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/>query:<sp/>Dict[str,<sp/>List[str]]</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/><sp/><sp/>subdirectory:<sp/>str</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/>hashes:<sp/>Dict[str,<sp/>str]</highlight></codeline>
<codeline lineno="549"><highlight class="normal"></highlight></codeline>
<codeline lineno="550"><highlight class="normal"></highlight></codeline>
<codeline lineno="551"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1a5685cb8f7335852cc530c280f5901371" kindref="member">_clean_link</ref>(link:<sp/>Link)<sp/>-&gt;<sp/>_CleanResult:</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/>parsed<sp/>=<sp/>link._parsed_url</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/>netloc<sp/>=<sp/>parsed.netloc.rsplit(</highlight><highlight class="stringliteral">&quot;@&quot;</highlight><highlight class="normal">,<sp/>1)[-1]</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>According<sp/>to<sp/>RFC<sp/>8089,<sp/>an<sp/>empty<sp/>host<sp/>in<sp/>file:<sp/>means<sp/>localhost.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>parsed.scheme<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;file&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>netloc:</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>netloc<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;localhost&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/>fragment<sp/>=<sp/>urllib.parse.parse_qs(parsed.fragment)</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;egg&quot;</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>fragment:</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logger.debug(</highlight><highlight class="stringliteral">&quot;Ignoring<sp/>egg=<sp/>fragment<sp/>in<sp/>%s&quot;</highlight><highlight class="normal">,<sp/>link)</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>there<sp/>are<sp/>multiple<sp/>subdirectory<sp/>values,<sp/>use<sp/>the<sp/>first<sp/>one.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>This<sp/>matches<sp/>the<sp/>behavior<sp/>of<sp/>Link.subdirectory_fragment.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subdirectory<sp/>=<sp/>fragment[</highlight><highlight class="stringliteral">&quot;subdirectory&quot;</highlight><highlight class="normal">][0]</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>(IndexError,<sp/>KeyError):</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subdirectory<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>there<sp/>are<sp/>multiple<sp/>hash<sp/>values<sp/>under<sp/>the<sp/>same<sp/>algorithm,<sp/>use<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>first<sp/>one.<sp/>This<sp/>matches<sp/>the<sp/>behavior<sp/>of<sp/>Link.hash_value.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/>hashes<sp/>=<sp/>{k:<sp/>fragment[k][0]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>_SUPPORTED_HASHES<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>k<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>fragment}</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classpip_1_1__internal_1_1models_1_1link_1_1__CleanResult" kindref="compound">_CleanResult</ref>(</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parsed=parsed._replace(netloc=netloc,<sp/>query=</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/>fragment=</highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">),</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>query=urllib.parse.parse_qs(parsed.query),</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>subdirectory=subdirectory,</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>hashes=hashes,</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"></highlight></codeline>
<codeline lineno="577"><highlight class="normal"></highlight><highlight class="preprocessor">@functools.lru_cache(maxsize=None)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">links_equivalent(link1:<sp/>Link,<sp/>link2:<sp/>Link)<sp/>-&gt;<sp/>bool:</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1a5685cb8f7335852cc530c280f5901371" kindref="member">_clean_link</ref>(link1)<sp/>==<sp/><ref refid="namespacepip_1_1__internal_1_1models_1_1link_1a5685cb8f7335852cc530c280f5901371" kindref="member">_clean_link</ref>(link2)</highlight></codeline>
    </programlisting>
    <location file="docs/venv/lib/python3.12/site-packages/pip/_internal/models/link.py"/>
  </compounddef>
</doxygen>
